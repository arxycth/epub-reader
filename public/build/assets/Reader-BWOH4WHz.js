import{c as tr,j as se,U as ur,g as Zt,b as yt,a as it,r as Ri}from"./app-C1y220Qp.js";import{u as rr}from"./useTranslation-BlanJa44.js";import{b as Lt}from"./index-2q6EsOzg.js";/* empty css            */import"./index-CMWG4mbA.js";function fs(x){const e=tr.c(31),{isOpen:t,onClose:r,bookmarks:i,onJump:s,onDelete:n}=x,{t:a}=rr(),l=`fixed top-0 left-0 z-50 h-full w-72 transform bg-white shadow-xl transition-transform duration-300 dark:bg-neutral-900 ${t?"translate-x-0":"-translate-x-full"} `;let f;e[0]!==a?(f=a("reader.bookmarks"),e[0]=a,e[1]=f):f=e[1];let d;e[2]!==f?(d=se.jsxs("h2",{className:"text-lg font-semibold",children:["â­ ",f]}),e[2]=f,e[3]=d):d=e[3];let c;e[4]!==a?(c=a("common.close"),e[4]=a,e[5]=c):c=e[5];let b;e[6]!==r||e[7]!==c?(b=se.jsx("button",{onClick:r,className:"text-sm",children:c}),e[6]=r,e[7]=c,e[8]=b):b=e[8];let m;e[9]!==d||e[10]!==b?(m=se.jsxs("div",{className:"flex items-center justify-between border-b p-4",children:[d,b]}),e[9]=d,e[10]=b,e[11]=m):m=e[11];let N;e[12]!==i.length||e[13]!==a?(N=i.length===0&&se.jsx("p",{className:"text-sm text-neutral-500",children:a("reader.no_bookmarks")}),e[12]=i.length,e[13]=a,e[14]=N):N=e[14];let w;if(e[15]!==i||e[16]!==n||e[17]!==s||e[18]!==a){let g;e[20]!==n||e[21]!==s||e[22]!==a?(g=E=>se.jsxs("div",{className:"flex items-start gap-2 rounded bg-neutral-100 p-2 dark:border dark:border-neutral-700 dark:bg-neutral-800",children:[se.jsxs("button",{className:"flex-1 text-left",onClick:()=>s(E.cfi),children:[se.jsx("p",{className:"line-clamp-1 text-sm font-medium dark:text-white",children:E.label}),se.jsx("p",{className:"truncate text-xs text-neutral-500",children:E.cfi})]}),se.jsx("button",{onClick:()=>n(E.id),className:"text-xs text-red-500 hover:underline",title:a("common.delete"),children:"âœ•"})]},E.id),e[20]=n,e[21]=s,e[22]=a,e[23]=g):g=e[23],w=i.map(g),e[15]=i,e[16]=n,e[17]=s,e[18]=a,e[19]=w}else w=e[19];let h;e[24]!==N||e[25]!==w?(h=se.jsxs("div",{className:"h-[calc(100%-64px)] space-y-2 overflow-y-auto p-4",children:[N,w]}),e[24]=N,e[25]=w,e[26]=h):h=e[26];let v;return e[27]!==l||e[28]!==m||e[29]!==h?(v=se.jsxs("div",{className:l,children:[m,h]}),e[27]=l,e[28]=m,e[29]=h,e[30]=v):v=e[30],v}function cs(x){const e=tr.c(66),{open:t,onClose:r,onSave:i,selectedText:s}=x,{t:n}=rr(),[a,l]=ur.useState(""),[f,d]=ur.useState("yellow");let c,b;if(e[0]!==t?(c=()=>{t||(l(""),d("yellow"))},b=[t],e[0]=t,e[1]=c,e[2]=b):(c=e[1],b=e[2]),ur.useEffect(c,b),!t)return null;let m;e[3]!==r?(m=se.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:r}),e[3]=r,e[4]=m):m=e[4];let N;e[5]!==n?(N=n("reader.save_highlight"),e[5]=n,e[6]=N):N=e[6];let w;e[7]!==N?(w=se.jsx("h3",{className:"mb-2 text-lg font-semibold dark:text-white",children:N}),e[7]=N,e[8]=w):w=e[8];let h;e[9]!==n?(h=n("reader.text_label"),e[9]=n,e[10]=h):h=e[10];let v;e[11]!==h?(v=se.jsx("label",{className:"mb-1 block text-sm text-neutral-600 dark:text-neutral-400",children:h}),e[11]=h,e[12]=v):v=e[12];let g;e[13]!==s?(g=se.jsx("div",{className:"rounded border bg-neutral-50 p-2 text-sm dark:border-neutral-700 dark:bg-neutral-800 dark:text-neutral-200",children:s}),e[13]=s,e[14]=g):g=e[14];let E;e[15]!==v||e[16]!==g?(E=se.jsxs("div",{className:"mb-2",children:[v,g]}),e[15]=v,e[16]=g,e[17]=E):E=e[17];let L;e[18]!==n?(L=n("reader.note_label"),e[18]=n,e[19]=L):L=e[19];let y;e[20]!==L?(y=se.jsx("label",{className:"mb-1 block text-sm text-neutral-600 dark:text-neutral-400",children:L}),e[20]=L,e[21]=y):y=e[21];let S;e[22]===Symbol.for("react.memo_cache_sentinel")?(S=Te=>l(Te.target.value),e[22]=S):S=e[22];let R;e[23]!==n?(R=n("reader.note_placeholder"),e[23]=n,e[24]=R):R=e[24];let I;e[25]!==a||e[26]!==R?(I=se.jsx("textarea",{value:a,onChange:S,className:"h-24 w-full rounded border bg-white p-2 dark:border-neutral-700 dark:bg-neutral-900 dark:text-white",placeholder:R}),e[25]=a,e[26]=R,e[27]=I):I=e[27];let k;e[28]!==y||e[29]!==I?(k=se.jsxs("div",{className:"mb-2",children:[y,I]}),e[28]=y,e[29]=I,e[30]=k):k=e[30];let O;e[31]!==n?(O=n("reader.color_yellow"),e[31]=n,e[32]=O):O=e[32];let H;e[33]!==O?(H=se.jsx("label",{className:"text-sm dark:text-neutral-300",children:O}),e[33]=O,e[34]=H):H=e[34];let j;e[35]===Symbol.for("react.memo_cache_sentinel")?(j=se.jsx("input",{type:"text",hidden:!0,value:"yellow",readOnly:!0}),e[35]=j):j=e[35];let Z;e[36]!==H?(Z=se.jsxs("div",{className:"flex items-center gap-2",children:[H,j]}),e[36]=H,e[37]=Z):Z=e[37];let K;e[38]!==n?(K=n("common.cancel"),e[38]=n,e[39]=K):K=e[39];let J;e[40]!==r||e[41]!==K?(J=se.jsx("button",{onClick:r,className:"rounded border px-3 py-1 hover:bg-neutral-100 dark:border-neutral-700 dark:hover:bg-neutral-800",children:K}),e[40]=r,e[41]=K,e[42]=J):J=e[42];let he;e[43]!==f||e[44]!==a||e[45]!==i?(he=()=>i({note:a,color:f}),e[43]=f,e[44]=a,e[45]=i,e[46]=he):he=e[46];let Q;e[47]!==n?(Q=n("common.save"),e[47]=n,e[48]=Q):Q=e[48];let Y;e[49]!==he||e[50]!==Q?(Y=se.jsx("button",{onClick:he,className:"rounded bg-blue-600 px-3 py-1 text-white hover:bg-blue-700",children:Q}),e[49]=he,e[50]=Q,e[51]=Y):Y=e[51];let ae;e[52]!==J||e[53]!==Y?(ae=se.jsxs("div",{className:"flex gap-2",children:[J,Y]}),e[52]=J,e[53]=Y,e[54]=ae):ae=e[54];let ye;e[55]!==Z||e[56]!==ae?(ye=se.jsxs("div",{className:"flex items-center justify-between",children:[Z,ae]}),e[55]=Z,e[56]=ae,e[57]=ye):ye=e[57];let re;e[58]!==k||e[59]!==ye||e[60]!==w||e[61]!==E?(re=se.jsxs("div",{className:"relative z-70 w-full max-w-lg rounded-lg bg-white p-4 shadow-lg dark:bg-neutral-900",children:[w,E,k,ye]}),e[58]=k,e[59]=ye,e[60]=w,e[61]=E,e[62]=re):re=e[62];let ce;return e[63]!==re||e[64]!==m?(ce=se.jsxs("div",{className:"fixed inset-0 z-60 flex items-center justify-center p-4",children:[m,re]}),e[63]=re,e[64]=m,e[65]=ce):ce=e[65],ce}function ds(x){const e=tr.c(31),{isOpen:t,onClose:r,highlights:i,onJump:s,onDelete:n}=x,{t:a}=rr(),l=`fixed top-0 right-0 z-50 h-full w-80 transform bg-white shadow-xl transition-transform duration-300 dark:bg-neutral-900 ${t?"translate-x-0":"translate-x-full"} `;let f;e[0]!==a?(f=a("reader.highlights"),e[0]=a,e[1]=f):f=e[1];let d;e[2]!==f?(d=se.jsx("h2",{className:"text-lg font-semibold",children:f}),e[2]=f,e[3]=d):d=e[3];let c;e[4]!==a?(c=a("common.close"),e[4]=a,e[5]=c):c=e[5];let b;e[6]!==r||e[7]!==c?(b=se.jsx("button",{onClick:r,className:"text-sm",children:c}),e[6]=r,e[7]=c,e[8]=b):b=e[8];let m;e[9]!==d||e[10]!==b?(m=se.jsxs("div",{className:"flex items-center justify-between border-b p-4",children:[d,b]}),e[9]=d,e[10]=b,e[11]=m):m=e[11];let N;e[12]!==i.length||e[13]!==a?(N=i.length===0&&se.jsx("p",{className:"text-sm text-neutral-500",children:a("reader.no_highlights")}),e[12]=i.length,e[13]=a,e[14]=N):N=e[14];let w;if(e[15]!==i||e[16]!==n||e[17]!==s||e[18]!==a){let g;e[20]!==n||e[21]!==s||e[22]!==a?(g=E=>se.jsx("div",{className:"rounded border bg-neutral-50 p-2 dark:border-neutral-700 dark:bg-neutral-800",children:se.jsxs("div",{className:"flex items-start justify-between",children:[se.jsxs("div",{className:"flex-1",children:[se.jsxs("p",{className:"mb-1 text-xs text-neutral-500",children:["#",E.id," â€¢"," ",new Date(E.created_at).toLocaleString()]}),se.jsx("p",{className:"mb-1 line-clamp-3 text-sm",children:E.text}),E.note&&se.jsxs("p",{className:"text-sm text-neutral-500 italic",children:["â€œ",E.note,"â€"]})]}),se.jsxs("div",{className:"ml-2 flex flex-col gap-1",children:[se.jsx("button",{onClick:()=>s(E.cfi_range),className:"rounded border px-2 py-1 text-xs hover:bg-neutral-200 dark:hover:bg-neutral-700",children:"Go"}),se.jsx("button",{onClick:()=>n(E.id),className:"rounded border px-2 py-1 text-xs text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20",children:a("common.delete")})]})]})},E.id),e[20]=n,e[21]=s,e[22]=a,e[23]=g):g=e[23],w=i.map(g),e[15]=i,e[16]=n,e[17]=s,e[18]=a,e[19]=w}else w=e[19];let h;e[24]!==N||e[25]!==w?(h=se.jsxs("div",{className:"h-[calc(100%-60px)] space-y-3 overflow-y-auto p-3",children:[N,w]}),e[24]=N,e[25]=w,e[26]=h):h=e[26];let v;return e[27]!==l||e[28]!==m||e[29]!==h?(v=se.jsxs("div",{className:l,children:[m,h]}),e[27]=l,e[28]=m,e[29]=h,e[30]=v):v=e[30],v}function ps(x){const e=tr.c(45),{isOpen:t,onClose:r,results:i,onSearch:s,onSelect:n}=x,{t:a}=rr(),[l,f]=ur.useState("");let d;e[0]!==s||e[1]!==l?(d=j=>{j.preventDefault(),s(l)},e[0]=s,e[1]=l,e[2]=d):d=e[2];const c=d,b=`fixed top-0 right-0 z-50 h-full w-72 transform bg-white shadow-xl transition-transform duration-300 dark:bg-neutral-900 ${t?"translate-x-0":"translate-x-full"} `;let m;e[3]!==a?(m=a("reader.search"),e[3]=a,e[4]=m):m=e[4];let N;e[5]!==m?(N=se.jsx("h2",{className:"text-lg font-semibold",children:m}),e[5]=m,e[6]=N):N=e[6];let w;e[7]!==a?(w=a("common.close"),e[7]=a,e[8]=w):w=e[8];let h;e[9]!==r||e[10]!==w?(h=se.jsx("button",{onClick:r,className:"text-sm",children:w}),e[9]=r,e[10]=w,e[11]=h):h=e[11];let v;e[12]!==N||e[13]!==h?(v=se.jsxs("div",{className:"flex items-center justify-between border-b p-4",children:[N,h]}),e[12]=N,e[13]=h,e[14]=v):v=e[14];let g;e[15]!==a?(g=a("common.search_in_book"),e[15]=a,e[16]=g):g=e[16];let E;e[17]===Symbol.for("react.memo_cache_sentinel")?(E=j=>f(j.target.value),e[17]=E):E=e[17];let L;e[18]!==l||e[19]!==g?(L=se.jsx("input",{type:"text",placeholder:g,value:l,onChange:E,className:"w-full rounded border p-2 dark:border-neutral-700 dark:bg-neutral-800"}),e[18]=l,e[19]=g,e[20]=L):L=e[20];let y;e[21]!==a?(y=a("reader.search"),e[21]=a,e[22]=y):y=e[22];let S;e[23]!==y?(S=se.jsx("button",{className:"mt-2 w-full rounded bg-blue-500 p-2 text-white transition-colors hover:bg-blue-600",children:y}),e[23]=y,e[24]=S):S=e[24];let R;e[25]!==c||e[26]!==L||e[27]!==S?(R=se.jsxs("form",{onSubmit:c,className:"border-b p-4",children:[L,S]}),e[25]=c,e[26]=L,e[27]=S,e[28]=R):R=e[28];let I;e[29]!==i.length||e[30]!==a?(I=i.length===0&&se.jsx("p",{className:"text-sm text-neutral-500",children:a("index.not_found")}),e[29]=i.length,e[30]=a,e[31]=I):I=e[31];let k;if(e[32]!==n||e[33]!==i){let j;e[35]!==n?(j=(Z,K)=>se.jsxs("button",{className:"w-full rounded bg-neutral-100 p-2 text-left hover:bg-neutral-200 dark:bg-neutral-800 dark:hover:bg-neutral-700",onClick:()=>n(Z.cfi),children:[se.jsx("p",{className:"mb-1 text-xs text-neutral-500",children:Z.chapter}),se.jsx("p",{className:"line-clamp-2 text-sm",children:Z.excerpt})]},K),e[35]=n,e[36]=j):j=e[36],k=i.map(j),e[32]=n,e[33]=i,e[34]=k}else k=e[34];let O;e[37]!==I||e[38]!==k?(O=se.jsxs("div",{className:"h-[calc(100%-140px)] space-y-3 overflow-y-auto p-4",children:[I,k]}),e[37]=I,e[38]=k,e[39]=O):O=e[39];let H;return e[40]!==R||e[41]!==O||e[42]!==b||e[43]!==v?(H=se.jsxs("div",{className:b,children:[v,R,O]}),e[40]=R,e[41]=O,e[42]=b,e[43]=v,e[44]=H):H=e[44],H}function vs(x){const e=tr.c(23),{toc:t,onSelect:r,isOpen:i,onClose:s}=x,{t:n}=rr(),a=`fixed top-0 left-0 z-50 h-full w-64 transform bg-white shadow-xl transition-transform duration-300 dark:bg-neutral-900 ${i?"translate-x-0":"-translate-x-full"} `;let l;e[0]!==n?(l=n("reader.toc"),e[0]=n,e[1]=l):l=e[1];let f;e[2]!==l?(f=se.jsx("h2",{className:"text-lg font-semibold",children:l}),e[2]=l,e[3]=f):f=e[3];let d;e[4]!==n?(d=n("common.close"),e[4]=n,e[5]=d):d=e[5];let c;e[6]!==s||e[7]!==d?(c=se.jsx("button",{onClick:s,className:"text-sm",children:d}),e[6]=s,e[7]=d,e[8]=c):c=e[8];let b;e[9]!==f||e[10]!==c?(b=se.jsxs("div",{className:"flex items-center justify-between border-b p-4",children:[f,c]}),e[9]=f,e[10]=c,e[11]=b):b=e[11];let m;if(e[12]!==r||e[13]!==t){let h;e[15]!==r?(h=v=>se.jsx("button",{onClick:()=>r(v.href),className:"block w-full rounded p-2 text-left hover:bg-neutral-200 dark:hover:bg-neutral-800",children:v.label||v.title},v.href),e[15]=r,e[16]=h):h=e[16],m=t.map(h),e[12]=r,e[13]=t,e[14]=m}else m=e[14];let N;e[17]!==m?(N=se.jsx("div",{className:"h-[calc(100%-60px)] space-y-2 overflow-y-auto p-4",children:m}),e[17]=m,e[18]=N):N=e[18];let w;return e[19]!==a||e[20]!==b||e[21]!==N?(w=se.jsxs("div",{className:a,children:[b,N]}),e[19]=a,e[20]=b,e[21]=N,e[22]=w):w=e[22],w}var sr={exports:{}},Cr={exports:{}},Sr,Ii;function In(){if(Ii)return Sr;Ii=1;var x=void 0;return Sr=function(e){return e!==x&&e!==null},Sr}var Tr,Oi;function gs(){if(Oi)return Tr;Oi=1;var x=In(),e={object:!0,function:!0,undefined:!0};return Tr=function(t){return x(t)?hasOwnProperty.call(e,typeof t):!1},Tr}var kr,Li;function ms(){if(Li)return kr;Li=1;var x=gs();return kr=function(e){if(!x(e))return!1;try{return e.constructor?e.constructor.prototype===e:!1}catch{return!1}},kr}var Nr,Bi;function bs(){if(Bi)return Nr;Bi=1;var x=ms();return Nr=function(e){if(typeof e!="function"||!hasOwnProperty.call(e,"length"))return!1;try{if(typeof e.length!="number"||typeof e.call!="function"||typeof e.apply!="function")return!1}catch{return!1}return!x(e)},Nr}var Rr,Fi;function ys(){if(Fi)return Rr;Fi=1;var x=bs(),e=/^\s*class[\s{/}]/,t=Function.prototype.toString;return Rr=function(r){return!(!x(r)||e.test(t.call(r)))},Rr}var Ir,Pi;function ws(){return Pi||(Pi=1,Ir=function(){var x=Object.assign,e;return typeof x!="function"?!1:(e={foo:"raz"},x(e,{bar:"dwa"},{trzy:"trzy"}),e.foo+e.bar+e.trzy==="razdwatrzy")}),Ir}var Or,zi;function _s(){return zi||(zi=1,Or=function(){try{return Object.keys("primitive"),!0}catch{return!1}}),Or}var Lr,Mi;function xs(){return Mi||(Mi=1,Lr=function(){}),Lr}var Br,Ui;function yi(){if(Ui)return Br;Ui=1;var x=xs()();return Br=function(e){return e!==x&&e!==null},Br}var Fr,ji;function Es(){if(ji)return Fr;ji=1;var x=yi(),e=Object.keys;return Fr=function(t){return e(x(t)?Object(t):t)},Fr}var Pr,qi;function Ds(){return qi||(qi=1,Pr=_s()()?Object.keys:Es()),Pr}var zr,Wi;function As(){if(Wi)return zr;Wi=1;var x=yi();return zr=function(e){if(!x(e))throw new TypeError("Cannot use null or undefined");return e},zr}var Mr,Hi;function Cs(){if(Hi)return Mr;Hi=1;var x=Ds(),e=As(),t=Math.max;return Mr=function(r,i){var s,n,a=t(arguments.length,2),l;for(r=Object(e(r)),l=function(f){try{r[f]=i[f]}catch(d){s||(s=d)}},n=1;n<a;++n)i=arguments[n],x(i).forEach(l);if(s!==void 0)throw s;return r},Mr}var Ur,Vi;function Ss(){return Vi||(Vi=1,Ur=ws()()?Object.assign:Cs()),Ur}var jr,Gi;function Ts(){if(Gi)return jr;Gi=1;var x=yi(),e=Array.prototype.forEach,t=Object.create,r=function(i,s){var n;for(n in i)s[n]=i[n]};return jr=function(i){var s=t(null);return e.call(arguments,function(n){x(n)&&r(Object(n),s)}),s},jr}var qr,Zi;function ks(){if(Zi)return qr;Zi=1;var x="razdwatrzy";return qr=function(){return typeof x.contains!="function"?!1:x.contains("dwa")===!0&&x.contains("foo")===!1},qr}var Wr,Xi;function Ns(){if(Xi)return Wr;Xi=1;var x=String.prototype.indexOf;return Wr=function(e){return x.call(this,e,arguments[1])>-1},Wr}var Hr,Yi;function Rs(){return Yi||(Yi=1,Hr=ks()()?String.prototype.contains:Ns()),Hr}var $i;function Is(){if($i)return Cr.exports;$i=1;var x=In(),e=ys(),t=Ss(),r=Ts(),i=Rs(),s=Cr.exports=function(n,a){var l,f,d,c,b;return arguments.length<2||typeof n!="string"?(c=a,a=n,n=null):c=arguments[2],x(n)?(l=i.call(n,"c"),f=i.call(n,"e"),d=i.call(n,"w")):(l=d=!0,f=!1),b={value:a,configurable:l,enumerable:f,writable:d},c?t(r(c),b):b};return s.gs=function(n,a,l){var f,d,c,b;return typeof n!="string"?(c=l,l=a,a=n,n=null):c=arguments[3],x(a)?e(a)?x(l)?e(l)||(c=l,l=void 0):l=void 0:(c=a,a=l=void 0):a=void 0,x(n)?(f=i.call(n,"c"),d=i.call(n,"e")):(f=!0,d=!1),b={get:a,set:l,configurable:f,enumerable:d},c?t(r(c),b):b},Cr.exports}var Vr,Ki;function Os(){return Ki||(Ki=1,Vr=function(x){if(typeof x!="function")throw new TypeError(x+" is not a function");return x}),Vr}var Ji;function Ls(){return Ji||(Ji=1,(function(x,e){var t=Is(),r=Os(),i=Function.prototype.apply,s=Function.prototype.call,n=Object.create,a=Object.defineProperty,l=Object.defineProperties,f=Object.prototype.hasOwnProperty,d={configurable:!0,enumerable:!1,writable:!0},c,b,m,N,w,h,v;c=function(g,E){var L;return r(E),f.call(this,"__ee__")?L=this.__ee__:(L=d.value=n(null),a(this,"__ee__",d),d.value=null),L[g]?typeof L[g]=="object"?L[g].push(E):L[g]=[L[g],E]:L[g]=E,this},b=function(g,E){var L,y;return r(E),y=this,c.call(this,g,L=function(){m.call(y,g,L),i.call(E,this,arguments)}),L.__eeOnceListener__=E,this},m=function(g,E){var L,y,S,R;if(r(E),!f.call(this,"__ee__"))return this;if(L=this.__ee__,!L[g])return this;if(y=L[g],typeof y=="object")for(R=0;S=y[R];++R)(S===E||S.__eeOnceListener__===E)&&(y.length===2?L[g]=y[R?0:1]:y.splice(R,1));else(y===E||y.__eeOnceListener__===E)&&delete L[g];return this},N=function(g){var E,L,y,S,R;if(f.call(this,"__ee__")&&(S=this.__ee__[g],!!S))if(typeof S=="object"){for(L=arguments.length,R=new Array(L-1),E=1;E<L;++E)R[E-1]=arguments[E];for(S=S.slice(),E=0;y=S[E];++E)i.call(y,this,R)}else switch(arguments.length){case 1:s.call(S,this);break;case 2:s.call(S,this,arguments[1]);break;case 3:s.call(S,this,arguments[1],arguments[2]);break;default:for(L=arguments.length,R=new Array(L-1),E=1;E<L;++E)R[E-1]=arguments[E];i.call(S,this,R)}},w={on:c,once:b,off:m,emit:N},h={on:t(c),once:t(b),off:t(m),emit:t(N)},v=l({},h),x.exports=e=function(g){return g==null?n(v):l(Object(g),h)},e.methods=w})(sr,sr.exports)),sr.exports}var Bs=Ls();const St=Zt(Bs);var $t={},kt={},zt={},Qi;function yr(){if(Qi)return zt;Qi=1;function x(i,s,n){if(n===void 0&&(n=Array.prototype),i&&typeof n.find=="function")return n.find.call(i,s);for(var a=0;a<i.length;a++)if(Object.prototype.hasOwnProperty.call(i,a)){var l=i[a];if(s.call(void 0,l,a,i))return l}}function e(i,s){return s===void 0&&(s=Object),s&&typeof s.freeze=="function"?s.freeze(i):i}var t=e({HTML:"text/html",isHTML:function(i){return i===t.HTML},XML_APPLICATION:"application/xml",XML_TEXT:"text/xml",XML_XHTML_APPLICATION:"application/xhtml+xml",XML_SVG_IMAGE:"image/svg+xml"}),r=e({HTML:"http://www.w3.org/1999/xhtml",isHTML:function(i){return i===r.HTML},SVG:"http://www.w3.org/2000/svg",XML:"http://www.w3.org/XML/1998/namespace",XMLNS:"http://www.w3.org/2000/xmlns/"});return zt.find=x,zt.freeze=e,zt.MIME_TYPE=t,zt.NAMESPACE=r,zt}var en;function On(){if(en)return kt;en=1;var x=yr(),e=x.find,t=x.NAMESPACE;function r(p){return p!==""}function i(p){return p?p.split(/[\t\n\f\r ]+/).filter(r):[]}function s(p,o){return p.hasOwnProperty(o)||(p[o]=!0),p}function n(p){if(!p)return[];var o=i(p);return Object.keys(o.reduce(s,{}))}function a(p){return function(o){return p&&p.indexOf(o)!==-1}}function l(p,o){for(var D in p)Object.prototype.hasOwnProperty.call(p,D)&&(o[D]=p[D])}function f(p,o){var D=p.prototype;if(!(D instanceof o)){let z=function(){};z.prototype=o.prototype,z=new z,l(D,z),p.prototype=D=z}D.constructor!=p&&(typeof p!="function"&&console.error("unknown Class:"+p),D.constructor=p)}var d={},c=d.ELEMENT_NODE=1,b=d.ATTRIBUTE_NODE=2,m=d.TEXT_NODE=3,N=d.CDATA_SECTION_NODE=4,w=d.ENTITY_REFERENCE_NODE=5,h=d.ENTITY_NODE=6,v=d.PROCESSING_INSTRUCTION_NODE=7,g=d.COMMENT_NODE=8,E=d.DOCUMENT_NODE=9,L=d.DOCUMENT_TYPE_NODE=10,y=d.DOCUMENT_FRAGMENT_NODE=11,S=d.NOTATION_NODE=12,R={},I={};R.INDEX_SIZE_ERR=(I[1]="Index size error",1),R.DOMSTRING_SIZE_ERR=(I[2]="DOMString size error",2);var k=R.HIERARCHY_REQUEST_ERR=(I[3]="Hierarchy request error",3);R.WRONG_DOCUMENT_ERR=(I[4]="Wrong document",4),R.INVALID_CHARACTER_ERR=(I[5]="Invalid character",5),R.NO_DATA_ALLOWED_ERR=(I[6]="No data allowed",6),R.NO_MODIFICATION_ALLOWED_ERR=(I[7]="No modification allowed",7);var O=R.NOT_FOUND_ERR=(I[8]="Not found",8);R.NOT_SUPPORTED_ERR=(I[9]="Not supported",9);var H=R.INUSE_ATTRIBUTE_ERR=(I[10]="Attribute in use",10);R.INVALID_STATE_ERR=(I[11]="Invalid state",11),R.SYNTAX_ERR=(I[12]="Syntax error",12),R.INVALID_MODIFICATION_ERR=(I[13]="Invalid modification",13),R.NAMESPACE_ERR=(I[14]="Invalid namespace",14),R.INVALID_ACCESS_ERR=(I[15]="Invalid access",15);function j(p,o){if(o instanceof Error)var D=o;else D=this,Error.call(this,I[p]),this.message=I[p],Error.captureStackTrace&&Error.captureStackTrace(this,j);return D.code=p,o&&(this.message=this.message+": "+o),D}j.prototype=Error.prototype,l(R,j);function Z(){}Z.prototype={length:0,item:function(p){return p>=0&&p<this.length?this[p]:null},toString:function(p,o){for(var D=[],z=0;z<this.length;z++)$(this[z],D,p,o);return D.join("")},filter:function(p){return Array.prototype.filter.call(this,p)},indexOf:function(p){return Array.prototype.indexOf.call(this,p)}};function K(p,o){this._node=p,this._refresh=o,J(this)}function J(p){var o=p._node._inc||p._node.ownerDocument._inc;if(p._inc!==o){var D=p._refresh(p._node);if(P(p,"length",D.length),!p.$$length||D.length<p.$$length)for(var z=D.length;z in p;z++)Object.prototype.hasOwnProperty.call(p,z)&&delete p[z];l(D,p),p._inc=o}}K.prototype.item=function(p){return J(this),this[p]||null},f(K,Z);function he(){}function Q(p,o){for(var D=p.length;D--;)if(p[D]===o)return D}function Y(p,o,D,z){if(z?o[Q(o,z)]=D:o[o.length++]=D,p){D.ownerElement=p;var u=p.ownerDocument;u&&(z&&je(u,p,z),Ne(u,p,D))}}function ae(p,o,D){var z=Q(o,D);if(z>=0){for(var u=o.length-1;z<u;)o[z]=o[++z];if(o.length=u,p){var M=p.ownerDocument;M&&(je(M,p,D),D.ownerElement=null)}}else throw new j(O,new Error(p.tagName+"@"+D))}he.prototype={length:0,item:Z.prototype.item,getNamedItem:function(p){for(var o=this.length;o--;){var D=this[o];if(D.nodeName==p)return D}},setNamedItem:function(p){var o=p.ownerElement;if(o&&o!=this._ownerElement)throw new j(H);var D=this.getNamedItem(p.nodeName);return Y(this._ownerElement,this,p,D),D},setNamedItemNS:function(p){var o=p.ownerElement,D;if(o&&o!=this._ownerElement)throw new j(H);return D=this.getNamedItemNS(p.namespaceURI,p.localName),Y(this._ownerElement,this,p,D),D},removeNamedItem:function(p){var o=this.getNamedItem(p);return ae(this._ownerElement,this,o),o},removeNamedItemNS:function(p,o){var D=this.getNamedItemNS(p,o);return ae(this._ownerElement,this,D),D},getNamedItemNS:function(p,o){for(var D=this.length;D--;){var z=this[D];if(z.localName==o&&z.namespaceURI==p)return z}return null}};function ye(){}ye.prototype={hasFeature:function(p,o){return!0},createDocument:function(p,o,D){var z=new xe;if(z.implementation=this,z.childNodes=new Z,z.doctype=D||null,D&&z.appendChild(D),o){var u=z.createElementNS(p,o);z.appendChild(u)}return z},createDocumentType:function(p,o,D){var z=new tt;return z.name=p,z.nodeName=p,z.publicId=o||"",z.systemId=D||"",z}};function re(){}re.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(p,o){return et(this,p,o)},replaceChild:function(p,o){et(this,p,o,Ve),o&&this.removeChild(o)},removeChild:function(p){return we(this,p)},appendChild:function(p){return this.insertBefore(p,null)},hasChildNodes:function(){return this.firstChild!=null},cloneNode:function(p){return ve(this.ownerDocument||this,this,p)},normalize:function(){for(var p=this.firstChild;p;){var o=p.nextSibling;o&&o.nodeType==m&&p.nodeType==m?(this.removeChild(o),p.appendData(o.data)):(p.normalize(),p=o)}},isSupported:function(p,o){return this.ownerDocument.implementation.hasFeature(p,o)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(p){for(var o=this;o;){var D=o._nsMap;if(D){for(var z in D)if(Object.prototype.hasOwnProperty.call(D,z)&&D[z]===p)return z}o=o.nodeType==b?o.ownerDocument:o.parentNode}return null},lookupNamespaceURI:function(p){for(var o=this;o;){var D=o._nsMap;if(D&&p in D&&Object.prototype.hasOwnProperty.call(D,p))return D[p];o=o.nodeType==b?o.ownerDocument:o.parentNode}return null},isDefaultNamespace:function(p){var o=this.lookupPrefix(p);return o==null}};function ce(p){return p=="<"&&"&lt;"||p==">"&&"&gt;"||p=="&"&&"&amp;"||p=='"'&&"&quot;"||"&#"+p.charCodeAt()+";"}l(d,re),l(d,re.prototype);function Te(p,o){if(o(p))return!0;if(p=p.firstChild)do if(Te(p,o))return!0;while(p=p.nextSibling)}function xe(){this.ownerDocument=this}function Ne(p,o,D){p&&p._inc++;var z=D.namespaceURI;z===t.XMLNS&&(o._nsMap[D.prefix?D.localName:""]=D.value)}function je(p,o,D,z){p&&p._inc++;var u=D.namespaceURI;u===t.XMLNS&&delete o._nsMap[D.prefix?D.localName:""]}function ze(p,o,D){if(p&&p._inc){p._inc++;var z=o.childNodes;if(D)z[z.length++]=D;else{for(var u=o.firstChild,M=0;u;)z[M++]=u,u=u.nextSibling;z.length=M,delete z[z.length]}}}function we(p,o){var D=o.previousSibling,z=o.nextSibling;return D?D.nextSibling=z:p.firstChild=z,z?z.previousSibling=D:p.lastChild=D,o.parentNode=null,o.previousSibling=null,o.nextSibling=null,ze(p.ownerDocument,p),o}function Me(p){return p&&(p.nodeType===re.DOCUMENT_NODE||p.nodeType===re.DOCUMENT_FRAGMENT_NODE||p.nodeType===re.ELEMENT_NODE)}function oe(p){return p&&(me(p)||_e(p)||ue(p)||p.nodeType===re.DOCUMENT_FRAGMENT_NODE||p.nodeType===re.COMMENT_NODE||p.nodeType===re.PROCESSING_INSTRUCTION_NODE)}function ue(p){return p&&p.nodeType===re.DOCUMENT_TYPE_NODE}function me(p){return p&&p.nodeType===re.ELEMENT_NODE}function _e(p){return p&&p.nodeType===re.TEXT_NODE}function Ee(p,o){var D=p.childNodes||[];if(e(D,me)||ue(o))return!1;var z=e(D,ue);return!(o&&z&&D.indexOf(z)>D.indexOf(o))}function Re(p,o){var D=p.childNodes||[];function z(M){return me(M)&&M!==o}if(e(D,z))return!1;var u=e(D,ue);return!(o&&u&&D.indexOf(u)>D.indexOf(o))}function Ie(p,o,D){if(!Me(p))throw new j(k,"Unexpected parent node type "+p.nodeType);if(D&&D.parentNode!==p)throw new j(O,"child not in parent");if(!oe(o)||ue(o)&&p.nodeType!==re.DOCUMENT_NODE)throw new j(k,"Unexpected node type "+o.nodeType+" for parent node type "+p.nodeType)}function Oe(p,o,D){var z=p.childNodes||[],u=o.childNodes||[];if(o.nodeType===re.DOCUMENT_FRAGMENT_NODE){var M=u.filter(me);if(M.length>1||e(u,_e))throw new j(k,"More than one element or text in fragment");if(M.length===1&&!Ee(p,D))throw new j(k,"Element in fragment can not be inserted before doctype")}if(me(o)&&!Ee(p,D))throw new j(k,"Only one element can be added and only after doctype");if(ue(o)){if(e(z,ue))throw new j(k,"Only one doctype is allowed");var V=e(z,me);if(D&&z.indexOf(V)<z.indexOf(D))throw new j(k,"Doctype can only be inserted before an element");if(!D&&V)throw new j(k,"Doctype can not be appended since element is present")}}function Ve(p,o,D){var z=p.childNodes||[],u=o.childNodes||[];if(o.nodeType===re.DOCUMENT_FRAGMENT_NODE){var M=u.filter(me);if(M.length>1||e(u,_e))throw new j(k,"More than one element or text in fragment");if(M.length===1&&!Re(p,D))throw new j(k,"Element in fragment can not be inserted before doctype")}if(me(o)&&!Re(p,D))throw new j(k,"Only one element can be added and only after doctype");if(ue(o)){if(e(z,function(B){return ue(B)&&B!==D}))throw new j(k,"Only one doctype is allowed");var V=e(z,me);if(D&&z.indexOf(V)<z.indexOf(D))throw new j(k,"Doctype can only be inserted before an element")}}function et(p,o,D,z){Ie(p,o,D),p.nodeType===re.DOCUMENT_NODE&&(z||Oe)(p,o,D);var u=o.parentNode;if(u&&u.removeChild(o),o.nodeType===y){var M=o.firstChild;if(M==null)return o;var V=o.lastChild}else M=V=o;var _=D?D.previousSibling:p.lastChild;M.previousSibling=_,V.nextSibling=D,_?_.nextSibling=M:p.firstChild=M,D==null?p.lastChild=V:D.previousSibling=V;do M.parentNode=p;while(M!==V&&(M=M.nextSibling));return ze(p.ownerDocument||p,p),o.nodeType==y&&(o.firstChild=o.lastChild=null),o}function Ke(p,o){return o.parentNode&&o.parentNode.removeChild(o),o.parentNode=p,o.previousSibling=p.lastChild,o.nextSibling=null,o.previousSibling?o.previousSibling.nextSibling=o:p.firstChild=o,p.lastChild=o,ze(p.ownerDocument,p,o),o}xe.prototype={nodeName:"#document",nodeType:E,doctype:null,documentElement:null,_inc:1,insertBefore:function(p,o){if(p.nodeType==y){for(var D=p.firstChild;D;){var z=D.nextSibling;this.insertBefore(D,o),D=z}return p}return et(this,p,o),p.ownerDocument=this,this.documentElement===null&&p.nodeType===c&&(this.documentElement=p),p},removeChild:function(p){return this.documentElement==p&&(this.documentElement=null),we(this,p)},replaceChild:function(p,o){et(this,p,o,Ve),p.ownerDocument=this,o&&this.removeChild(o),me(p)&&(this.documentElement=p)},importNode:function(p,o){return te(this,p,o)},getElementById:function(p){var o=null;return Te(this.documentElement,function(D){if(D.nodeType==c&&D.getAttribute("id")==p)return o=D,!0}),o},getElementsByClassName:function(p){var o=n(p);return new K(this,function(D){var z=[];return o.length>0&&Te(D.documentElement,function(u){if(u!==D&&u.nodeType===c){var M=u.getAttribute("class");if(M){var V=p===M;if(!V){var _=n(M);V=o.every(a(_))}V&&z.push(u)}}}),z})},createElement:function(p){var o=new Ae;o.ownerDocument=this,o.nodeName=p,o.tagName=p,o.localName=p,o.childNodes=new Z;var D=o.attributes=new he;return D._ownerElement=o,o},createDocumentFragment:function(){var p=new ct;return p.ownerDocument=this,p.childNodes=new Z,p},createTextNode:function(p){var o=new nt;return o.ownerDocument=this,o.appendData(p),o},createComment:function(p){var o=new pt;return o.ownerDocument=this,o.appendData(p),o},createCDATASection:function(p){var o=new lt;return o.ownerDocument=this,o.appendData(p),o},createProcessingInstruction:function(p,o){var D=new ht;return D.ownerDocument=this,D.tagName=D.nodeName=D.target=p,D.nodeValue=D.data=o,D},createAttribute:function(p){var o=new Se;return o.ownerDocument=this,o.name=p,o.nodeName=p,o.localName=p,o.specified=!0,o},createEntityReference:function(p){var o=new at;return o.ownerDocument=this,o.nodeName=p,o},createElementNS:function(p,o){var D=new Ae,z=o.split(":"),u=D.attributes=new he;return D.childNodes=new Z,D.ownerDocument=this,D.nodeName=o,D.tagName=o,D.namespaceURI=p,z.length==2?(D.prefix=z[0],D.localName=z[1]):D.localName=o,u._ownerElement=D,D},createAttributeNS:function(p,o){var D=new Se,z=o.split(":");return D.ownerDocument=this,D.nodeName=o,D.name=o,D.namespaceURI=p,D.specified=!0,z.length==2?(D.prefix=z[0],D.localName=z[1]):D.localName=o,D}},f(xe,re);function Ae(){this._nsMap={}}Ae.prototype={nodeType:c,hasAttribute:function(p){return this.getAttributeNode(p)!=null},getAttribute:function(p){var o=this.getAttributeNode(p);return o&&o.value||""},getAttributeNode:function(p){return this.attributes.getNamedItem(p)},setAttribute:function(p,o){var D=this.ownerDocument.createAttribute(p);D.value=D.nodeValue=""+o,this.setAttributeNode(D)},removeAttribute:function(p){var o=this.getAttributeNode(p);o&&this.removeAttributeNode(o)},appendChild:function(p){return p.nodeType===y?this.insertBefore(p,null):Ke(this,p)},setAttributeNode:function(p){return this.attributes.setNamedItem(p)},setAttributeNodeNS:function(p){return this.attributes.setNamedItemNS(p)},removeAttributeNode:function(p){return this.attributes.removeNamedItem(p.nodeName)},removeAttributeNS:function(p,o){var D=this.getAttributeNodeNS(p,o);D&&this.removeAttributeNode(D)},hasAttributeNS:function(p,o){return this.getAttributeNodeNS(p,o)!=null},getAttributeNS:function(p,o){var D=this.getAttributeNodeNS(p,o);return D&&D.value||""},setAttributeNS:function(p,o,D){var z=this.ownerDocument.createAttributeNS(p,o);z.value=z.nodeValue=""+D,this.setAttributeNode(z)},getAttributeNodeNS:function(p,o){return this.attributes.getNamedItemNS(p,o)},getElementsByTagName:function(p){return new K(this,function(o){var D=[];return Te(o,function(z){z!==o&&z.nodeType==c&&(p==="*"||z.tagName==p)&&D.push(z)}),D})},getElementsByTagNameNS:function(p,o){return new K(this,function(D){var z=[];return Te(D,function(u){u!==D&&u.nodeType===c&&(p==="*"||u.namespaceURI===p)&&(o==="*"||u.localName==o)&&z.push(u)}),z})}},xe.prototype.getElementsByTagName=Ae.prototype.getElementsByTagName,xe.prototype.getElementsByTagNameNS=Ae.prototype.getElementsByTagNameNS,f(Ae,re);function Se(){}Se.prototype.nodeType=b,f(Se,re);function De(){}De.prototype={data:"",substringData:function(p,o){return this.data.substring(p,p+o)},appendData:function(p){p=this.data+p,this.nodeValue=this.data=p,this.length=p.length},insertData:function(p,o){this.replaceData(p,0,o)},appendChild:function(p){throw new Error(I[k])},deleteData:function(p,o){this.replaceData(p,o,"")},replaceData:function(p,o,D){var z=this.data.substring(0,p),u=this.data.substring(p+o);D=z+D+u,this.nodeValue=this.data=D,this.length=D.length}},f(De,re);function nt(){}nt.prototype={nodeName:"#text",nodeType:m,splitText:function(p){var o=this.data,D=o.substring(p);o=o.substring(0,p),this.data=this.nodeValue=o,this.length=o.length;var z=this.ownerDocument.createTextNode(D);return this.parentNode&&this.parentNode.insertBefore(z,this.nextSibling),z}},f(nt,De);function pt(){}pt.prototype={nodeName:"#comment",nodeType:g},f(pt,De);function lt(){}lt.prototype={nodeName:"#cdata-section",nodeType:N},f(lt,De);function tt(){}tt.prototype.nodeType=L,f(tt,re);function vt(){}vt.prototype.nodeType=S,f(vt,re);function ft(){}ft.prototype.nodeType=h,f(ft,re);function at(){}at.prototype.nodeType=w,f(at,re);function ct(){}ct.prototype.nodeName="#document-fragment",ct.prototype.nodeType=y,f(ct,re);function ht(){}ht.prototype.nodeType=v,f(ht,re);function Ze(){}Ze.prototype.serializeToString=function(p,o,D){return ot.call(p,o,D)},re.prototype.toString=ot;function ot(p,o){var D=[],z=this.nodeType==9&&this.documentElement||this,u=z.prefix,M=z.namespaceURI;if(M&&u==null){var u=z.lookupPrefix(M);if(u==null)var V=[{namespace:M,prefix:null}]}return $(this,D,p,o,V),D.join("")}function wt(p,o,D){var z=p.prefix||"",u=p.namespaceURI;if(!u||z==="xml"&&u===t.XML||u===t.XMLNS)return!1;for(var M=D.length;M--;){var V=D[M];if(V.prefix===z)return V.namespace!==u}return!0}function C(p,o,D){p.push(" ",o,'="',D.replace(/[<&"]/g,ce),'"')}function $(p,o,D,z,u){if(u||(u=[]),z)if(p=z(p),p){if(typeof p=="string"){o.push(p);return}}else return;switch(p.nodeType){case c:var M=p.attributes,V=M.length,Le=p.firstChild,_=p.tagName;D=t.isHTML(p.namespaceURI)||D;var B=_;if(!D&&!p.prefix&&p.namespaceURI){for(var G,ge=0;ge<M.length;ge++)if(M.item(ge).name==="xmlns"){G=M.item(ge).value;break}if(!G)for(var fe=u.length-1;fe>=0;fe--){var de=u[fe];if(de.prefix===""&&de.namespace===p.namespaceURI){G=de.namespace;break}}if(G!==p.namespaceURI)for(var fe=u.length-1;fe>=0;fe--){var de=u[fe];if(de.namespace===p.namespaceURI){de.prefix&&(B=de.prefix+":"+_);break}}}o.push("<",B);for(var Ce=0;Ce<V;Ce++){var Xe=M.item(Ce);Xe.prefix=="xmlns"?u.push({prefix:Xe.localName,namespace:Xe.value}):Xe.nodeName=="xmlns"&&u.push({prefix:"",namespace:Xe.value})}for(var Ce=0;Ce<V;Ce++){var Xe=M.item(Ce);if(wt(Xe,D,u)){var Ue=Xe.prefix||"",ke=Xe.namespaceURI;C(o,Ue?"xmlns:"+Ue:"xmlns",ke),u.push({prefix:Ue,namespace:ke})}$(Xe,o,D,z,u)}if(_===B&&wt(p,D,u)){var Ue=p.prefix||"",ke=p.namespaceURI;C(o,Ue?"xmlns:"+Ue:"xmlns",ke),u.push({prefix:Ue,namespace:ke})}if(Le||D&&!/^(?:meta|link|img|br|hr|input)$/i.test(_)){if(o.push(">"),D&&/^script$/i.test(_))for(;Le;)Le.data?o.push(Le.data):$(Le,o,D,z,u.slice()),Le=Le.nextSibling;else for(;Le;)$(Le,o,D,z,u.slice()),Le=Le.nextSibling;o.push("</",B,">")}else o.push("/>");return;case E:case y:for(var Le=p.firstChild;Le;)$(Le,o,D,z,u.slice()),Le=Le.nextSibling;return;case b:return C(o,p.name,p.value);case m:return o.push(p.data.replace(/[<&]/g,ce).replace(/]]>/g,"]]&gt;"));case N:return o.push("<![CDATA[",p.data,"]]>");case g:return o.push("<!--",p.data,"-->");case L:var Je=p.publicId,Ge=p.systemId;if(o.push("<!DOCTYPE ",p.name),Je)o.push(" PUBLIC ",Je),Ge&&Ge!="."&&o.push(" ",Ge),o.push(">");else if(Ge&&Ge!=".")o.push(" SYSTEM ",Ge,">");else{var Tt=p.internalSubset;Tt&&o.push(" [",Tt,"]"),o.push(">")}return;case v:return o.push("<?",p.target," ",p.data,"?>");case w:return o.push("&",p.nodeName,";");default:o.push("??",p.nodeName)}}function te(p,o,D){var z;switch(o.nodeType){case c:z=o.cloneNode(!1),z.ownerDocument=p;case y:break;case b:D=!0;break}if(z||(z=o.cloneNode(!1)),z.ownerDocument=p,z.parentNode=null,D)for(var u=o.firstChild;u;)z.appendChild(te(p,u,D)),u=u.nextSibling;return z}function ve(p,o,D){var z=new o.constructor;for(var u in o)if(Object.prototype.hasOwnProperty.call(o,u)){var M=o[u];typeof M!="object"&&M!=z[u]&&(z[u]=M)}switch(o.childNodes&&(z.childNodes=new Z),z.ownerDocument=p,z.nodeType){case c:var V=o.attributes,_=z.attributes=new he,B=V.length;_._ownerElement=z;for(var G=0;G<B;G++)z.setAttributeNode(ve(p,V.item(G),!0));break;case b:D=!0}if(D)for(var ge=o.firstChild;ge;)z.appendChild(ve(p,ge,D)),ge=ge.nextSibling;return z}function P(p,o,D){p[o]=D}try{if(Object.defineProperty){let p=function(o){switch(o.nodeType){case c:case y:var D=[];for(o=o.firstChild;o;)o.nodeType!==7&&o.nodeType!==8&&D.push(p(o)),o=o.nextSibling;return D.join("");default:return o.nodeValue}};Object.defineProperty(K.prototype,"length",{get:function(){return J(this),this.$$length}}),Object.defineProperty(re.prototype,"textContent",{get:function(){return p(this)},set:function(o){switch(this.nodeType){case c:case y:for(;this.firstChild;)this.removeChild(this.firstChild);(o||String(o))&&this.appendChild(this.ownerDocument.createTextNode(o));break;default:this.data=o,this.value=o,this.nodeValue=o}}}),P=function(o,D,z){o["$$"+D]=z}}}catch{}return kt.DocumentType=tt,kt.DOMException=j,kt.DOMImplementation=ye,kt.Element=Ae,kt.Node=re,kt.NodeList=Z,kt.XMLSerializer=Ze,kt}var Mt={},Gr={},tn;function Fs(){return tn||(tn=1,(function(x){var e=yr().freeze;x.XML_ENTITIES=e({amp:"&",apos:"'",gt:">",lt:"<",quot:'"'}),x.HTML_ENTITIES=e({Aacute:"Ã",aacute:"Ã¡",Abreve:"Ä‚",abreve:"Äƒ",ac:"âˆ¾",acd:"âˆ¿",acE:"âˆ¾Ì³",Acirc:"Ã‚",acirc:"Ã¢",acute:"Â´",Acy:"Ğ",acy:"Ğ°",AElig:"Ã†",aelig:"Ã¦",af:"â¡",Afr:"ğ”„",afr:"ğ”",Agrave:"Ã€",agrave:"Ã ",alefsym:"â„µ",aleph:"â„µ",Alpha:"Î‘",alpha:"Î±",Amacr:"Ä€",amacr:"Ä",amalg:"â¨¿",AMP:"&",amp:"&",And:"â©“",and:"âˆ§",andand:"â©•",andd:"â©œ",andslope:"â©˜",andv:"â©š",ang:"âˆ ",ange:"â¦¤",angle:"âˆ ",angmsd:"âˆ¡",angmsdaa:"â¦¨",angmsdab:"â¦©",angmsdac:"â¦ª",angmsdad:"â¦«",angmsdae:"â¦¬",angmsdaf:"â¦­",angmsdag:"â¦®",angmsdah:"â¦¯",angrt:"âˆŸ",angrtvb:"âŠ¾",angrtvbd:"â¦",angsph:"âˆ¢",angst:"Ã…",angzarr:"â¼",Aogon:"Ä„",aogon:"Ä…",Aopf:"ğ”¸",aopf:"ğ•’",ap:"â‰ˆ",apacir:"â©¯",apE:"â©°",ape:"â‰Š",apid:"â‰‹",apos:"'",ApplyFunction:"â¡",approx:"â‰ˆ",approxeq:"â‰Š",Aring:"Ã…",aring:"Ã¥",Ascr:"ğ’œ",ascr:"ğ’¶",Assign:"â‰”",ast:"*",asymp:"â‰ˆ",asympeq:"â‰",Atilde:"Ãƒ",atilde:"Ã£",Auml:"Ã„",auml:"Ã¤",awconint:"âˆ³",awint:"â¨‘",backcong:"â‰Œ",backepsilon:"Ï¶",backprime:"â€µ",backsim:"âˆ½",backsimeq:"â‹",Backslash:"âˆ–",Barv:"â«§",barvee:"âŠ½",Barwed:"âŒ†",barwed:"âŒ…",barwedge:"âŒ…",bbrk:"âµ",bbrktbrk:"â¶",bcong:"â‰Œ",Bcy:"Ğ‘",bcy:"Ğ±",bdquo:"â€",becaus:"âˆµ",Because:"âˆµ",because:"âˆµ",bemptyv:"â¦°",bepsi:"Ï¶",bernou:"â„¬",Bernoullis:"â„¬",Beta:"Î’",beta:"Î²",beth:"â„¶",between:"â‰¬",Bfr:"ğ”…",bfr:"ğ”Ÿ",bigcap:"â‹‚",bigcirc:"â—¯",bigcup:"â‹ƒ",bigodot:"â¨€",bigoplus:"â¨",bigotimes:"â¨‚",bigsqcup:"â¨†",bigstar:"â˜…",bigtriangledown:"â–½",bigtriangleup:"â–³",biguplus:"â¨„",bigvee:"â‹",bigwedge:"â‹€",bkarow:"â¤",blacklozenge:"â§«",blacksquare:"â–ª",blacktriangle:"â–´",blacktriangledown:"â–¾",blacktriangleleft:"â—‚",blacktriangleright:"â–¸",blank:"â£",blk12:"â–’",blk14:"â–‘",blk34:"â–“",block:"â–ˆ",bne:"=âƒ¥",bnequiv:"â‰¡âƒ¥",bNot:"â«­",bnot:"âŒ",Bopf:"ğ”¹",bopf:"ğ•“",bot:"âŠ¥",bottom:"âŠ¥",bowtie:"â‹ˆ",boxbox:"â§‰",boxDL:"â•—",boxDl:"â•–",boxdL:"â••",boxdl:"â”",boxDR:"â•”",boxDr:"â•“",boxdR:"â•’",boxdr:"â”Œ",boxH:"â•",boxh:"â”€",boxHD:"â•¦",boxHd:"â•¤",boxhD:"â•¥",boxhd:"â”¬",boxHU:"â•©",boxHu:"â•§",boxhU:"â•¨",boxhu:"â”´",boxminus:"âŠŸ",boxplus:"âŠ",boxtimes:"âŠ ",boxUL:"â•",boxUl:"â•œ",boxuL:"â•›",boxul:"â”˜",boxUR:"â•š",boxUr:"â•™",boxuR:"â•˜",boxur:"â””",boxV:"â•‘",boxv:"â”‚",boxVH:"â•¬",boxVh:"â•«",boxvH:"â•ª",boxvh:"â”¼",boxVL:"â•£",boxVl:"â•¢",boxvL:"â•¡",boxvl:"â”¤",boxVR:"â• ",boxVr:"â•Ÿ",boxvR:"â•",boxvr:"â”œ",bprime:"â€µ",Breve:"Ë˜",breve:"Ë˜",brvbar:"Â¦",Bscr:"â„¬",bscr:"ğ’·",bsemi:"â",bsim:"âˆ½",bsime:"â‹",bsol:"\\",bsolb:"â§…",bsolhsub:"âŸˆ",bull:"â€¢",bullet:"â€¢",bump:"â‰",bumpE:"âª®",bumpe:"â‰",Bumpeq:"â‰",bumpeq:"â‰",Cacute:"Ä†",cacute:"Ä‡",Cap:"â‹’",cap:"âˆ©",capand:"â©„",capbrcup:"â©‰",capcap:"â©‹",capcup:"â©‡",capdot:"â©€",CapitalDifferentialD:"â……",caps:"âˆ©ï¸€",caret:"â",caron:"Ë‡",Cayleys:"â„­",ccaps:"â©",Ccaron:"ÄŒ",ccaron:"Ä",Ccedil:"Ã‡",ccedil:"Ã§",Ccirc:"Äˆ",ccirc:"Ä‰",Cconint:"âˆ°",ccups:"â©Œ",ccupssm:"â©",Cdot:"ÄŠ",cdot:"Ä‹",cedil:"Â¸",Cedilla:"Â¸",cemptyv:"â¦²",cent:"Â¢",CenterDot:"Â·",centerdot:"Â·",Cfr:"â„­",cfr:"ğ” ",CHcy:"Ğ§",chcy:"Ñ‡",check:"âœ“",checkmark:"âœ“",Chi:"Î§",chi:"Ï‡",cir:"â—‹",circ:"Ë†",circeq:"â‰—",circlearrowleft:"â†º",circlearrowright:"â†»",circledast:"âŠ›",circledcirc:"âŠš",circleddash:"âŠ",CircleDot:"âŠ™",circledR:"Â®",circledS:"â“ˆ",CircleMinus:"âŠ–",CirclePlus:"âŠ•",CircleTimes:"âŠ—",cirE:"â§ƒ",cire:"â‰—",cirfnint:"â¨",cirmid:"â«¯",cirscir:"â§‚",ClockwiseContourIntegral:"âˆ²",CloseCurlyDoubleQuote:"â€",CloseCurlyQuote:"â€™",clubs:"â™£",clubsuit:"â™£",Colon:"âˆ·",colon:":",Colone:"â©´",colone:"â‰”",coloneq:"â‰”",comma:",",commat:"@",comp:"âˆ",compfn:"âˆ˜",complement:"âˆ",complexes:"â„‚",cong:"â‰…",congdot:"â©­",Congruent:"â‰¡",Conint:"âˆ¯",conint:"âˆ®",ContourIntegral:"âˆ®",Copf:"â„‚",copf:"ğ•”",coprod:"âˆ",Coproduct:"âˆ",COPY:"Â©",copy:"Â©",copysr:"â„—",CounterClockwiseContourIntegral:"âˆ³",crarr:"â†µ",Cross:"â¨¯",cross:"âœ—",Cscr:"ğ’",cscr:"ğ’¸",csub:"â«",csube:"â«‘",csup:"â«",csupe:"â«’",ctdot:"â‹¯",cudarrl:"â¤¸",cudarrr:"â¤µ",cuepr:"â‹",cuesc:"â‹Ÿ",cularr:"â†¶",cularrp:"â¤½",Cup:"â‹“",cup:"âˆª",cupbrcap:"â©ˆ",CupCap:"â‰",cupcap:"â©†",cupcup:"â©Š",cupdot:"âŠ",cupor:"â©…",cups:"âˆªï¸€",curarr:"â†·",curarrm:"â¤¼",curlyeqprec:"â‹",curlyeqsucc:"â‹Ÿ",curlyvee:"â‹",curlywedge:"â‹",curren:"Â¤",curvearrowleft:"â†¶",curvearrowright:"â†·",cuvee:"â‹",cuwed:"â‹",cwconint:"âˆ²",cwint:"âˆ±",cylcty:"âŒ­",Dagger:"â€¡",dagger:"â€ ",daleth:"â„¸",Darr:"â†¡",dArr:"â‡“",darr:"â†“",dash:"â€",Dashv:"â«¤",dashv:"âŠ£",dbkarow:"â¤",dblac:"Ë",Dcaron:"Ä",dcaron:"Ä",Dcy:"Ğ”",dcy:"Ğ´",DD:"â……",dd:"â…†",ddagger:"â€¡",ddarr:"â‡Š",DDotrahd:"â¤‘",ddotseq:"â©·",deg:"Â°",Del:"âˆ‡",Delta:"Î”",delta:"Î´",demptyv:"â¦±",dfisht:"â¥¿",Dfr:"ğ”‡",dfr:"ğ”¡",dHar:"â¥¥",dharl:"â‡ƒ",dharr:"â‡‚",DiacriticalAcute:"Â´",DiacriticalDot:"Ë™",DiacriticalDoubleAcute:"Ë",DiacriticalGrave:"`",DiacriticalTilde:"Ëœ",diam:"â‹„",Diamond:"â‹„",diamond:"â‹„",diamondsuit:"â™¦",diams:"â™¦",die:"Â¨",DifferentialD:"â…†",digamma:"Ï",disin:"â‹²",div:"Ã·",divide:"Ã·",divideontimes:"â‹‡",divonx:"â‹‡",DJcy:"Ğ‚",djcy:"Ñ’",dlcorn:"âŒ",dlcrop:"âŒ",dollar:"$",Dopf:"ğ”»",dopf:"ğ••",Dot:"Â¨",dot:"Ë™",DotDot:"âƒœ",doteq:"â‰",doteqdot:"â‰‘",DotEqual:"â‰",dotminus:"âˆ¸",dotplus:"âˆ”",dotsquare:"âŠ¡",doublebarwedge:"âŒ†",DoubleContourIntegral:"âˆ¯",DoubleDot:"Â¨",DoubleDownArrow:"â‡“",DoubleLeftArrow:"â‡",DoubleLeftRightArrow:"â‡”",DoubleLeftTee:"â«¤",DoubleLongLeftArrow:"âŸ¸",DoubleLongLeftRightArrow:"âŸº",DoubleLongRightArrow:"âŸ¹",DoubleRightArrow:"â‡’",DoubleRightTee:"âŠ¨",DoubleUpArrow:"â‡‘",DoubleUpDownArrow:"â‡•",DoubleVerticalBar:"âˆ¥",DownArrow:"â†“",Downarrow:"â‡“",downarrow:"â†“",DownArrowBar:"â¤“",DownArrowUpArrow:"â‡µ",DownBreve:"Ì‘",downdownarrows:"â‡Š",downharpoonleft:"â‡ƒ",downharpoonright:"â‡‚",DownLeftRightVector:"â¥",DownLeftTeeVector:"â¥",DownLeftVector:"â†½",DownLeftVectorBar:"â¥–",DownRightTeeVector:"â¥Ÿ",DownRightVector:"â‡",DownRightVectorBar:"â¥—",DownTee:"âŠ¤",DownTeeArrow:"â†§",drbkarow:"â¤",drcorn:"âŒŸ",drcrop:"âŒŒ",Dscr:"ğ’Ÿ",dscr:"ğ’¹",DScy:"Ğ…",dscy:"Ñ•",dsol:"â§¶",Dstrok:"Ä",dstrok:"Ä‘",dtdot:"â‹±",dtri:"â–¿",dtrif:"â–¾",duarr:"â‡µ",duhar:"â¥¯",dwangle:"â¦¦",DZcy:"Ğ",dzcy:"ÑŸ",dzigrarr:"âŸ¿",Eacute:"Ã‰",eacute:"Ã©",easter:"â©®",Ecaron:"Äš",ecaron:"Ä›",ecir:"â‰–",Ecirc:"ÃŠ",ecirc:"Ãª",ecolon:"â‰•",Ecy:"Ğ­",ecy:"Ñ",eDDot:"â©·",Edot:"Ä–",eDot:"â‰‘",edot:"Ä—",ee:"â…‡",efDot:"â‰’",Efr:"ğ”ˆ",efr:"ğ”¢",eg:"âªš",Egrave:"Ãˆ",egrave:"Ã¨",egs:"âª–",egsdot:"âª˜",el:"âª™",Element:"âˆˆ",elinters:"â§",ell:"â„“",els:"âª•",elsdot:"âª—",Emacr:"Ä’",emacr:"Ä“",empty:"âˆ…",emptyset:"âˆ…",EmptySmallSquare:"â—»",emptyv:"âˆ…",EmptyVerySmallSquare:"â–«",emsp:"â€ƒ",emsp13:"â€„",emsp14:"â€…",ENG:"ÅŠ",eng:"Å‹",ensp:"â€‚",Eogon:"Ä˜",eogon:"Ä™",Eopf:"ğ”¼",eopf:"ğ•–",epar:"â‹•",eparsl:"â§£",eplus:"â©±",epsi:"Îµ",Epsilon:"Î•",epsilon:"Îµ",epsiv:"Ïµ",eqcirc:"â‰–",eqcolon:"â‰•",eqsim:"â‰‚",eqslantgtr:"âª–",eqslantless:"âª•",Equal:"â©µ",equals:"=",EqualTilde:"â‰‚",equest:"â‰Ÿ",Equilibrium:"â‡Œ",equiv:"â‰¡",equivDD:"â©¸",eqvparsl:"â§¥",erarr:"â¥±",erDot:"â‰“",Escr:"â„°",escr:"â„¯",esdot:"â‰",Esim:"â©³",esim:"â‰‚",Eta:"Î—",eta:"Î·",ETH:"Ã",eth:"Ã°",Euml:"Ã‹",euml:"Ã«",euro:"â‚¬",excl:"!",exist:"âˆƒ",Exists:"âˆƒ",expectation:"â„°",ExponentialE:"â…‡",exponentiale:"â…‡",fallingdotseq:"â‰’",Fcy:"Ğ¤",fcy:"Ñ„",female:"â™€",ffilig:"ï¬ƒ",fflig:"ï¬€",ffllig:"ï¬„",Ffr:"ğ”‰",ffr:"ğ”£",filig:"ï¬",FilledSmallSquare:"â—¼",FilledVerySmallSquare:"â–ª",fjlig:"fj",flat:"â™­",fllig:"ï¬‚",fltns:"â–±",fnof:"Æ’",Fopf:"ğ”½",fopf:"ğ•—",ForAll:"âˆ€",forall:"âˆ€",fork:"â‹”",forkv:"â«™",Fouriertrf:"â„±",fpartint:"â¨",frac12:"Â½",frac13:"â…“",frac14:"Â¼",frac15:"â…•",frac16:"â…™",frac18:"â…›",frac23:"â…”",frac25:"â…–",frac34:"Â¾",frac35:"â…—",frac38:"â…œ",frac45:"â…˜",frac56:"â…š",frac58:"â…",frac78:"â…",frasl:"â„",frown:"âŒ¢",Fscr:"â„±",fscr:"ğ’»",gacute:"Çµ",Gamma:"Î“",gamma:"Î³",Gammad:"Ïœ",gammad:"Ï",gap:"âª†",Gbreve:"Ä",gbreve:"ÄŸ",Gcedil:"Ä¢",Gcirc:"Äœ",gcirc:"Ä",Gcy:"Ğ“",gcy:"Ğ³",Gdot:"Ä ",gdot:"Ä¡",gE:"â‰§",ge:"â‰¥",gEl:"âªŒ",gel:"â‹›",geq:"â‰¥",geqq:"â‰§",geqslant:"â©¾",ges:"â©¾",gescc:"âª©",gesdot:"âª€",gesdoto:"âª‚",gesdotol:"âª„",gesl:"â‹›ï¸€",gesles:"âª”",Gfr:"ğ”Š",gfr:"ğ”¤",Gg:"â‹™",gg:"â‰«",ggg:"â‹™",gimel:"â„·",GJcy:"Ğƒ",gjcy:"Ñ“",gl:"â‰·",gla:"âª¥",glE:"âª’",glj:"âª¤",gnap:"âªŠ",gnapprox:"âªŠ",gnE:"â‰©",gne:"âªˆ",gneq:"âªˆ",gneqq:"â‰©",gnsim:"â‹§",Gopf:"ğ”¾",gopf:"ğ•˜",grave:"`",GreaterEqual:"â‰¥",GreaterEqualLess:"â‹›",GreaterFullEqual:"â‰§",GreaterGreater:"âª¢",GreaterLess:"â‰·",GreaterSlantEqual:"â©¾",GreaterTilde:"â‰³",Gscr:"ğ’¢",gscr:"â„Š",gsim:"â‰³",gsime:"âª",gsiml:"âª",Gt:"â‰«",GT:">",gt:">",gtcc:"âª§",gtcir:"â©º",gtdot:"â‹—",gtlPar:"â¦•",gtquest:"â©¼",gtrapprox:"âª†",gtrarr:"â¥¸",gtrdot:"â‹—",gtreqless:"â‹›",gtreqqless:"âªŒ",gtrless:"â‰·",gtrsim:"â‰³",gvertneqq:"â‰©ï¸€",gvnE:"â‰©ï¸€",Hacek:"Ë‡",hairsp:"â€Š",half:"Â½",hamilt:"â„‹",HARDcy:"Ğª",hardcy:"ÑŠ",hArr:"â‡”",harr:"â†”",harrcir:"â¥ˆ",harrw:"â†­",Hat:"^",hbar:"â„",Hcirc:"Ä¤",hcirc:"Ä¥",hearts:"â™¥",heartsuit:"â™¥",hellip:"â€¦",hercon:"âŠ¹",Hfr:"â„Œ",hfr:"ğ”¥",HilbertSpace:"â„‹",hksearow:"â¤¥",hkswarow:"â¤¦",hoarr:"â‡¿",homtht:"âˆ»",hookleftarrow:"â†©",hookrightarrow:"â†ª",Hopf:"â„",hopf:"ğ•™",horbar:"â€•",HorizontalLine:"â”€",Hscr:"â„‹",hscr:"ğ’½",hslash:"â„",Hstrok:"Ä¦",hstrok:"Ä§",HumpDownHump:"â‰",HumpEqual:"â‰",hybull:"âƒ",hyphen:"â€",Iacute:"Ã",iacute:"Ã­",ic:"â£",Icirc:"Ã",icirc:"Ã®",Icy:"Ğ˜",icy:"Ğ¸",Idot:"Ä°",IEcy:"Ğ•",iecy:"Ğµ",iexcl:"Â¡",iff:"â‡”",Ifr:"â„‘",ifr:"ğ”¦",Igrave:"ÃŒ",igrave:"Ã¬",ii:"â…ˆ",iiiint:"â¨Œ",iiint:"âˆ­",iinfin:"â§œ",iiota:"â„©",IJlig:"Ä²",ijlig:"Ä³",Im:"â„‘",Imacr:"Äª",imacr:"Ä«",image:"â„‘",ImaginaryI:"â…ˆ",imagline:"â„",imagpart:"â„‘",imath:"Ä±",imof:"âŠ·",imped:"Æµ",Implies:"â‡’",in:"âˆˆ",incare:"â„…",infin:"âˆ",infintie:"â§",inodot:"Ä±",Int:"âˆ¬",int:"âˆ«",intcal:"âŠº",integers:"â„¤",Integral:"âˆ«",intercal:"âŠº",Intersection:"â‹‚",intlarhk:"â¨—",intprod:"â¨¼",InvisibleComma:"â£",InvisibleTimes:"â¢",IOcy:"Ğ",iocy:"Ñ‘",Iogon:"Ä®",iogon:"Ä¯",Iopf:"ğ•€",iopf:"ğ•š",Iota:"Î™",iota:"Î¹",iprod:"â¨¼",iquest:"Â¿",Iscr:"â„",iscr:"ğ’¾",isin:"âˆˆ",isindot:"â‹µ",isinE:"â‹¹",isins:"â‹´",isinsv:"â‹³",isinv:"âˆˆ",it:"â¢",Itilde:"Ä¨",itilde:"Ä©",Iukcy:"Ğ†",iukcy:"Ñ–",Iuml:"Ã",iuml:"Ã¯",Jcirc:"Ä´",jcirc:"Äµ",Jcy:"Ğ™",jcy:"Ğ¹",Jfr:"ğ”",jfr:"ğ”§",jmath:"È·",Jopf:"ğ•",jopf:"ğ•›",Jscr:"ğ’¥",jscr:"ğ’¿",Jsercy:"Ğˆ",jsercy:"Ñ˜",Jukcy:"Ğ„",jukcy:"Ñ”",Kappa:"Îš",kappa:"Îº",kappav:"Ï°",Kcedil:"Ä¶",kcedil:"Ä·",Kcy:"Ğš",kcy:"Ğº",Kfr:"ğ”",kfr:"ğ”¨",kgreen:"Ä¸",KHcy:"Ğ¥",khcy:"Ñ…",KJcy:"ĞŒ",kjcy:"Ñœ",Kopf:"ğ•‚",kopf:"ğ•œ",Kscr:"ğ’¦",kscr:"ğ“€",lAarr:"â‡š",Lacute:"Ä¹",lacute:"Äº",laemptyv:"â¦´",lagran:"â„’",Lambda:"Î›",lambda:"Î»",Lang:"âŸª",lang:"âŸ¨",langd:"â¦‘",langle:"âŸ¨",lap:"âª…",Laplacetrf:"â„’",laquo:"Â«",Larr:"â†",lArr:"â‡",larr:"â†",larrb:"â‡¤",larrbfs:"â¤Ÿ",larrfs:"â¤",larrhk:"â†©",larrlp:"â†«",larrpl:"â¤¹",larrsim:"â¥³",larrtl:"â†¢",lat:"âª«",lAtail:"â¤›",latail:"â¤™",late:"âª­",lates:"âª­ï¸€",lBarr:"â¤",lbarr:"â¤Œ",lbbrk:"â²",lbrace:"{",lbrack:"[",lbrke:"â¦‹",lbrksld:"â¦",lbrkslu:"â¦",Lcaron:"Ä½",lcaron:"Ä¾",Lcedil:"Ä»",lcedil:"Ä¼",lceil:"âŒˆ",lcub:"{",Lcy:"Ğ›",lcy:"Ğ»",ldca:"â¤¶",ldquo:"â€œ",ldquor:"â€",ldrdhar:"â¥§",ldrushar:"â¥‹",ldsh:"â†²",lE:"â‰¦",le:"â‰¤",LeftAngleBracket:"âŸ¨",LeftArrow:"â†",Leftarrow:"â‡",leftarrow:"â†",LeftArrowBar:"â‡¤",LeftArrowRightArrow:"â‡†",leftarrowtail:"â†¢",LeftCeiling:"âŒˆ",LeftDoubleBracket:"âŸ¦",LeftDownTeeVector:"â¥¡",LeftDownVector:"â‡ƒ",LeftDownVectorBar:"â¥™",LeftFloor:"âŒŠ",leftharpoondown:"â†½",leftharpoonup:"â†¼",leftleftarrows:"â‡‡",LeftRightArrow:"â†”",Leftrightarrow:"â‡”",leftrightarrow:"â†”",leftrightarrows:"â‡†",leftrightharpoons:"â‡‹",leftrightsquigarrow:"â†­",LeftRightVector:"â¥",LeftTee:"âŠ£",LeftTeeArrow:"â†¤",LeftTeeVector:"â¥š",leftthreetimes:"â‹‹",LeftTriangle:"âŠ²",LeftTriangleBar:"â§",LeftTriangleEqual:"âŠ´",LeftUpDownVector:"â¥‘",LeftUpTeeVector:"â¥ ",LeftUpVector:"â†¿",LeftUpVectorBar:"â¥˜",LeftVector:"â†¼",LeftVectorBar:"â¥’",lEg:"âª‹",leg:"â‹š",leq:"â‰¤",leqq:"â‰¦",leqslant:"â©½",les:"â©½",lescc:"âª¨",lesdot:"â©¿",lesdoto:"âª",lesdotor:"âªƒ",lesg:"â‹šï¸€",lesges:"âª“",lessapprox:"âª…",lessdot:"â‹–",lesseqgtr:"â‹š",lesseqqgtr:"âª‹",LessEqualGreater:"â‹š",LessFullEqual:"â‰¦",LessGreater:"â‰¶",lessgtr:"â‰¶",LessLess:"âª¡",lesssim:"â‰²",LessSlantEqual:"â©½",LessTilde:"â‰²",lfisht:"â¥¼",lfloor:"âŒŠ",Lfr:"ğ”",lfr:"ğ”©",lg:"â‰¶",lgE:"âª‘",lHar:"â¥¢",lhard:"â†½",lharu:"â†¼",lharul:"â¥ª",lhblk:"â–„",LJcy:"Ğ‰",ljcy:"Ñ™",Ll:"â‹˜",ll:"â‰ª",llarr:"â‡‡",llcorner:"âŒ",Lleftarrow:"â‡š",llhard:"â¥«",lltri:"â—º",Lmidot:"Ä¿",lmidot:"Å€",lmoust:"â°",lmoustache:"â°",lnap:"âª‰",lnapprox:"âª‰",lnE:"â‰¨",lne:"âª‡",lneq:"âª‡",lneqq:"â‰¨",lnsim:"â‹¦",loang:"âŸ¬",loarr:"â‡½",lobrk:"âŸ¦",LongLeftArrow:"âŸµ",Longleftarrow:"âŸ¸",longleftarrow:"âŸµ",LongLeftRightArrow:"âŸ·",Longleftrightarrow:"âŸº",longleftrightarrow:"âŸ·",longmapsto:"âŸ¼",LongRightArrow:"âŸ¶",Longrightarrow:"âŸ¹",longrightarrow:"âŸ¶",looparrowleft:"â†«",looparrowright:"â†¬",lopar:"â¦…",Lopf:"ğ•ƒ",lopf:"ğ•",loplus:"â¨­",lotimes:"â¨´",lowast:"âˆ—",lowbar:"_",LowerLeftArrow:"â†™",LowerRightArrow:"â†˜",loz:"â—Š",lozenge:"â—Š",lozf:"â§«",lpar:"(",lparlt:"â¦“",lrarr:"â‡†",lrcorner:"âŒŸ",lrhar:"â‡‹",lrhard:"â¥­",lrm:"â€",lrtri:"âŠ¿",lsaquo:"â€¹",Lscr:"â„’",lscr:"ğ“",Lsh:"â†°",lsh:"â†°",lsim:"â‰²",lsime:"âª",lsimg:"âª",lsqb:"[",lsquo:"â€˜",lsquor:"â€š",Lstrok:"Å",lstrok:"Å‚",Lt:"â‰ª",LT:"<",lt:"<",ltcc:"âª¦",ltcir:"â©¹",ltdot:"â‹–",lthree:"â‹‹",ltimes:"â‹‰",ltlarr:"â¥¶",ltquest:"â©»",ltri:"â—ƒ",ltrie:"âŠ´",ltrif:"â—‚",ltrPar:"â¦–",lurdshar:"â¥Š",luruhar:"â¥¦",lvertneqq:"â‰¨ï¸€",lvnE:"â‰¨ï¸€",macr:"Â¯",male:"â™‚",malt:"âœ ",maltese:"âœ ",Map:"â¤…",map:"â†¦",mapsto:"â†¦",mapstodown:"â†§",mapstoleft:"â†¤",mapstoup:"â†¥",marker:"â–®",mcomma:"â¨©",Mcy:"Ğœ",mcy:"Ğ¼",mdash:"â€”",mDDot:"âˆº",measuredangle:"âˆ¡",MediumSpace:"âŸ",Mellintrf:"â„³",Mfr:"ğ”",mfr:"ğ”ª",mho:"â„§",micro:"Âµ",mid:"âˆ£",midast:"*",midcir:"â«°",middot:"Â·",minus:"âˆ’",minusb:"âŠŸ",minusd:"âˆ¸",minusdu:"â¨ª",MinusPlus:"âˆ“",mlcp:"â«›",mldr:"â€¦",mnplus:"âˆ“",models:"âŠ§",Mopf:"ğ•„",mopf:"ğ•",mp:"âˆ“",Mscr:"â„³",mscr:"ğ“‚",mstpos:"âˆ¾",Mu:"Îœ",mu:"Î¼",multimap:"âŠ¸",mumap:"âŠ¸",nabla:"âˆ‡",Nacute:"Åƒ",nacute:"Å„",nang:"âˆ âƒ’",nap:"â‰‰",napE:"â©°Ì¸",napid:"â‰‹Ì¸",napos:"Å‰",napprox:"â‰‰",natur:"â™®",natural:"â™®",naturals:"â„•",nbsp:"Â ",nbump:"â‰Ì¸",nbumpe:"â‰Ì¸",ncap:"â©ƒ",Ncaron:"Å‡",ncaron:"Åˆ",Ncedil:"Å…",ncedil:"Å†",ncong:"â‰‡",ncongdot:"â©­Ì¸",ncup:"â©‚",Ncy:"Ğ",ncy:"Ğ½",ndash:"â€“",ne:"â‰ ",nearhk:"â¤¤",neArr:"â‡—",nearr:"â†—",nearrow:"â†—",nedot:"â‰Ì¸",NegativeMediumSpace:"â€‹",NegativeThickSpace:"â€‹",NegativeThinSpace:"â€‹",NegativeVeryThinSpace:"â€‹",nequiv:"â‰¢",nesear:"â¤¨",nesim:"â‰‚Ì¸",NestedGreaterGreater:"â‰«",NestedLessLess:"â‰ª",NewLine:`
`,nexist:"âˆ„",nexists:"âˆ„",Nfr:"ğ”‘",nfr:"ğ”«",ngE:"â‰§Ì¸",nge:"â‰±",ngeq:"â‰±",ngeqq:"â‰§Ì¸",ngeqslant:"â©¾Ì¸",nges:"â©¾Ì¸",nGg:"â‹™Ì¸",ngsim:"â‰µ",nGt:"â‰«âƒ’",ngt:"â‰¯",ngtr:"â‰¯",nGtv:"â‰«Ì¸",nhArr:"â‡",nharr:"â†®",nhpar:"â«²",ni:"âˆ‹",nis:"â‹¼",nisd:"â‹º",niv:"âˆ‹",NJcy:"ĞŠ",njcy:"Ñš",nlArr:"â‡",nlarr:"â†š",nldr:"â€¥",nlE:"â‰¦Ì¸",nle:"â‰°",nLeftarrow:"â‡",nleftarrow:"â†š",nLeftrightarrow:"â‡",nleftrightarrow:"â†®",nleq:"â‰°",nleqq:"â‰¦Ì¸",nleqslant:"â©½Ì¸",nles:"â©½Ì¸",nless:"â‰®",nLl:"â‹˜Ì¸",nlsim:"â‰´",nLt:"â‰ªâƒ’",nlt:"â‰®",nltri:"â‹ª",nltrie:"â‹¬",nLtv:"â‰ªÌ¸",nmid:"âˆ¤",NoBreak:"â ",NonBreakingSpace:"Â ",Nopf:"â„•",nopf:"ğ•Ÿ",Not:"â«¬",not:"Â¬",NotCongruent:"â‰¢",NotCupCap:"â‰­",NotDoubleVerticalBar:"âˆ¦",NotElement:"âˆ‰",NotEqual:"â‰ ",NotEqualTilde:"â‰‚Ì¸",NotExists:"âˆ„",NotGreater:"â‰¯",NotGreaterEqual:"â‰±",NotGreaterFullEqual:"â‰§Ì¸",NotGreaterGreater:"â‰«Ì¸",NotGreaterLess:"â‰¹",NotGreaterSlantEqual:"â©¾Ì¸",NotGreaterTilde:"â‰µ",NotHumpDownHump:"â‰Ì¸",NotHumpEqual:"â‰Ì¸",notin:"âˆ‰",notindot:"â‹µÌ¸",notinE:"â‹¹Ì¸",notinva:"âˆ‰",notinvb:"â‹·",notinvc:"â‹¶",NotLeftTriangle:"â‹ª",NotLeftTriangleBar:"â§Ì¸",NotLeftTriangleEqual:"â‹¬",NotLess:"â‰®",NotLessEqual:"â‰°",NotLessGreater:"â‰¸",NotLessLess:"â‰ªÌ¸",NotLessSlantEqual:"â©½Ì¸",NotLessTilde:"â‰´",NotNestedGreaterGreater:"âª¢Ì¸",NotNestedLessLess:"âª¡Ì¸",notni:"âˆŒ",notniva:"âˆŒ",notnivb:"â‹¾",notnivc:"â‹½",NotPrecedes:"âŠ€",NotPrecedesEqual:"âª¯Ì¸",NotPrecedesSlantEqual:"â‹ ",NotReverseElement:"âˆŒ",NotRightTriangle:"â‹«",NotRightTriangleBar:"â§Ì¸",NotRightTriangleEqual:"â‹­",NotSquareSubset:"âŠÌ¸",NotSquareSubsetEqual:"â‹¢",NotSquareSuperset:"âŠÌ¸",NotSquareSupersetEqual:"â‹£",NotSubset:"âŠ‚âƒ’",NotSubsetEqual:"âŠˆ",NotSucceeds:"âŠ",NotSucceedsEqual:"âª°Ì¸",NotSucceedsSlantEqual:"â‹¡",NotSucceedsTilde:"â‰¿Ì¸",NotSuperset:"âŠƒâƒ’",NotSupersetEqual:"âŠ‰",NotTilde:"â‰",NotTildeEqual:"â‰„",NotTildeFullEqual:"â‰‡",NotTildeTilde:"â‰‰",NotVerticalBar:"âˆ¤",npar:"âˆ¦",nparallel:"âˆ¦",nparsl:"â«½âƒ¥",npart:"âˆ‚Ì¸",npolint:"â¨”",npr:"âŠ€",nprcue:"â‹ ",npre:"âª¯Ì¸",nprec:"âŠ€",npreceq:"âª¯Ì¸",nrArr:"â‡",nrarr:"â†›",nrarrc:"â¤³Ì¸",nrarrw:"â†Ì¸",nRightarrow:"â‡",nrightarrow:"â†›",nrtri:"â‹«",nrtrie:"â‹­",nsc:"âŠ",nsccue:"â‹¡",nsce:"âª°Ì¸",Nscr:"ğ’©",nscr:"ğ“ƒ",nshortmid:"âˆ¤",nshortparallel:"âˆ¦",nsim:"â‰",nsime:"â‰„",nsimeq:"â‰„",nsmid:"âˆ¤",nspar:"âˆ¦",nsqsube:"â‹¢",nsqsupe:"â‹£",nsub:"âŠ„",nsubE:"â«…Ì¸",nsube:"âŠˆ",nsubset:"âŠ‚âƒ’",nsubseteq:"âŠˆ",nsubseteqq:"â«…Ì¸",nsucc:"âŠ",nsucceq:"âª°Ì¸",nsup:"âŠ…",nsupE:"â«†Ì¸",nsupe:"âŠ‰",nsupset:"âŠƒâƒ’",nsupseteq:"âŠ‰",nsupseteqq:"â«†Ì¸",ntgl:"â‰¹",Ntilde:"Ã‘",ntilde:"Ã±",ntlg:"â‰¸",ntriangleleft:"â‹ª",ntrianglelefteq:"â‹¬",ntriangleright:"â‹«",ntrianglerighteq:"â‹­",Nu:"Î",nu:"Î½",num:"#",numero:"â„–",numsp:"â€‡",nvap:"â‰âƒ’",nVDash:"âŠ¯",nVdash:"âŠ®",nvDash:"âŠ­",nvdash:"âŠ¬",nvge:"â‰¥âƒ’",nvgt:">âƒ’",nvHarr:"â¤„",nvinfin:"â§",nvlArr:"â¤‚",nvle:"â‰¤âƒ’",nvlt:"<âƒ’",nvltrie:"âŠ´âƒ’",nvrArr:"â¤ƒ",nvrtrie:"âŠµâƒ’",nvsim:"âˆ¼âƒ’",nwarhk:"â¤£",nwArr:"â‡–",nwarr:"â†–",nwarrow:"â†–",nwnear:"â¤§",Oacute:"Ã“",oacute:"Ã³",oast:"âŠ›",ocir:"âŠš",Ocirc:"Ã”",ocirc:"Ã´",Ocy:"Ğ",ocy:"Ğ¾",odash:"âŠ",Odblac:"Å",odblac:"Å‘",odiv:"â¨¸",odot:"âŠ™",odsold:"â¦¼",OElig:"Å’",oelig:"Å“",ofcir:"â¦¿",Ofr:"ğ”’",ofr:"ğ”¬",ogon:"Ë›",Ograve:"Ã’",ograve:"Ã²",ogt:"â§",ohbar:"â¦µ",ohm:"Î©",oint:"âˆ®",olarr:"â†º",olcir:"â¦¾",olcross:"â¦»",oline:"â€¾",olt:"â§€",Omacr:"ÅŒ",omacr:"Å",Omega:"Î©",omega:"Ï‰",Omicron:"ÎŸ",omicron:"Î¿",omid:"â¦¶",ominus:"âŠ–",Oopf:"ğ•†",oopf:"ğ• ",opar:"â¦·",OpenCurlyDoubleQuote:"â€œ",OpenCurlyQuote:"â€˜",operp:"â¦¹",oplus:"âŠ•",Or:"â©”",or:"âˆ¨",orarr:"â†»",ord:"â©",order:"â„´",orderof:"â„´",ordf:"Âª",ordm:"Âº",origof:"âŠ¶",oror:"â©–",orslope:"â©—",orv:"â©›",oS:"â“ˆ",Oscr:"ğ’ª",oscr:"â„´",Oslash:"Ã˜",oslash:"Ã¸",osol:"âŠ˜",Otilde:"Ã•",otilde:"Ãµ",Otimes:"â¨·",otimes:"âŠ—",otimesas:"â¨¶",Ouml:"Ã–",ouml:"Ã¶",ovbar:"âŒ½",OverBar:"â€¾",OverBrace:"â",OverBracket:"â´",OverParenthesis:"âœ",par:"âˆ¥",para:"Â¶",parallel:"âˆ¥",parsim:"â«³",parsl:"â«½",part:"âˆ‚",PartialD:"âˆ‚",Pcy:"ĞŸ",pcy:"Ğ¿",percnt:"%",period:".",permil:"â€°",perp:"âŠ¥",pertenk:"â€±",Pfr:"ğ”“",pfr:"ğ”­",Phi:"Î¦",phi:"Ï†",phiv:"Ï•",phmmat:"â„³",phone:"â˜",Pi:"Î ",pi:"Ï€",pitchfork:"â‹”",piv:"Ï–",planck:"â„",planckh:"â„",plankv:"â„",plus:"+",plusacir:"â¨£",plusb:"âŠ",pluscir:"â¨¢",plusdo:"âˆ”",plusdu:"â¨¥",pluse:"â©²",PlusMinus:"Â±",plusmn:"Â±",plussim:"â¨¦",plustwo:"â¨§",pm:"Â±",Poincareplane:"â„Œ",pointint:"â¨•",Popf:"â„™",popf:"ğ•¡",pound:"Â£",Pr:"âª»",pr:"â‰º",prap:"âª·",prcue:"â‰¼",prE:"âª³",pre:"âª¯",prec:"â‰º",precapprox:"âª·",preccurlyeq:"â‰¼",Precedes:"â‰º",PrecedesEqual:"âª¯",PrecedesSlantEqual:"â‰¼",PrecedesTilde:"â‰¾",preceq:"âª¯",precnapprox:"âª¹",precneqq:"âªµ",precnsim:"â‹¨",precsim:"â‰¾",Prime:"â€³",prime:"â€²",primes:"â„™",prnap:"âª¹",prnE:"âªµ",prnsim:"â‹¨",prod:"âˆ",Product:"âˆ",profalar:"âŒ®",profline:"âŒ’",profsurf:"âŒ“",prop:"âˆ",Proportion:"âˆ·",Proportional:"âˆ",propto:"âˆ",prsim:"â‰¾",prurel:"âŠ°",Pscr:"ğ’«",pscr:"ğ“…",Psi:"Î¨",psi:"Ïˆ",puncsp:"â€ˆ",Qfr:"ğ””",qfr:"ğ”®",qint:"â¨Œ",Qopf:"â„š",qopf:"ğ•¢",qprime:"â—",Qscr:"ğ’¬",qscr:"ğ“†",quaternions:"â„",quatint:"â¨–",quest:"?",questeq:"â‰Ÿ",QUOT:'"',quot:'"',rAarr:"â‡›",race:"âˆ½Ì±",Racute:"Å”",racute:"Å•",radic:"âˆš",raemptyv:"â¦³",Rang:"âŸ«",rang:"âŸ©",rangd:"â¦’",range:"â¦¥",rangle:"âŸ©",raquo:"Â»",Rarr:"â† ",rArr:"â‡’",rarr:"â†’",rarrap:"â¥µ",rarrb:"â‡¥",rarrbfs:"â¤ ",rarrc:"â¤³",rarrfs:"â¤",rarrhk:"â†ª",rarrlp:"â†¬",rarrpl:"â¥…",rarrsim:"â¥´",Rarrtl:"â¤–",rarrtl:"â†£",rarrw:"â†",rAtail:"â¤œ",ratail:"â¤š",ratio:"âˆ¶",rationals:"â„š",RBarr:"â¤",rBarr:"â¤",rbarr:"â¤",rbbrk:"â³",rbrace:"}",rbrack:"]",rbrke:"â¦Œ",rbrksld:"â¦",rbrkslu:"â¦",Rcaron:"Å˜",rcaron:"Å™",Rcedil:"Å–",rcedil:"Å—",rceil:"âŒ‰",rcub:"}",Rcy:"Ğ ",rcy:"Ñ€",rdca:"â¤·",rdldhar:"â¥©",rdquo:"â€",rdquor:"â€",rdsh:"â†³",Re:"â„œ",real:"â„œ",realine:"â„›",realpart:"â„œ",reals:"â„",rect:"â–­",REG:"Â®",reg:"Â®",ReverseElement:"âˆ‹",ReverseEquilibrium:"â‡‹",ReverseUpEquilibrium:"â¥¯",rfisht:"â¥½",rfloor:"âŒ‹",Rfr:"â„œ",rfr:"ğ”¯",rHar:"â¥¤",rhard:"â‡",rharu:"â‡€",rharul:"â¥¬",Rho:"Î¡",rho:"Ï",rhov:"Ï±",RightAngleBracket:"âŸ©",RightArrow:"â†’",Rightarrow:"â‡’",rightarrow:"â†’",RightArrowBar:"â‡¥",RightArrowLeftArrow:"â‡„",rightarrowtail:"â†£",RightCeiling:"âŒ‰",RightDoubleBracket:"âŸ§",RightDownTeeVector:"â¥",RightDownVector:"â‡‚",RightDownVectorBar:"â¥•",RightFloor:"âŒ‹",rightharpoondown:"â‡",rightharpoonup:"â‡€",rightleftarrows:"â‡„",rightleftharpoons:"â‡Œ",rightrightarrows:"â‡‰",rightsquigarrow:"â†",RightTee:"âŠ¢",RightTeeArrow:"â†¦",RightTeeVector:"â¥›",rightthreetimes:"â‹Œ",RightTriangle:"âŠ³",RightTriangleBar:"â§",RightTriangleEqual:"âŠµ",RightUpDownVector:"â¥",RightUpTeeVector:"â¥œ",RightUpVector:"â†¾",RightUpVectorBar:"â¥”",RightVector:"â‡€",RightVectorBar:"â¥“",ring:"Ëš",risingdotseq:"â‰“",rlarr:"â‡„",rlhar:"â‡Œ",rlm:"â€",rmoust:"â±",rmoustache:"â±",rnmid:"â«®",roang:"âŸ­",roarr:"â‡¾",robrk:"âŸ§",ropar:"â¦†",Ropf:"â„",ropf:"ğ•£",roplus:"â¨®",rotimes:"â¨µ",RoundImplies:"â¥°",rpar:")",rpargt:"â¦”",rppolint:"â¨’",rrarr:"â‡‰",Rrightarrow:"â‡›",rsaquo:"â€º",Rscr:"â„›",rscr:"ğ“‡",Rsh:"â†±",rsh:"â†±",rsqb:"]",rsquo:"â€™",rsquor:"â€™",rthree:"â‹Œ",rtimes:"â‹Š",rtri:"â–¹",rtrie:"âŠµ",rtrif:"â–¸",rtriltri:"â§",RuleDelayed:"â§´",ruluhar:"â¥¨",rx:"â„",Sacute:"Åš",sacute:"Å›",sbquo:"â€š",Sc:"âª¼",sc:"â‰»",scap:"âª¸",Scaron:"Å ",scaron:"Å¡",sccue:"â‰½",scE:"âª´",sce:"âª°",Scedil:"Å",scedil:"ÅŸ",Scirc:"Åœ",scirc:"Å",scnap:"âªº",scnE:"âª¶",scnsim:"â‹©",scpolint:"â¨“",scsim:"â‰¿",Scy:"Ğ¡",scy:"Ñ",sdot:"â‹…",sdotb:"âŠ¡",sdote:"â©¦",searhk:"â¤¥",seArr:"â‡˜",searr:"â†˜",searrow:"â†˜",sect:"Â§",semi:";",seswar:"â¤©",setminus:"âˆ–",setmn:"âˆ–",sext:"âœ¶",Sfr:"ğ”–",sfr:"ğ”°",sfrown:"âŒ¢",sharp:"â™¯",SHCHcy:"Ğ©",shchcy:"Ñ‰",SHcy:"Ğ¨",shcy:"Ñˆ",ShortDownArrow:"â†“",ShortLeftArrow:"â†",shortmid:"âˆ£",shortparallel:"âˆ¥",ShortRightArrow:"â†’",ShortUpArrow:"â†‘",shy:"Â­",Sigma:"Î£",sigma:"Ïƒ",sigmaf:"Ï‚",sigmav:"Ï‚",sim:"âˆ¼",simdot:"â©ª",sime:"â‰ƒ",simeq:"â‰ƒ",simg:"âª",simgE:"âª ",siml:"âª",simlE:"âªŸ",simne:"â‰†",simplus:"â¨¤",simrarr:"â¥²",slarr:"â†",SmallCircle:"âˆ˜",smallsetminus:"âˆ–",smashp:"â¨³",smeparsl:"â§¤",smid:"âˆ£",smile:"âŒ£",smt:"âªª",smte:"âª¬",smtes:"âª¬ï¸€",SOFTcy:"Ğ¬",softcy:"ÑŒ",sol:"/",solb:"â§„",solbar:"âŒ¿",Sopf:"ğ•Š",sopf:"ğ•¤",spades:"â™ ",spadesuit:"â™ ",spar:"âˆ¥",sqcap:"âŠ“",sqcaps:"âŠ“ï¸€",sqcup:"âŠ”",sqcups:"âŠ”ï¸€",Sqrt:"âˆš",sqsub:"âŠ",sqsube:"âŠ‘",sqsubset:"âŠ",sqsubseteq:"âŠ‘",sqsup:"âŠ",sqsupe:"âŠ’",sqsupset:"âŠ",sqsupseteq:"âŠ’",squ:"â–¡",Square:"â–¡",square:"â–¡",SquareIntersection:"âŠ“",SquareSubset:"âŠ",SquareSubsetEqual:"âŠ‘",SquareSuperset:"âŠ",SquareSupersetEqual:"âŠ’",SquareUnion:"âŠ”",squarf:"â–ª",squf:"â–ª",srarr:"â†’",Sscr:"ğ’®",sscr:"ğ“ˆ",ssetmn:"âˆ–",ssmile:"âŒ£",sstarf:"â‹†",Star:"â‹†",star:"â˜†",starf:"â˜…",straightepsilon:"Ïµ",straightphi:"Ï•",strns:"Â¯",Sub:"â‹",sub:"âŠ‚",subdot:"âª½",subE:"â«…",sube:"âŠ†",subedot:"â«ƒ",submult:"â«",subnE:"â«‹",subne:"âŠŠ",subplus:"âª¿",subrarr:"â¥¹",Subset:"â‹",subset:"âŠ‚",subseteq:"âŠ†",subseteqq:"â«…",SubsetEqual:"âŠ†",subsetneq:"âŠŠ",subsetneqq:"â«‹",subsim:"â«‡",subsub:"â«•",subsup:"â«“",succ:"â‰»",succapprox:"âª¸",succcurlyeq:"â‰½",Succeeds:"â‰»",SucceedsEqual:"âª°",SucceedsSlantEqual:"â‰½",SucceedsTilde:"â‰¿",succeq:"âª°",succnapprox:"âªº",succneqq:"âª¶",succnsim:"â‹©",succsim:"â‰¿",SuchThat:"âˆ‹",Sum:"âˆ‘",sum:"âˆ‘",sung:"â™ª",Sup:"â‹‘",sup:"âŠƒ",sup1:"Â¹",sup2:"Â²",sup3:"Â³",supdot:"âª¾",supdsub:"â«˜",supE:"â«†",supe:"âŠ‡",supedot:"â«„",Superset:"âŠƒ",SupersetEqual:"âŠ‡",suphsol:"âŸ‰",suphsub:"â«—",suplarr:"â¥»",supmult:"â«‚",supnE:"â«Œ",supne:"âŠ‹",supplus:"â«€",Supset:"â‹‘",supset:"âŠƒ",supseteq:"âŠ‡",supseteqq:"â«†",supsetneq:"âŠ‹",supsetneqq:"â«Œ",supsim:"â«ˆ",supsub:"â«”",supsup:"â«–",swarhk:"â¤¦",swArr:"â‡™",swarr:"â†™",swarrow:"â†™",swnwar:"â¤ª",szlig:"ÃŸ",Tab:"	",target:"âŒ–",Tau:"Î¤",tau:"Ï„",tbrk:"â´",Tcaron:"Å¤",tcaron:"Å¥",Tcedil:"Å¢",tcedil:"Å£",Tcy:"Ğ¢",tcy:"Ñ‚",tdot:"âƒ›",telrec:"âŒ•",Tfr:"ğ”—",tfr:"ğ”±",there4:"âˆ´",Therefore:"âˆ´",therefore:"âˆ´",Theta:"Î˜",theta:"Î¸",thetasym:"Ï‘",thetav:"Ï‘",thickapprox:"â‰ˆ",thicksim:"âˆ¼",ThickSpace:"âŸâ€Š",thinsp:"â€‰",ThinSpace:"â€‰",thkap:"â‰ˆ",thksim:"âˆ¼",THORN:"Ã",thorn:"Ã¾",Tilde:"âˆ¼",tilde:"Ëœ",TildeEqual:"â‰ƒ",TildeFullEqual:"â‰…",TildeTilde:"â‰ˆ",times:"Ã—",timesb:"âŠ ",timesbar:"â¨±",timesd:"â¨°",tint:"âˆ­",toea:"â¤¨",top:"âŠ¤",topbot:"âŒ¶",topcir:"â«±",Topf:"ğ•‹",topf:"ğ•¥",topfork:"â«š",tosa:"â¤©",tprime:"â€´",TRADE:"â„¢",trade:"â„¢",triangle:"â–µ",triangledown:"â–¿",triangleleft:"â—ƒ",trianglelefteq:"âŠ´",triangleq:"â‰œ",triangleright:"â–¹",trianglerighteq:"âŠµ",tridot:"â—¬",trie:"â‰œ",triminus:"â¨º",TripleDot:"âƒ›",triplus:"â¨¹",trisb:"â§",tritime:"â¨»",trpezium:"â¢",Tscr:"ğ’¯",tscr:"ğ“‰",TScy:"Ğ¦",tscy:"Ñ†",TSHcy:"Ğ‹",tshcy:"Ñ›",Tstrok:"Å¦",tstrok:"Å§",twixt:"â‰¬",twoheadleftarrow:"â†",twoheadrightarrow:"â† ",Uacute:"Ãš",uacute:"Ãº",Uarr:"â†Ÿ",uArr:"â‡‘",uarr:"â†‘",Uarrocir:"â¥‰",Ubrcy:"Ğ",ubrcy:"Ñ",Ubreve:"Å¬",ubreve:"Å­",Ucirc:"Ã›",ucirc:"Ã»",Ucy:"Ğ£",ucy:"Ñƒ",udarr:"â‡…",Udblac:"Å°",udblac:"Å±",udhar:"â¥®",ufisht:"â¥¾",Ufr:"ğ”˜",ufr:"ğ”²",Ugrave:"Ã™",ugrave:"Ã¹",uHar:"â¥£",uharl:"â†¿",uharr:"â†¾",uhblk:"â–€",ulcorn:"âŒœ",ulcorner:"âŒœ",ulcrop:"âŒ",ultri:"â—¸",Umacr:"Åª",umacr:"Å«",uml:"Â¨",UnderBar:"_",UnderBrace:"âŸ",UnderBracket:"âµ",UnderParenthesis:"â",Union:"â‹ƒ",UnionPlus:"âŠ",Uogon:"Å²",uogon:"Å³",Uopf:"ğ•Œ",uopf:"ğ•¦",UpArrow:"â†‘",Uparrow:"â‡‘",uparrow:"â†‘",UpArrowBar:"â¤’",UpArrowDownArrow:"â‡…",UpDownArrow:"â†•",Updownarrow:"â‡•",updownarrow:"â†•",UpEquilibrium:"â¥®",upharpoonleft:"â†¿",upharpoonright:"â†¾",uplus:"âŠ",UpperLeftArrow:"â†–",UpperRightArrow:"â†—",Upsi:"Ï’",upsi:"Ï…",upsih:"Ï’",Upsilon:"Î¥",upsilon:"Ï…",UpTee:"âŠ¥",UpTeeArrow:"â†¥",upuparrows:"â‡ˆ",urcorn:"âŒ",urcorner:"âŒ",urcrop:"âŒ",Uring:"Å®",uring:"Å¯",urtri:"â—¹",Uscr:"ğ’°",uscr:"ğ“Š",utdot:"â‹°",Utilde:"Å¨",utilde:"Å©",utri:"â–µ",utrif:"â–´",uuarr:"â‡ˆ",Uuml:"Ãœ",uuml:"Ã¼",uwangle:"â¦§",vangrt:"â¦œ",varepsilon:"Ïµ",varkappa:"Ï°",varnothing:"âˆ…",varphi:"Ï•",varpi:"Ï–",varpropto:"âˆ",vArr:"â‡•",varr:"â†•",varrho:"Ï±",varsigma:"Ï‚",varsubsetneq:"âŠŠï¸€",varsubsetneqq:"â«‹ï¸€",varsupsetneq:"âŠ‹ï¸€",varsupsetneqq:"â«Œï¸€",vartheta:"Ï‘",vartriangleleft:"âŠ²",vartriangleright:"âŠ³",Vbar:"â««",vBar:"â«¨",vBarv:"â«©",Vcy:"Ğ’",vcy:"Ğ²",VDash:"âŠ«",Vdash:"âŠ©",vDash:"âŠ¨",vdash:"âŠ¢",Vdashl:"â«¦",Vee:"â‹",vee:"âˆ¨",veebar:"âŠ»",veeeq:"â‰š",vellip:"â‹®",Verbar:"â€–",verbar:"|",Vert:"â€–",vert:"|",VerticalBar:"âˆ£",VerticalLine:"|",VerticalSeparator:"â˜",VerticalTilde:"â‰€",VeryThinSpace:"â€Š",Vfr:"ğ”™",vfr:"ğ”³",vltri:"âŠ²",vnsub:"âŠ‚âƒ’",vnsup:"âŠƒâƒ’",Vopf:"ğ•",vopf:"ğ•§",vprop:"âˆ",vrtri:"âŠ³",Vscr:"ğ’±",vscr:"ğ“‹",vsubnE:"â«‹ï¸€",vsubne:"âŠŠï¸€",vsupnE:"â«Œï¸€",vsupne:"âŠ‹ï¸€",Vvdash:"âŠª",vzigzag:"â¦š",Wcirc:"Å´",wcirc:"Åµ",wedbar:"â©Ÿ",Wedge:"â‹€",wedge:"âˆ§",wedgeq:"â‰™",weierp:"â„˜",Wfr:"ğ”š",wfr:"ğ”´",Wopf:"ğ•",wopf:"ğ•¨",wp:"â„˜",wr:"â‰€",wreath:"â‰€",Wscr:"ğ’²",wscr:"ğ“Œ",xcap:"â‹‚",xcirc:"â—¯",xcup:"â‹ƒ",xdtri:"â–½",Xfr:"ğ”›",xfr:"ğ”µ",xhArr:"âŸº",xharr:"âŸ·",Xi:"Î",xi:"Î¾",xlArr:"âŸ¸",xlarr:"âŸµ",xmap:"âŸ¼",xnis:"â‹»",xodot:"â¨€",Xopf:"ğ•",xopf:"ğ•©",xoplus:"â¨",xotime:"â¨‚",xrArr:"âŸ¹",xrarr:"âŸ¶",Xscr:"ğ’³",xscr:"ğ“",xsqcup:"â¨†",xuplus:"â¨„",xutri:"â–³",xvee:"â‹",xwedge:"â‹€",Yacute:"Ã",yacute:"Ã½",YAcy:"Ğ¯",yacy:"Ñ",Ycirc:"Å¶",ycirc:"Å·",Ycy:"Ğ«",ycy:"Ñ‹",yen:"Â¥",Yfr:"ğ”œ",yfr:"ğ”¶",YIcy:"Ğ‡",yicy:"Ñ—",Yopf:"ğ•",yopf:"ğ•ª",Yscr:"ğ’´",yscr:"ğ“",YUcy:"Ğ®",yucy:"Ñ",Yuml:"Å¸",yuml:"Ã¿",Zacute:"Å¹",zacute:"Åº",Zcaron:"Å½",zcaron:"Å¾",Zcy:"Ğ—",zcy:"Ğ·",Zdot:"Å»",zdot:"Å¼",zeetrf:"â„¨",ZeroWidthSpace:"â€‹",Zeta:"Î–",zeta:"Î¶",Zfr:"â„¨",zfr:"ğ”·",ZHcy:"Ğ–",zhcy:"Ğ¶",zigrarr:"â‡",Zopf:"â„¤",zopf:"ğ•«",Zscr:"ğ’µ",zscr:"ğ“",zwj:"â€",zwnj:"â€Œ"}),x.entityMap=x.HTML_ENTITIES})(Gr)),Gr}var ar={},rn;function Ps(){if(rn)return ar;rn=1;var x=yr().NAMESPACE,e=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,t=new RegExp("[\\-\\.0-9"+e.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),r=new RegExp("^"+e.source+t.source+"*(?::"+e.source+t.source+"*)?$"),i=0,s=1,n=2,a=3,l=4,f=5,d=6,c=7;function b(k,O){this.message=k,this.locator=O,Error.captureStackTrace&&Error.captureStackTrace(this,b)}b.prototype=new Error,b.prototype.name=b.name;function m(){}m.prototype={parse:function(k,O,H){var j=this.domBuilder;j.startDocument(),L(O,O={}),N(k,O,H,j,this.errorHandler),j.endDocument()}};function N(k,O,H,j,Z){function K(Ae){if(Ae>65535){Ae-=65536;var Se=55296+(Ae>>10),De=56320+(Ae&1023);return String.fromCharCode(Se,De)}else return String.fromCharCode(Ae)}function J(Ae){var Se=Ae.slice(1,-1);return Se in H?H[Se]:Se.charAt(0)==="#"?K(parseInt(Se.substr(1).replace("x","0x"))):(Z.error("entity not found:"+Ae),Ae)}function he(Ae){if(Ae>xe){var Se=k.substring(xe,Ae).replace(/&#?\w+;/g,J);re&&Q(xe),j.characters(Se,0,Ae-xe),xe=Ae}}function Q(Ae,Se){for(;Ae>=ae&&(Se=ye.exec(k));)Y=Se.index,ae=Y+Se[0].length,re.lineNumber++;re.columnNumber=Ae-Y+1}for(var Y=0,ae=0,ye=/.*(?:\r\n?|\n)|.*$/g,re=j.locator,ce=[{currentNSMap:O}],Te={},xe=0;;){try{var Ne=k.indexOf("<",xe);if(Ne<0){if(!k.substr(xe).match(/^\s*$/)){var je=j.doc,ze=je.createTextNode(k.substr(xe));je.appendChild(ze),j.currentElement=ze}return}switch(Ne>xe&&he(Ne),k.charAt(Ne+1)){case"/":var Ie=k.indexOf(">",Ne+3),we=k.substring(Ne+2,Ie).replace(/[ \t\n\r]+$/g,""),Me=ce.pop();Ie<0?(we=k.substring(Ne+2).replace(/[\s<].*/,""),Z.error("end tag name: "+we+" is not complete:"+Me.tagName),Ie=Ne+1+we.length):we.match(/\s</)&&(we=we.replace(/[\s<].*/,""),Z.error("end tag name: "+we+" maybe not complete"),Ie=Ne+1+we.length);var oe=Me.localNSMap,ue=Me.tagName==we,me=ue||Me.tagName&&Me.tagName.toLowerCase()==we.toLowerCase();if(me){if(j.endElement(Me.uri,Me.localName,we),oe)for(var _e in oe)Object.prototype.hasOwnProperty.call(oe,_e)&&j.endPrefixMapping(_e);ue||Z.fatalError("end tag name: "+we+" is not match the current start tagName:"+Me.tagName)}else ce.push(Me);Ie++;break;case"?":re&&Q(Ne),Ie=S(k,Ne,j);break;case"!":re&&Q(Ne),Ie=y(k,Ne,j,Z);break;default:re&&Q(Ne);var Ee=new R,Re=ce[ce.length-1].currentNSMap,Ie=h(k,Ne,Ee,Re,J,Z),Oe=Ee.length;if(!Ee.closed&&E(k,Ie,Ee.tagName,Te)&&(Ee.closed=!0,H.nbsp||Z.warning("unclosed xml attribute")),re&&Oe){for(var Ve=w(re,{}),et=0;et<Oe;et++){var Ke=Ee[et];Q(Ke.offset),Ke.locator=w(re,{})}j.locator=Ve,v(Ee,j,Re)&&ce.push(Ee),j.locator=re}else v(Ee,j,Re)&&ce.push(Ee);x.isHTML(Ee.uri)&&!Ee.closed?Ie=g(k,Ie,Ee.tagName,J,j):Ie++}}catch(Ae){if(Ae instanceof b)throw Ae;Z.error("element parse error: "+Ae),Ie=-1}Ie>xe?xe=Ie:he(Math.max(Ne,xe)+1)}}function w(k,O){return O.lineNumber=k.lineNumber,O.columnNumber=k.columnNumber,O}function h(k,O,H,j,Z,K){function J(re,ce,Te){H.attributeNames.hasOwnProperty(re)&&K.fatalError("Attribute "+re+" redefined"),H.addValue(re,ce,Te)}for(var he,Q,Y=++O,ae=i;;){var ye=k.charAt(Y);switch(ye){case"=":if(ae===s)he=k.slice(O,Y),ae=a;else if(ae===n)ae=a;else throw new Error("attribute equal must after attrName");break;case"'":case'"':if(ae===a||ae===s)if(ae===s&&(K.warning('attribute value must after "="'),he=k.slice(O,Y)),O=Y+1,Y=k.indexOf(ye,O),Y>0)Q=k.slice(O,Y).replace(/&#?\w+;/g,Z),J(he,Q,O-1),ae=f;else throw new Error("attribute value no end '"+ye+"' match");else if(ae==l)Q=k.slice(O,Y).replace(/&#?\w+;/g,Z),J(he,Q,O),K.warning('attribute "'+he+'" missed start quot('+ye+")!!"),O=Y+1,ae=f;else throw new Error('attribute value must after "="');break;case"/":switch(ae){case i:H.setTagName(k.slice(O,Y));case f:case d:case c:ae=c,H.closed=!0;case l:case s:break;case n:H.closed=!0;break;default:throw new Error("attribute invalid close char('/')")}break;case"":return K.error("unexpected end of input"),ae==i&&H.setTagName(k.slice(O,Y)),Y;case">":switch(ae){case i:H.setTagName(k.slice(O,Y));case f:case d:case c:break;case l:case s:Q=k.slice(O,Y),Q.slice(-1)==="/"&&(H.closed=!0,Q=Q.slice(0,-1));case n:ae===n&&(Q=he),ae==l?(K.warning('attribute "'+Q+'" missed quot(")!'),J(he,Q.replace(/&#?\w+;/g,Z),O)):((!x.isHTML(j[""])||!Q.match(/^(?:disabled|checked|selected)$/i))&&K.warning('attribute "'+Q+'" missed value!! "'+Q+'" instead!!'),J(Q,Q,O));break;case a:throw new Error("attribute value missed!!")}return Y;case"Â€":ye=" ";default:if(ye<=" ")switch(ae){case i:H.setTagName(k.slice(O,Y)),ae=d;break;case s:he=k.slice(O,Y),ae=n;break;case l:var Q=k.slice(O,Y).replace(/&#?\w+;/g,Z);K.warning('attribute "'+Q+'" missed quot(")!!'),J(he,Q,O);case f:ae=d;break}else switch(ae){case n:H.tagName,(!x.isHTML(j[""])||!he.match(/^(?:disabled|checked|selected)$/i))&&K.warning('attribute "'+he+'" missed value!! "'+he+'" instead2!!'),J(he,he,O),O=Y,ae=s;break;case f:K.warning('attribute space is required"'+he+'"!!');case d:ae=s,O=Y;break;case a:ae=l,O=Y;break;case c:throw new Error("elements closed character '/' and '>' must be connected to")}}Y++}}function v(k,O,H){for(var j=k.tagName,Z=null,ye=k.length;ye--;){var K=k[ye],J=K.qName,he=K.value,re=J.indexOf(":");if(re>0)var Q=K.prefix=J.slice(0,re),Y=J.slice(re+1),ae=Q==="xmlns"&&Y;else Y=J,Q=null,ae=J==="xmlns"&&"";K.localName=Y,ae!==!1&&(Z==null&&(Z={},L(H,H={})),H[ae]=Z[ae]=he,K.uri=x.XMLNS,O.startPrefixMapping(ae,he))}for(var ye=k.length;ye--;){K=k[ye];var Q=K.prefix;Q&&(Q==="xml"&&(K.uri=x.XML),Q!=="xmlns"&&(K.uri=H[Q||""]))}var re=j.indexOf(":");re>0?(Q=k.prefix=j.slice(0,re),Y=k.localName=j.slice(re+1)):(Q=null,Y=k.localName=j);var ce=k.uri=H[Q||""];if(O.startElement(ce,Y,j,k),k.closed){if(O.endElement(ce,Y,j),Z)for(Q in Z)Object.prototype.hasOwnProperty.call(Z,Q)&&O.endPrefixMapping(Q)}else return k.currentNSMap=H,k.localNSMap=Z,!0}function g(k,O,H,j,Z){if(/^(?:script|textarea)$/i.test(H)){var K=k.indexOf("</"+H+">",O),J=k.substring(O+1,K);if(/[&<]/.test(J))return/^script$/i.test(H)?(Z.characters(J,0,J.length),K):(J=J.replace(/&#?\w+;/g,j),Z.characters(J,0,J.length),K)}return O+1}function E(k,O,H,j){var Z=j[H];return Z==null&&(Z=k.lastIndexOf("</"+H+">"),Z<O&&(Z=k.lastIndexOf("</"+H)),j[H]=Z),Z<O}function L(k,O){for(var H in k)Object.prototype.hasOwnProperty.call(k,H)&&(O[H]=k[H])}function y(k,O,H,j){var Z=k.charAt(O+2);switch(Z){case"-":if(k.charAt(O+3)==="-"){var K=k.indexOf("-->",O+4);return K>O?(H.comment(k,O+4,K-O-4),K+3):(j.error("Unclosed comment"),-1)}else return-1;default:if(k.substr(O+3,6)=="CDATA["){var K=k.indexOf("]]>",O+9);return H.startCDATA(),H.characters(k,O+9,K-O-9),H.endCDATA(),K+3}var J=I(k,O),he=J.length;if(he>1&&/!doctype/i.test(J[0][0])){var Q=J[1][0],Y=!1,ae=!1;he>3&&(/^public$/i.test(J[2][0])?(Y=J[3][0],ae=he>4&&J[4][0]):/^system$/i.test(J[2][0])&&(ae=J[3][0]));var ye=J[he-1];return H.startDTD(Q,Y,ae),H.endDTD(),ye.index+ye[0].length}}return-1}function S(k,O,H){var j=k.indexOf("?>",O);if(j){var Z=k.substring(O,j).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);return Z?(Z[0].length,H.processingInstruction(Z[1],Z[2]),j+2):-1}return-1}function R(){this.attributeNames={}}R.prototype={setTagName:function(k){if(!r.test(k))throw new Error("invalid tagName:"+k);this.tagName=k},addValue:function(k,O,H){if(!r.test(k))throw new Error("invalid attribute:"+k);this.attributeNames[k]=this.length,this[this.length++]={qName:k,value:O,offset:H}},length:0,getLocalName:function(k){return this[k].localName},getLocator:function(k){return this[k].locator},getQName:function(k){return this[k].qName},getURI:function(k){return this[k].uri},getValue:function(k){return this[k].value}};function I(k,O){var H,j=[],Z=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;for(Z.lastIndex=O,Z.exec(k);H=Z.exec(k);)if(j.push(H),H[1])return j}return ar.XMLReader=m,ar.ParseError=b,ar}var nn;function zs(){if(nn)return Mt;nn=1;var x=yr(),e=On(),t=Fs(),r=Ps(),i=e.DOMImplementation,s=x.NAMESPACE,n=r.ParseError,a=r.XMLReader;function l(w){this.options=w||{locator:{}}}l.prototype.parseFromString=function(w,h){var v=this.options,g=new a,E=v.domBuilder||new d,L=v.errorHandler,y=v.locator,S=v.xmlns||{},R=/\/x?html?$/.test(h),I=R?t.HTML_ENTITIES:t.XML_ENTITIES;return y&&E.setDocumentLocator(y),g.errorHandler=f(L,E,y),g.domBuilder=v.domBuilder||E,R&&(S[""]=s.HTML),S.xml=S.xml||s.XML,w&&typeof w=="string"?g.parse(w,S,I):g.errorHandler.error("invalid doc source"),E.doc};function f(w,h,v){if(!w){if(h instanceof d)return h;w=h}var g={},E=w instanceof Function;v=v||{};function L(y){var S=w[y];!S&&E&&(S=w.length==2?function(R){w(y,R)}:w),g[y]=S&&function(R){S("[xmldom "+y+"]	"+R+b(v))}||function(){}}return L("warning"),L("error"),L("fatalError"),g}function d(){this.cdata=!1}function c(w,h){h.lineNumber=w.lineNumber,h.columnNumber=w.columnNumber}d.prototype={startDocument:function(){this.doc=new i().createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(w,h,v,g){var E=this.doc,L=E.createElementNS(w,v||h),y=g.length;N(this,L),this.currentElement=L,this.locator&&c(this.locator,L);for(var S=0;S<y;S++){var w=g.getURI(S),R=g.getValue(S),v=g.getQName(S),I=E.createAttributeNS(w,v);this.locator&&c(g.getLocator(S),I),I.value=I.nodeValue=R,L.setAttributeNode(I)}},endElement:function(w,h,v){var g=this.currentElement;g.tagName,this.currentElement=g.parentNode},startPrefixMapping:function(w,h){},endPrefixMapping:function(w){},processingInstruction:function(w,h){var v=this.doc.createProcessingInstruction(w,h);this.locator&&c(this.locator,v),N(this,v)},ignorableWhitespace:function(w,h,v){},characters:function(w,h,v){if(w=m.apply(this,arguments),w){if(this.cdata)var g=this.doc.createCDATASection(w);else var g=this.doc.createTextNode(w);this.currentElement?this.currentElement.appendChild(g):/^\s*$/.test(w)&&this.doc.appendChild(g),this.locator&&c(this.locator,g)}},skippedEntity:function(w){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(w){(this.locator=w)&&(w.lineNumber=0)},comment:function(w,h,v){w=m.apply(this,arguments);var g=this.doc.createComment(w);this.locator&&c(this.locator,g),N(this,g)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(w,h,v){var g=this.doc.implementation;if(g&&g.createDocumentType){var E=g.createDocumentType(w,h,v);this.locator&&c(this.locator,E),N(this,E),this.doc.doctype=E}},warning:function(w){console.warn("[xmldom warning]	"+w,b(this.locator))},error:function(w){console.error("[xmldom error]	"+w,b(this.locator))},fatalError:function(w){throw new n(w,this.locator)}};function b(w){if(w)return`
@`+(w.systemId||"")+"#[line:"+w.lineNumber+",col:"+w.columnNumber+"]"}function m(w,h,v){return typeof w=="string"?w.substr(h,v):w.length>=h+v||h?new java.lang.String(w,h,v)+"":w}"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(w){d.prototype[w]=function(){return null}});function N(w,h){w.currentElement?w.currentElement.appendChild(h):w.doc.appendChild(h)}return Mt.__DOMHandler=d,Mt.DOMParser=l,Mt.DOMImplementation=e.DOMImplementation,Mt.XMLSerializer=e.XMLSerializer,Mt}var sn;function Ms(){if(sn)return $t;sn=1;var x=On();return $t.DOMImplementation=x.DOMImplementation,$t.XMLSerializer=x.XMLSerializer,$t.DOMParser=zs().DOMParser,$t}var Ln=Ms();const wi=typeof window<"u"?window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame:!1,Us=1,js=3,Bn=typeof URL<"u"?URL:typeof window<"u"?window.URL||window.webkitURL||window.mozURL:void 0;function wr(){var x=new Date().getTime(),e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var r=(x+Math.random()*16)%16|0;return x=Math.floor(x/16),(t=="x"?r:r&7|8).toString(16)});return e}function qs(){return Math.max(document.documentElement.clientHeight,document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight)}function Fn(x){return!!(x&&x.nodeType==1)}function $e(x){return!isNaN(parseFloat(x))&&isFinite(x)}function Pn(x){let e=parseFloat(x);return $e(x)===!1?!1:typeof x=="string"&&x.indexOf(".")>-1?!0:Math.floor(e)!==e}function qt(x){var e=["Webkit","webkit","Moz","O","ms"],t=["-webkit-","-webkit-","-moz-","-o-","-ms-"],r=x.toLowerCase(),i=e.length;if(typeof document>"u"||typeof document.body.style[r]<"u")return x;for(var s=0;s<i;s++)if(typeof document.body.style[t[s]+r]<"u")return t[s]+r;return x}function zn(x){for(var e=1,t=arguments.length;e<t;e++){var r=arguments[e];for(var i in r)x[i]===void 0&&(x[i]=r[i])}return x}function ut(x){var e=[].slice.call(arguments,1);return e.forEach(function(t){t&&Object.getOwnPropertyNames(t).forEach(function(r){Object.defineProperty(x,r,Object.getOwnPropertyDescriptor(t,r))})}),x}function Ws(x,e,t){var r=Gt(x,e,t);return e.splice(r,0,x),r}function Gt(x,e,t,r,i){var s=r||0,n=i||e.length,a=parseInt(s+(n-s)/2),l;return t||(t=function(f,d){if(f>d)return 1;if(f<d)return-1;if(f==d)return 0}),n-s<=0?a:(l=t(e[a],x),n-s===1?l>=0?a:a+1:l===0?a:l===-1?Gt(x,e,t,a,n):Gt(x,e,t,s,a))}function fr(x,e,t,r,i){var s=r||0,n=i||e.length,a=parseInt(s+(n-s)/2),l;return t||(t=function(f,d){if(f>d)return 1;if(f<d)return-1;if(f==d)return 0}),n-s<=0?-1:(l=t(e[a],x),n-s===1?l===0?a:-1:l===0?a:l===-1?fr(x,e,t,a,n):fr(x,e,t,s,a))}function lr(x){var e=window.getComputedStyle(x),t=["width","paddingRight","paddingLeft","marginRight","marginLeft","borderRightWidth","borderLeftWidth"],r=["height","paddingTop","paddingBottom","marginTop","marginBottom","borderTopWidth","borderBottomWidth"],i=0,s=0;return t.forEach(function(n){i+=parseFloat(e[n])||0}),r.forEach(function(n){s+=parseFloat(e[n])||0}),{height:s,width:i}}function cr(x){var e=window.getComputedStyle(x),t=["paddingRight","paddingLeft","marginRight","marginLeft","borderRightWidth","borderLeftWidth"],r=["paddingTop","paddingBottom","marginTop","marginBottom","borderTopWidth","borderBottomWidth"],i=0,s=0;return t.forEach(function(n){i+=parseFloat(e[n])||0}),r.forEach(function(n){s+=parseFloat(e[n])||0}),{height:s,width:i}}function pi(x){let e,t=x.ownerDocument;if(x.nodeType==Node.TEXT_NODE){let r=t.createRange();r.selectNodeContents(x),e=r.getBoundingClientRect()}else e=x.getBoundingClientRect();return e}function dr(){var x=window.innerWidth,e=window.innerHeight;return{top:0,left:0,right:x,bottom:e,width:x,height:e}}function _i(x,e){for(var t=x.parentNode,r=t.childNodes,i,s=-1,n=0;n<r.length&&(i=r[n],i.nodeType===e&&s++,i!=x);n++);return s}function Hs(x){return _i(x,js)}function Mn(x){return _i(x,Us)}function Qt(x){return["xml","opf","ncx"].indexOf(x)>-1}function Un(x,e){return new Blob([x],{type:e})}function pr(x,e){var t,r=Un(x,e);return t=Bn.createObjectURL(r),t}function jn(x){return Bn.revokeObjectURL(x)}function vi(x,e){var t,r;if(typeof x=="string")return t=btoa(x),r="data:"+e+";base64,"+t,r}function qn(x){return Object.prototype.toString.call(x).slice(8,-1)}function Ct(x,e,t){var r,i;return typeof DOMParser>"u"||t?i=Ln.DOMParser:i=DOMParser,x.charCodeAt(0)===65279&&(x=x.slice(1)),r=new i().parseFromString(x,e),r}function He(x,e){var t;if(!x)throw new Error("No Element Provided");if(typeof x.querySelector<"u")return x.querySelector(e);if(t=x.getElementsByTagName(e),t.length)return t[0]}function Nt(x,e){return typeof x.querySelector<"u"?x.querySelectorAll(e):x.getElementsByTagName(e)}function Wt(x,e,t){var r,i;if(typeof x.querySelector<"u"){e+="[";for(var s in t)e+=s+"~='"+t[s]+"'";return e+="]",x.querySelector(e)}else if(r=x.getElementsByTagName(e),i=Array.prototype.slice.call(r,0).filter(function(n){for(var a in t)if(n.getAttribute(a)===t[a])return!0;return!1}),i)return i[0]}function vr(x,e){var t=x.ownerDocument||x;typeof t.createTreeWalker<"u"?Wn(x,e,NodeFilter.SHOW_TEXT):xi(x,function(r){r&&r.nodeType===3&&e(r)})}function Wn(x,e,t){var r=document.createTreeWalker(x,t,null,!1);let i;for(;i=r.nextNode();)e(i)}function xi(x,e){if(e(x))return!0;if(x=x.firstChild,x)do{if(xi(x,e))return!0;x=x.nextSibling}while(x)}function Hn(x){return new Promise(function(e,t){var r=new FileReader;r.readAsDataURL(x),r.onloadend=function(){e(r.result)}})}function Fe(){this.resolve=null,this.reject=null,this.id=wr(),this.promise=new Promise((x,e)=>{this.resolve=x,this.reject=e}),Object.freeze(this)}function gr(x,e,t){var r;if(typeof x.querySelector<"u"&&(r=x.querySelector(`${e}[*|type="${t}"]`)),!r||r.length===0){r=Nt(x,e);for(var i=0;i<r.length;i++)if(r[i].getAttributeNS("http://www.idpf.org/2007/ops","type")===t||r[i].getAttribute("epub:type")===t)return r[i]}else return r}function gi(x){for(var e=[],t=x.childNodes,r=0;r<t.length;r++){let i=t[r];i.nodeType===1&&e.push(i)}return e}function mi(x){for(var e=[x];x;x=x.parentNode)e.unshift(x);return e}function Ht(x,e,t){for(var r=[],i=x.childNodes,s=0;s<i.length;s++){let n=i[s];if(n.nodeType===1&&n.nodeName.toLowerCase()===e){if(t)return n;r.push(n)}}if(!t)return r}function Vs(x,e){let t;if(!(x===null||e===""))for(t=x.parentNode;t.nodeType===1;){if(t.tagName.toLowerCase()===e)return t;t=t.parentNode}}class Vn{constructor(){this.collapsed=!1,this.commonAncestorContainer=void 0,this.endContainer=void 0,this.endOffset=void 0,this.startContainer=void 0,this.startOffset=void 0}setStart(e,t){this.startContainer=e,this.startOffset=t,this.endContainer?this.commonAncestorContainer=this._commonAncestorContainer():this.collapse(!0),this._checkCollapsed()}setEnd(e,t){this.endContainer=e,this.endOffset=t,this.startContainer?(this.collapsed=!1,this.commonAncestorContainer=this._commonAncestorContainer()):this.collapse(!1),this._checkCollapsed()}collapse(e){this.collapsed=!0,e?(this.endContainer=this.startContainer,this.endOffset=this.startOffset,this.commonAncestorContainer=this.startContainer.parentNode):(this.startContainer=this.endContainer,this.startOffset=this.endOffset,this.commonAncestorContainer=this.endOffset.parentNode)}selectNode(e){let t=e.parentNode,r=Array.prototype.indexOf.call(t.childNodes,e);this.setStart(t,r),this.setEnd(t,r+1)}selectNodeContents(e){e.childNodes[e.childNodes-1];let t=e.nodeType===3?e.textContent.length:parent.childNodes.length;this.setStart(e,0),this.setEnd(e,t)}_commonAncestorContainer(e,t){var r=mi(e||this.startContainer),i=mi(t||this.endContainer);if(r[0]==i[0]){for(var s=0;s<r.length;s++)if(r[s]!=i[s])return r[s-1]}}_checkCollapsed(){this.startContainer===this.endContainer&&this.startOffset===this.endOffset?this.collapsed=!0:this.collapsed=!1}toString(){}}const Gs=Object.freeze(Object.defineProperty({__proto__:null,RangeObject:Vn,blob2base64:Hn,borders:cr,bounds:lr,createBase64Url:vi,createBlob:Un,createBlobUrl:pr,defaults:zn,defer:Fe,documentHeight:qs,extend:ut,filterChildren:Ht,findChildren:gi,getParentByTagName:Vs,indexOfElementNode:Mn,indexOfNode:_i,indexOfSorted:fr,indexOfTextNode:Hs,insert:Ws,isElement:Fn,isFloat:Pn,isNumber:$e,isXml:Qt,locationOf:Gt,nodeBounds:pi,parents:mi,parse:Ct,prefixed:qt,qs:He,qsa:Nt,qsp:Wt,querySelectorByType:gr,requestAnimationFrame:wi,revokeBlobUrl:jn,sprint:vr,treeWalker:Wn,type:qn,uuid:wr,walk:xi,windowBounds:dr},Symbol.toStringTag,{value:"Module"}));var Zr,an;function Zs(){if(an)return Zr;if(an=1,!x)var x={cwd:function(){return"/"}};function e(s){if(typeof s!="string")throw new TypeError("Path must be a string. Received "+s)}function t(s,n){for(var a="",l=-1,f=0,d,c=0;c<=s.length;++c){if(c<s.length)d=s.charCodeAt(c);else{if(d===47)break;d=47}if(d===47){if(!(l===c-1||f===1))if(l!==c-1&&f===2){if(a.length<2||a.charCodeAt(a.length-1)!==46||a.charCodeAt(a.length-2)!==46){if(a.length>2){for(var b=a.length-1,m=b;m>=0&&a.charCodeAt(m)!==47;--m);if(m!==b){m===-1?a="":a=a.slice(0,m),l=c,f=0;continue}}else if(a.length===2||a.length===1){a="",l=c,f=0;continue}}n&&(a.length>0?a+="/..":a="..")}else a.length>0?a+="/"+s.slice(l+1,c):a=s.slice(l+1,c);l=c,f=0}else d===46&&f!==-1?++f:f=-1}return a}function r(s,n){var a=n.dir||n.root,l=n.base||(n.name||"")+(n.ext||"");return a?a===n.root?a+l:a+s+l:l}var i={resolve:function(){for(var n="",a=!1,l,f=arguments.length-1;f>=-1&&!a;f--){var d;f>=0?d=arguments[f]:(l===void 0&&(l=x.cwd()),d=l),e(d),d.length!==0&&(n=d+"/"+n,a=d.charCodeAt(0)===47)}return n=t(n,!a),a?n.length>0?"/"+n:"/":n.length>0?n:"."},normalize:function(n){if(e(n),n.length===0)return".";var a=n.charCodeAt(0)===47,l=n.charCodeAt(n.length-1)===47;return n=t(n,!a),n.length===0&&!a&&(n="."),n.length>0&&l&&(n+="/"),a?"/"+n:n},isAbsolute:function(n){return e(n),n.length>0&&n.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var n,a=0;a<arguments.length;++a){var l=arguments[a];e(l),l.length>0&&(n===void 0?n=l:n+="/"+l)}return n===void 0?".":i.normalize(n)},relative:function(n,a){if(e(n),e(a),n===a||(n=i.resolve(n),a=i.resolve(a),n===a))return"";for(var l=1;l<n.length&&n.charCodeAt(l)===47;++l);for(var f=n.length,d=f-l,c=1;c<a.length&&a.charCodeAt(c)===47;++c);for(var b=a.length,m=b-c,N=d<m?d:m,w=-1,h=0;h<=N;++h){if(h===N){if(m>N){if(a.charCodeAt(c+h)===47)return a.slice(c+h+1);if(h===0)return a.slice(c+h)}else d>N&&(n.charCodeAt(l+h)===47?w=h:h===0&&(w=0));break}var v=n.charCodeAt(l+h),g=a.charCodeAt(c+h);if(v!==g)break;v===47&&(w=h)}var E="";for(h=l+w+1;h<=f;++h)(h===f||n.charCodeAt(h)===47)&&(E.length===0?E+="..":E+="/..");return E.length>0?E+a.slice(c+w):(c+=w,a.charCodeAt(c)===47&&++c,a.slice(c))},_makeLong:function(n){return n},dirname:function(n){if(e(n),n.length===0)return".";for(var a=n.charCodeAt(0),l=a===47,f=-1,d=!0,c=n.length-1;c>=1;--c)if(a=n.charCodeAt(c),a===47){if(!d){f=c;break}}else d=!1;return f===-1?l?"/":".":l&&f===1?"//":n.slice(0,f)},basename:function(n,a){if(a!==void 0&&typeof a!="string")throw new TypeError('"ext" argument must be a string');e(n);var l=0,f=-1,d=!0,c;if(a!==void 0&&a.length>0&&a.length<=n.length){if(a.length===n.length&&a===n)return"";var b=a.length-1,m=-1;for(c=n.length-1;c>=0;--c){var N=n.charCodeAt(c);if(N===47){if(!d){l=c+1;break}}else m===-1&&(d=!1,m=c+1),b>=0&&(N===a.charCodeAt(b)?--b===-1&&(f=c):(b=-1,f=m))}return l===f?f=m:f===-1&&(f=n.length),n.slice(l,f)}else{for(c=n.length-1;c>=0;--c)if(n.charCodeAt(c)===47){if(!d){l=c+1;break}}else f===-1&&(d=!1,f=c+1);return f===-1?"":n.slice(l,f)}},extname:function(n){e(n);for(var a=-1,l=0,f=-1,d=!0,c=0,b=n.length-1;b>=0;--b){var m=n.charCodeAt(b);if(m===47){if(!d){l=b+1;break}continue}f===-1&&(d=!1,f=b+1),m===46?a===-1?a=b:c!==1&&(c=1):a!==-1&&(c=-1)}return a===-1||f===-1||c===0||c===1&&a===f-1&&a===l+1?"":n.slice(a,f)},format:function(n){if(n===null||typeof n!="object")throw new TypeError('Parameter "pathObject" must be an object, not '+typeof n);return r("/",n)},parse:function(n){e(n);var a={root:"",dir:"",base:"",ext:"",name:""};if(n.length===0)return a;var l=n.charCodeAt(0),f=l===47,d;f?(a.root="/",d=1):d=0;for(var c=-1,b=0,m=-1,N=!0,w=n.length-1,h=0;w>=d;--w){if(l=n.charCodeAt(w),l===47){if(!N){b=w+1;break}continue}m===-1&&(N=!1,m=w+1),l===46?c===-1?c=w:h!==1&&(h=1):c!==-1&&(h=-1)}return c===-1||m===-1||h===0||h===1&&c===m-1&&c===b+1?m!==-1&&(b===0&&f?a.base=a.name=n.slice(1,m):a.base=a.name=n.slice(b,m)):(b===0&&f?(a.name=n.slice(1,c),a.base=n.slice(1,m)):(a.name=n.slice(b,c),a.base=n.slice(b,m)),a.ext=n.slice(c,m)),b>0?a.dir=n.slice(0,b-1):f&&(a.dir="/"),a},sep:"/",delimiter:":",posix:null};return Zr=i,Zr}var Xs=Zs();const It=Zt(Xs);class Rt{constructor(e){var t,r;t=e.indexOf("://"),t>-1&&(e=new URL(e).pathname),r=this.parse(e),this.path=e,this.isDirectory(e)?this.directory=e:this.directory=r.dir+"/",this.filename=r.base,this.extension=r.ext.slice(1)}parse(e){return It.parse(e)}isAbsolute(e){return It.isAbsolute(e||this.path)}isDirectory(e){return e.charAt(e.length-1)==="/"}resolve(e){return It.resolve(this.directory,e)}relative(e){var t=e&&e.indexOf("://")>-1;return t?e:It.relative(this.directory,e)}splitPath(e){return this.splitPathRe.exec(e).slice(1)}toString(){return this.path}}class Dt{constructor(e,t){var r=e.indexOf("://")>-1,i=e,s;if(this.Url=void 0,this.href=e,this.protocol="",this.origin="",this.hash="",this.hash="",this.search="",this.base=t,!r&&t!==!1&&typeof t!="string"&&window&&window.location&&(this.base=window.location.href),r||this.base)try{this.base?this.Url=new URL(e,this.base):this.Url=new URL(e),this.href=this.Url.href,this.protocol=this.Url.protocol,this.origin=this.Url.origin,this.hash=this.Url.hash,this.search=this.Url.search,i=this.Url.pathname+(this.Url.search?this.Url.search:"")}catch{this.Url=void 0,this.base&&(s=new Rt(this.base),i=s.resolve(i))}this.Path=new Rt(i),this.directory=this.Path.directory,this.filename=this.Path.filename,this.extension=this.Path.extension}path(){return this.Path}resolve(e){var t=e.indexOf("://")>-1,r;return t?e:(r=It.resolve(this.directory,e),this.origin+r)}relative(e){return It.relative(e,this.directory)}toString(){return this.href}}const Ut=1,bt=3,Ys=9;class Pe{constructor(e,t,r){var i;if(this.str="",this.base={},this.spinePos=0,this.range=!1,this.path={},this.start=null,this.end=null,!(this instanceof Pe))return new Pe(e,t,r);if(typeof t=="string"?this.base=this.parseComponent(t):typeof t=="object"&&t.steps&&(this.base=t),i=this.checkType(e),i==="string")return this.str=e,ut(this,this.parse(e));if(i==="range")return ut(this,this.fromRange(e,this.base,r));if(i==="node")return ut(this,this.fromNode(e,this.base,r));if(i==="EpubCFI"&&e.path)return e;if(e)throw new TypeError("not a valid argument for EpubCFI");return this}checkType(e){return this.isCfiString(e)?"string":e&&typeof e=="object"&&(qn(e)==="Range"||typeof e.startContainer<"u")?"range":e&&typeof e=="object"&&typeof e.nodeType<"u"?"node":e&&typeof e=="object"&&e instanceof Pe?"EpubCFI":!1}parse(e){var t={spinePos:-1,range:!1,base:{},path:{},start:null,end:null},r,i,s;return typeof e!="string"?{spinePos:-1}:(e.indexOf("epubcfi(")===0&&e[e.length-1]===")"&&(e=e.slice(8,e.length-1)),r=this.getChapterComponent(e),r?(t.base=this.parseComponent(r),i=this.getPathComponent(e),t.path=this.parseComponent(i),s=this.getRange(e),s&&(t.range=!0,t.start=this.parseComponent(s[0]),t.end=this.parseComponent(s[1])),t.spinePos=t.base.steps[1].index,t):{spinePos:-1})}parseComponent(e){var t={steps:[],terminal:{offset:null,assertion:null}},r=e.split(":"),i=r[0].split("/"),s;return r.length>1&&(s=r[1],t.terminal=this.parseTerminal(s)),i[0]===""&&i.shift(),t.steps=i.map((function(n){return this.parseStep(n)}).bind(this)),t}parseStep(e){var t,r,i,s,n;if(s=e.match(/\[(.*)\]/),s&&s[1]&&(n=s[1]),r=parseInt(e),!isNaN(r))return r%2===0?(t="element",i=r/2-1):(t="text",i=(r-1)/2),{type:t,index:i,id:n||null}}parseTerminal(e){var t,r,i=e.match(/\[(.*)\]/);return i&&i[1]?(t=parseInt(e.split("[")[0]),r=i[1]):t=parseInt(e),$e(t)||(t=null),{offset:t,assertion:r}}getChapterComponent(e){var t=e.split("!");return t[0]}getPathComponent(e){var t=e.split("!");if(t[1])return t[1].split(",")[0]}getRange(e){var t=e.split(",");return t.length===3?[t[1],t[2]]:!1}getCharecterOffsetComponent(e){var t=e.split(":");return t[1]||""}joinSteps(e){return e?e.map(function(t){var r="";return t.type==="element"&&(r+=(t.index+1)*2),t.type==="text"&&(r+=1+2*t.index),t.id&&(r+="["+t.id+"]"),r}).join("/"):""}segmentString(e){var t="/";return t+=this.joinSteps(e.steps),e.terminal&&e.terminal.offset!=null&&(t+=":"+e.terminal.offset),e.terminal&&e.terminal.assertion!=null&&(t+="["+e.terminal.assertion+"]"),t}toString(){var e="epubcfi(";return e+=this.segmentString(this.base),e+="!",e+=this.segmentString(this.path),this.range&&this.start&&(e+=",",e+=this.segmentString(this.start)),this.range&&this.end&&(e+=",",e+=this.segmentString(this.end)),e+=")",e}compare(e,t){var r,i,s,n;if(typeof e=="string"&&(e=new Pe(e)),typeof t=="string"&&(t=new Pe(t)),e.spinePos>t.spinePos)return 1;if(e.spinePos<t.spinePos)return-1;e.range?(r=e.path.steps.concat(e.start.steps),s=e.start.terminal):(r=e.path.steps,s=e.path.terminal),t.range?(i=t.path.steps.concat(t.start.steps),n=t.start.terminal):(i=t.path.steps,n=t.path.terminal);for(var a=0;a<r.length;a++){if(!r[a])return-1;if(!i[a]||r[a].index>i[a].index)return 1;if(r[a].index<i[a].index)return-1}return r.length<i.length?-1:s.offset>n.offset?1:s.offset<n.offset?-1:0}step(e){var t=e.nodeType===bt?"text":"element";return{id:e.id,tagName:e.tagName,type:t,index:this.position(e)}}filteredStep(e,t){var r=this.filter(e,t),i;if(r)return i=r.nodeType===bt?"text":"element",{id:r.id,tagName:r.tagName,type:i,index:this.filteredPosition(r,t)}}pathTo(e,t,r){for(var i={steps:[],terminal:{offset:null,assertion:null}},s=e,n;s&&s.parentNode&&s.parentNode.nodeType!=Ys;)r?n=this.filteredStep(s,r):n=this.step(s),n&&i.steps.unshift(n),s=s.parentNode;return t!=null&&t>=0&&(i.terminal.offset=t,i.steps[i.steps.length-1].type!="text"&&i.steps.push({type:"text",index:0})),i}equalStep(e,t){return!e||!t?!1:e.index===t.index&&e.id===t.id&&e.type===t.type}fromRange(e,t,r){var i={range:!1,base:{},path:{},start:null,end:null},s=e.startContainer,n=e.endContainer,a=e.startOffset,l=e.endOffset,f=!1;if(r&&(f=s.ownerDocument.querySelector("."+r)!=null),typeof t=="string"?(i.base=this.parseComponent(t),i.spinePos=i.base.steps[1].index):typeof t=="object"&&(i.base=t),e.collapsed)f&&(a=this.patchOffset(s,a,r)),i.path=this.pathTo(s,a,r);else{i.range=!0,f&&(a=this.patchOffset(s,a,r)),i.start=this.pathTo(s,a,r),f&&(l=this.patchOffset(n,l,r)),i.end=this.pathTo(n,l,r),i.path={steps:[],terminal:null};var d=i.start.steps.length,c;for(c=0;c<d&&this.equalStep(i.start.steps[c],i.end.steps[c]);c++)c===d-1?i.start.terminal===i.end.terminal&&(i.path.steps.push(i.start.steps[c]),i.range=!1):i.path.steps.push(i.start.steps[c]);i.start.steps=i.start.steps.slice(i.path.steps.length),i.end.steps=i.end.steps.slice(i.path.steps.length)}return i}fromNode(e,t,r){var i={range:!1,base:{},path:{},start:null,end:null};return typeof t=="string"?(i.base=this.parseComponent(t),i.spinePos=i.base.steps[1].index):typeof t=="object"&&(i.base=t),i.path=this.pathTo(e,null,r),i}filter(e,t){var r,i,s,n,a,l=!1;return e.nodeType===bt?(l=!0,s=e.parentNode,r=e.parentNode.classList.contains(t)):(l=!1,r=e.classList.contains(t)),r&&l?(n=s.previousSibling,a=s.nextSibling,n&&n.nodeType===bt?i=n:a&&a.nodeType===bt&&(i=a),i||e):r&&!l?!1:e}patchOffset(e,t,r){if(e.nodeType!=bt)throw new Error("Anchor must be a text node");var i=e,s=t;for(e.parentNode.classList.contains(r)&&(i=e.parentNode);i.previousSibling;){if(i.previousSibling.nodeType===Ut)if(i.previousSibling.classList.contains(r))s+=i.previousSibling.textContent.length;else break;else s+=i.previousSibling.textContent.length;i=i.previousSibling}return s}normalizedMap(e,t,r){var i={},s=-1,n,a=e.length,l,f;for(n=0;n<a;n++)l=e[n].nodeType,l===Ut&&e[n].classList.contains(r)&&(l=bt),n>0&&l===bt&&f===bt?i[n]=s:t===l&&(s=s+1,i[n]=s),f=l;return i}position(e){var t,r;return e.nodeType===Ut?(t=e.parentNode.children,t||(t=gi(e.parentNode)),r=Array.prototype.indexOf.call(t,e)):(t=this.textNodes(e.parentNode),r=t.indexOf(e)),r}filteredPosition(e,t){var r,i,s;return e.nodeType===Ut?(r=e.parentNode.children,s=this.normalizedMap(r,Ut,t)):(r=e.parentNode.childNodes,e.parentNode.classList.contains(t)&&(e=e.parentNode,r=e.parentNode.childNodes),s=this.normalizedMap(r,bt,t)),i=Array.prototype.indexOf.call(r,e),s[i]}stepsToXpath(e){var t=[".","*"];return e.forEach(function(r){var i=r.index+1;r.id?t.push("*[position()="+i+" and @id='"+r.id+"']"):r.type==="text"?t.push("text()["+i+"]"):t.push("*["+i+"]")}),t.join("/")}stepsToQuerySelector(e){var t=["html"];return e.forEach(function(r){var i=r.index+1;r.id?t.push("#"+r.id):r.type==="text"||t.push("*:nth-child("+i+")")}),t.join(">")}textNodes(e,t){return Array.prototype.slice.call(e.childNodes).filter(function(r){return r.nodeType===bt?!0:!!(t&&r.classList.contains(t))})}walkToNode(e,t,r){var i=t||document,s=i.documentElement,n,a,l=e.length,f;for(f=0;f<l&&(a=e[f],a.type==="element"?a.id?s=i.getElementById(a.id):(n=s.children||gi(s),s=n[a.index]):a.type==="text"&&(s=this.textNodes(s,r)[a.index]),!!s);f++);return s}findNode(e,t,r){var i=t||document,s,n;return!r&&typeof i.evaluate<"u"?(n=this.stepsToXpath(e),s=i.evaluate(n,i,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue):r?s=this.walkToNode(e,i,r):s=this.walkToNode(e,i),s}fixMiss(e,t,r,i){var s=this.findNode(e.slice(0,-1),r,i),n=s.childNodes,a=this.normalizedMap(n,bt,i),l,f,d=e[e.length-1].index;for(let c in a){if(!a.hasOwnProperty(c))return;if(a[c]===d)if(l=n[c],f=l.textContent.length,t>f)t=t-f;else{l.nodeType===Ut?s=l.childNodes[0]:s=l;break}}return{container:s,offset:t}}toRange(e,t){var r=e||document,i,s,n,a,l,f=this,d,c,b=t?r.querySelector("."+t)!=null:!1,m;if(typeof r.createRange<"u"?i=r.createRange():i=new Vn,f.range?(s=f.start,d=f.path.steps.concat(s.steps),a=this.findNode(d,r,b?t:null),n=f.end,c=f.path.steps.concat(n.steps),l=this.findNode(c,r,b?t:null)):(s=f.path,d=f.path.steps,a=this.findNode(f.path.steps,r,b?t:null)),a)try{s.terminal.offset!=null?i.setStart(a,s.terminal.offset):i.setStart(a,0)}catch{m=this.fixMiss(d,s.terminal.offset,r,b?t:null),i.setStart(m.container,m.offset)}else return console.log("No startContainer found for",this.toString()),null;if(l)try{n.terminal.offset!=null?i.setEnd(l,n.terminal.offset):i.setEnd(l,0)}catch{m=this.fixMiss(c,f.end.terminal.offset,r,b?t:null),i.setEnd(m.container,m.offset)}return i}isCfiString(e){return typeof e=="string"&&e.indexOf("epubcfi(")===0&&e[e.length-1]===")"}generateChapterComponent(e,t,r){var i=parseInt(t),s=(e+1)*2,n="/"+s+"/";return n+=(i+1)*2,r&&(n+="["+r+"]"),n}collapse(e){this.range&&(this.range=!1,e?(this.path.steps=this.path.steps.concat(this.start.steps),this.path.terminal=this.start.terminal):(this.path.steps=this.path.steps.concat(this.end.steps),this.path.terminal=this.end.terminal))}}class At{constructor(e){this.context=e||this,this.hooks=[]}register(){for(var e=0;e<arguments.length;++e)if(typeof arguments[e]=="function")this.hooks.push(arguments[e]);else for(var t=0;t<arguments[e].length;++t)this.hooks.push(arguments[e][t])}deregister(e){let t;for(let r=0;r<this.hooks.length;r++)if(t=this.hooks[r],t===e){this.hooks.splice(r,1);break}}trigger(){var e=arguments,t=this.context,r=[];return this.hooks.forEach(function(i){try{var s=i.apply(t,e)}catch(n){console.log(n)}s&&typeof s.then=="function"&&r.push(s)}),Promise.all(r)}list(){return this.hooks}clear(){return this.hooks=[]}}function Gn(x,e){var t,r,i=e.url,s=i.indexOf("://")>-1;x&&(r=He(x,"head"),t=He(r,"base"),t||(t=x.createElement("base"),r.insertBefore(t,r.firstChild)),!s&&window&&window.location&&(i=window.location.origin+i),t.setAttribute("href",i))}function $s(x,e){var t,r,i=e.canonical;x&&(t=He(x,"head"),r=He(t,"link[rel='canonical']"),r?r.setAttribute("href",i):(r=x.createElement("link"),r.setAttribute("rel","canonical"),r.setAttribute("href",i),t.appendChild(r)))}function Ks(x,e){var t,r,i=e.idref;x&&(t=He(x,"head"),r=He(t,"link[property='dc.identifier']"),r?r.setAttribute("content",i):(r=x.createElement("meta"),r.setAttribute("name","dc.identifier"),r.setAttribute("content",i),t.appendChild(r)))}function Js(x,e){var t=x.querySelectorAll("a[href]");if(t.length)for(var r=He(x.ownerDocument,"base"),i=r?r.getAttribute("href"):void 0,s=(function(a){var l=a.getAttribute("href");if(l.indexOf("mailto:")!==0){var f=l.indexOf("://")>-1;if(f)a.setAttribute("target","_blank");else{var d;try{d=new Dt(l,i)}catch{}a.onclick=function(){return d&&d.hash?e(d.Path.path+d.hash):e(d?d.Path.path:l),!1}}}}).bind(this),n=0;n<t.length;n++)s(t[n])}function on(x,e,t){return e.forEach(function(r,i){r&&t[i]&&(r=r.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),x=x.replace(new RegExp(r,"g"),t[i]))}),x}function er(x,e,t,r){var i=typeof window<"u"?window.URL:!1,s=i?"blob":"arraybuffer",n=new Fe,a=new XMLHttpRequest,l=XMLHttpRequest.prototype,f;"overrideMimeType"in l||Object.defineProperty(l,"overrideMimeType",{value:function(){}}),t&&(a.withCredentials=!0),a.onreadystatechange=c,a.onerror=d,a.open("GET",x,!0);for(f in r)a.setRequestHeader(f,r[f]);e=="json"&&a.setRequestHeader("Accept","application/json"),e||(e=new Rt(x).extension),e=="blob"&&(a.responseType=s),Qt(e)&&a.overrideMimeType("text/xml"),e=="binary"&&(a.responseType="arraybuffer"),a.send();function d(b){n.reject(b)}function c(){if(this.readyState===XMLHttpRequest.DONE){var b=!1;if((this.responseType===""||this.responseType==="document")&&(b=this.responseXML),this.status===200||this.status===0||b){var m;if(!this.response&&!b)return n.reject({status:this.status,message:"Empty Response",stack:new Error().stack}),n.promise;if(this.status===403)return n.reject({status:this.status,response:this.response,message:"Forbidden",stack:new Error().stack}),n.promise;b?m=this.responseXML:Qt(e)?m=Ct(this.response,"text/xml"):e=="xhtml"?m=Ct(this.response,"application/xhtml+xml"):e=="html"||e=="htm"?m=Ct(this.response,"text/html"):e=="json"?m=JSON.parse(this.response):e=="blob"?i?m=this.response:m=new Blob([this.response]):m=this.response,n.resolve(m)}else n.reject({status:this.status,message:this.response,stack:new Error().stack})}}return n.promise}class Qs{constructor(e,t){this.idref=e.idref,this.linear=e.linear==="yes",this.properties=e.properties,this.index=e.index,this.href=e.href,this.url=e.url,this.canonical=e.canonical,this.next=e.next,this.prev=e.prev,this.cfiBase=e.cfiBase,t?this.hooks=t:(this.hooks={},this.hooks.serialize=new At(this),this.hooks.content=new At(this)),this.document=void 0,this.contents=void 0,this.output=void 0}load(e){var t=e||this.request||er,r=new Fe,i=r.promise;return this.contents?r.resolve(this.contents):t(this.url).then((function(s){return this.document=s,this.contents=s.documentElement,this.hooks.content.trigger(this.document,this)}).bind(this)).then((function(){r.resolve(this.contents)}).bind(this)).catch(function(s){r.reject(s)}),i}base(){return Gn(this.document,this)}render(e){var t=new Fe,r=t.promise;return this.output,this.load(e).then((function(i){var s=typeof navigator<"u"&&navigator.userAgent||"",n=s.indexOf("Trident")>=0,a;typeof XMLSerializer>"u"||n?a=Ln.DOMParser:a=XMLSerializer;var l=new a;return this.output=l.serializeToString(i),this.output}).bind(this)).then((function(){return this.hooks.serialize.trigger(this.output,this)}).bind(this)).then((function(){t.resolve(this.output)}).bind(this)).catch(function(i){t.reject(i)}),r}find(e){var t=this,r=[],i=e.toLowerCase(),s=function(n){for(var a=n.textContent.toLowerCase(),l=t.document.createRange(),f,d,c=-1,b,m=150;d!=-1;)d=a.indexOf(i,c+1),d!=-1&&(l=t.document.createRange(),l.setStart(n,d),l.setEnd(n,d+i.length),f=t.cfiFromRange(l),n.textContent.length<m?b=n.textContent:(b=n.textContent.substring(d-m/2,d+m/2),b="..."+b+"..."),r.push({cfi:f,excerpt:b})),c=d};return vr(t.document,function(n){s(n)}),r}search(e,t=5){if(typeof document.createTreeWalker>"u")return this.find(e);let r=[];const i=150,s=this,n=e.toLowerCase(),a=function(c){const N=c.reduce((w,h)=>w+h.textContent,"").toLowerCase().indexOf(n);if(N!=-1){const h=N+n.length;let v=0,g=0;if(N<c[0].length){let E;for(;v<c.length-1&&(g+=c[v].length,!(h<=g));)v+=1;let L=c[0],y=c[v],S=s.document.createRange();S.setStart(L,N);let R=c.slice(0,v).reduce((k,O)=>k+O.textContent.length,0);S.setEnd(y,R>h?h:h-R),E=s.cfiFromRange(S);let I=c.slice(0,v+1).reduce((k,O)=>k+O.textContent,"");I.length>i&&(I=I.substring(N-i/2,N+i/2),I="..."+I+"..."),r.push({cfi:E,excerpt:I})}}},l=document.createTreeWalker(s.document,NodeFilter.SHOW_TEXT,null,!1);let f,d=[];for(;f=l.nextNode();)d.push(f),d.length==t&&(a(d.slice(0,t)),d=d.slice(1,t));return d.length>0&&a(d),r}reconcileLayoutSettings(e){var t={layout:e.layout,spread:e.spread,orientation:e.orientation};return this.properties.forEach(function(r){var i=r.replace("rendition:",""),s=i.indexOf("-"),n,a;s!=-1&&(n=i.slice(0,s),a=i.slice(s+1),t[n]=a)}),t}cfiFromRange(e){return new Pe(e,this.cfiBase).toString()}cfiFromElement(e){return new Pe(e,this.cfiBase).toString()}unload(){this.document=void 0,this.contents=void 0,this.output=void 0}destroy(){this.unload(),this.hooks.serialize.clear(),this.hooks.content.clear(),this.hooks=void 0,this.idref=void 0,this.linear=void 0,this.properties=void 0,this.index=void 0,this.href=void 0,this.url=void 0,this.next=void 0,this.prev=void 0,this.cfiBase=void 0}}class ea{constructor(){this.spineItems=[],this.spineByHref={},this.spineById={},this.hooks={},this.hooks.serialize=new At,this.hooks.content=new At,this.hooks.content.register(Gn),this.hooks.content.register($s),this.hooks.content.register(Ks),this.epubcfi=new Pe,this.loaded=!1,this.items=void 0,this.manifest=void 0,this.spineNodeIndex=void 0,this.baseUrl=void 0,this.length=void 0}unpack(e,t,r){this.items=e.spine,this.manifest=e.manifest,this.spineNodeIndex=e.spineNodeIndex,this.baseUrl=e.baseUrl||e.basePath||"",this.length=this.items.length,this.items.forEach((i,s)=>{var n=this.manifest[i.idref],a;i.index=s,i.cfiBase=this.epubcfi.generateChapterComponent(this.spineNodeIndex,i.index,i.id),i.href&&(i.url=t(i.href,!0),i.canonical=r(i.href)),n&&(i.href=n.href,i.url=t(i.href,!0),i.canonical=r(i.href),n.properties.length&&i.properties.push.apply(i.properties,n.properties)),i.linear==="yes"?(i.prev=(function(){let l=i.index;for(;l>0;){let f=this.get(l-1);if(f&&f.linear)return f;l-=1}}).bind(this),i.next=(function(){let l=i.index;for(;l<this.spineItems.length-1;){let f=this.get(l+1);if(f&&f.linear)return f;l+=1}}).bind(this)):(i.prev=function(){},i.next=function(){}),a=new Qs(i,this.hooks),this.append(a)}),this.loaded=!0}get(e){var t=0;if(typeof e>"u")for(;t<this.spineItems.length;){let r=this.spineItems[t];if(r&&r.linear)break;t+=1}else this.epubcfi.isCfiString(e)?t=new Pe(e).spinePos:typeof e=="number"||isNaN(e)===!1?t=e:typeof e=="string"&&e.indexOf("#")===0?t=this.spineById[e.substring(1)]:typeof e=="string"&&(e=e.split("#")[0],t=this.spineByHref[e]||this.spineByHref[encodeURI(e)]);return this.spineItems[t]||null}append(e){var t=this.spineItems.length;return e.index=t,this.spineItems.push(e),this.spineByHref[decodeURI(e.href)]=t,this.spineByHref[encodeURI(e.href)]=t,this.spineByHref[e.href]=t,this.spineById[e.idref]=t,t}prepend(e){return this.spineByHref[e.href]=0,this.spineById[e.idref]=0,this.spineItems.forEach(function(t,r){t.index=r}),0}remove(e){var t=this.spineItems.indexOf(e);if(t>-1)return delete this.spineByHref[e.href],delete this.spineById[e.idref],this.spineItems.splice(t,1)}each(){return this.spineItems.forEach.apply(this.spineItems,arguments)}first(){let e=0;do{let t=this.get(e);if(t&&t.linear)return t;e+=1}while(e<this.spineItems.length)}last(){let e=this.spineItems.length-1;do{let t=this.get(e);if(t&&t.linear)return t;e-=1}while(e>=0)}destroy(){this.each(e=>e.destroy()),this.spineItems=void 0,this.spineByHref=void 0,this.spineById=void 0,this.hooks.serialize.clear(),this.hooks.content.clear(),this.hooks=void 0,this.epubcfi=void 0,this.loaded=!1,this.items=void 0,this.manifest=void 0,this.spineNodeIndex=void 0,this.baseUrl=void 0,this.length=void 0}}class Ei{constructor(e){this._q=[],this.context=e,this.tick=wi,this.running=!1,this.paused=!1}enqueue(){var e,t,r,i=[].shift.call(arguments),s=arguments;if(!i)throw new Error("No Task Provided");return typeof i=="function"?(e=new Fe,t=e.promise,r={task:i,args:s,deferred:e,promise:t}):r={promise:i},this._q.push(r),this.paused==!1&&!this.running&&this.run(),r.promise}dequeue(){var e,t,r;if(this._q.length&&!this.paused){if(e=this._q.shift(),t=e.task,t)return r=t.apply(this.context,e.args),r&&typeof r.then=="function"?r.then((function(){e.deferred.resolve.apply(this.context,arguments)}).bind(this),(function(){e.deferred.reject.apply(this.context,arguments)}).bind(this)):(e.deferred.resolve.apply(this.context,r),e.promise);if(e.promise)return e.promise}else return e=new Fe,e.deferred.resolve(),e.promise}dump(){for(;this._q.length;)this.dequeue()}run(){return this.running||(this.running=!0,this.defered=new Fe),this.tick.call(window,()=>{this._q.length?this.dequeue().then((function(){this.run()}).bind(this)):(this.defered.resolve(),this.running=void 0)}),this.paused==!0&&(this.paused=!1),this.defered.promise}flush(){if(this.running)return this.running;if(this._q.length)return this.running=this.dequeue().then((function(){return this.running=void 0,this.flush()}).bind(this)),this.running}clear(){this._q=[]}length(){return this._q.length}pause(){this.paused=!0}stop(){this._q=[],this.running=!1,this.paused=!0}}const _r="0.3",hr=["keydown","keyup","keypressed","mouseup","mousedown","mousemove","click","touchend","touchstart","touchmove"],pe={BOOK:{OPEN_FAILED:"openFailed"},CONTENTS:{EXPAND:"expand",RESIZE:"resize",SELECTED:"selected",SELECTED_RANGE:"selectedRange",LINK_CLICKED:"linkClicked"},LOCATIONS:{CHANGED:"changed"},MANAGERS:{RESIZE:"resize",RESIZED:"resized",ORIENTATION_CHANGE:"orientationchange",ADDED:"added",SCROLL:"scroll",SCROLLED:"scrolled",REMOVED:"removed"},VIEWS:{AXIS:"axis",WRITING_MODE:"writingMode",LOAD_ERROR:"loaderror",RENDERED:"rendered",RESIZED:"resized",DISPLAYED:"displayed",SHOWN:"shown",HIDDEN:"hidden",MARK_CLICKED:"markClicked"},RENDITION:{STARTED:"started",ATTACHED:"attached",DISPLAYED:"displayed",DISPLAY_ERROR:"displayerror",RENDERED:"rendered",REMOVED:"removed",RESIZED:"resized",ORIENTATION_CHANGE:"orientationchange",LOCATION_CHANGED:"locationChanged",RELOCATED:"relocated",MARK_CLICKED:"markClicked",SELECTED:"selected",LAYOUT:"layout"},LAYOUT:{UPDATED:"updated"},ANNOTATION:{ATTACH:"attach",DETACH:"detach"}};class Zn{constructor(e,t,r){this.spine=e,this.request=t,this.pause=r||100,this.q=new Ei(this),this.epubcfi=new Pe,this._locations=[],this._locationsWords=[],this.total=0,this.break=150,this._current=0,this._wordCounter=0,this.currentLocation="",this._currentCfi="",this.processingTimeout=void 0}generate(e){return e&&(this.break=e),this.q.pause(),this.spine.each((function(t){t.linear&&this.q.enqueue(this.process.bind(this),t)}).bind(this)),this.q.run().then((function(){return this.total=this._locations.length-1,this._currentCfi&&(this.currentLocation=this._currentCfi),this._locations}).bind(this))}createRange(){return{startContainer:void 0,startOffset:void 0,endContainer:void 0,endOffset:void 0}}process(e){return e.load(this.request).then((function(t){var r=new Fe,i=this.parse(t,e.cfiBase);return this._locations=this._locations.concat(i),e.unload(),this.processingTimeout=setTimeout(()=>r.resolve(i),this.pause),r.promise}).bind(this))}parse(e,t,r){var i=[],s,n=e.ownerDocument,a=He(n,"body"),l=0,f,d=r||this.break,c=function(b){var m=b.length,N,w=0;if(b.textContent.trim().length===0)return!1;for(l==0&&(s=this.createRange(),s.startContainer=b,s.startOffset=0),N=d-l,N>m&&(l+=m,w=m);w<m;)if(N=d-l,l===0&&(w+=1,s=this.createRange(),s.startContainer=b,s.startOffset=w),w+N>=m)l+=m-w,w=m;else{w+=N,s.endContainer=b,s.endOffset=w;let h=new Pe(s,t).toString();i.push(h),l=0}f=b};if(vr(a,c.bind(this)),s&&s.startContainer&&f){s.endContainer=f,s.endOffset=f.length;let b=new Pe(s,t).toString();i.push(b),l=0}return i}generateFromWords(e,t,r){var i=e?new Pe(e):void 0;return this.q.pause(),this._locationsWords=[],this._wordCounter=0,this.spine.each((function(s){s.linear&&(i?s.index>=i.spinePos&&this.q.enqueue(this.processWords.bind(this),s,t,i,r):this.q.enqueue(this.processWords.bind(this),s,t,i,r))}).bind(this)),this.q.run().then((function(){return this._currentCfi&&(this.currentLocation=this._currentCfi),this._locationsWords}).bind(this))}processWords(e,t,r,i){return i&&this._locationsWords.length>=i?Promise.resolve():e.load(this.request).then((function(s){var n=new Fe,a=this.parseWords(s,e,t,r),l=i-this._locationsWords.length;return this._locationsWords=this._locationsWords.concat(a.length>=i?a.slice(0,l):a),e.unload(),this.processingTimeout=setTimeout(()=>n.resolve(a),this.pause),n.promise}).bind(this))}countWords(e){return e=e.replace(/(^\s*)|(\s*$)/gi,""),e=e.replace(/[ ]{2,}/gi," "),e=e.replace(/\n /,`
`),e.split(" ").length}parseWords(e,t,r,i){var s=t.cfiBase,n=[],a=e.ownerDocument,l=He(a,"body"),f=r,d=i?i.spinePos!==t.index:!0,c;i&&t.index===i.spinePos&&(c=i.findNode(i.range?i.path.steps.concat(i.start.steps):i.path.steps,e.ownerDocument));var b=function(m){if(!d)if(m===c)d=!0;else return!1;if(m.textContent.length<10&&m.textContent.trim().length===0)return!1;var N=this.countWords(m.textContent),w,h=0;if(N===0)return!1;for(w=f-this._wordCounter,w>N&&(this._wordCounter+=N,h=N);h<N;)if(w=f-this._wordCounter,h+w>=N)this._wordCounter+=N-h,h=N;else{h+=w;let v=new Pe(m,s);n.push({cfi:v.toString(),wordCount:this._wordCounter}),this._wordCounter=0}};return vr(l,b.bind(this)),n}locationFromCfi(e){let t;return Pe.prototype.isCfiString(e)&&(e=new Pe(e)),this._locations.length===0?-1:(t=Gt(e,this._locations,this.epubcfi.compare),t>this.total?this.total:t)}percentageFromCfi(e){if(this._locations.length===0)return null;var t=this.locationFromCfi(e);return this.percentageFromLocation(t)}percentageFromLocation(e){return!e||!this.total?0:e/this.total}cfiFromLocation(e){var t=-1;return typeof e!="number"&&(e=parseInt(e)),e>=0&&e<this._locations.length&&(t=this._locations[e]),t}cfiFromPercentage(e){let t;if(e>1&&console.warn("Normalize cfiFromPercentage value to between 0 - 1"),e>=1){let r=new Pe(this._locations[this.total]);return r.collapse(),r.toString()}return t=Math.ceil(this.total*e),this.cfiFromLocation(t)}load(e){return typeof e=="string"?this._locations=JSON.parse(e):this._locations=e,this.total=this._locations.length-1,this._locations}save(){return JSON.stringify(this._locations)}getCurrent(){return this._current}setCurrent(e){var t;if(typeof e=="string")this._currentCfi=e;else if(typeof e=="number")this._current=e;else return;this._locations.length!==0&&(typeof e=="string"?(t=this.locationFromCfi(e),this._current=t):t=e,this.emit(pe.LOCATIONS.CHANGED,{percentage:this.percentageFromLocation(t)}))}get currentLocation(){return this._current}set currentLocation(e){this.setCurrent(e)}length(){return this._locations.length}destroy(){this.spine=void 0,this.request=void 0,this.pause=void 0,this.q.stop(),this.q=void 0,this.epubcfi=void 0,this._locations=void 0,this.total=void 0,this.break=void 0,this._current=void 0,this.currentLocation=void 0,this._currentCfi=void 0,clearTimeout(this.processingTimeout)}}St(Zn.prototype);class ta{constructor(e){this.packagePath="",this.directory="",this.encoding="",e&&this.parse(e)}parse(e){var t;if(!e)throw new Error("Container File Not Found");if(t=He(e,"rootfile"),!t)throw new Error("No RootFile Found");this.packagePath=t.getAttribute("full-path"),this.directory=It.dirname(this.packagePath),this.encoding=e.xmlEncoding}destroy(){this.packagePath=void 0,this.directory=void 0,this.encoding=void 0}}class un{constructor(e){this.manifest={},this.navPath="",this.ncxPath="",this.coverPath="",this.spineNodeIndex=0,this.spine=[],this.metadata={},e&&this.parse(e)}parse(e){var t,r,i;if(!e)throw new Error("Package File Not Found");if(t=He(e,"metadata"),!t)throw new Error("No Metadata Found");if(r=He(e,"manifest"),!r)throw new Error("No Manifest Found");if(i=He(e,"spine"),!i)throw new Error("No Spine Found");return this.manifest=this.parseManifest(r),this.navPath=this.findNavPath(r),this.ncxPath=this.findNcxPath(r,i),this.coverPath=this.findCoverPath(e),this.spineNodeIndex=Mn(i),this.spine=this.parseSpine(i,this.manifest),this.uniqueIdentifier=this.findUniqueIdentifier(e),this.metadata=this.parseMetadata(t),this.metadata.direction=i.getAttribute("page-progression-direction"),{metadata:this.metadata,spine:this.spine,manifest:this.manifest,navPath:this.navPath,ncxPath:this.ncxPath,coverPath:this.coverPath,spineNodeIndex:this.spineNodeIndex}}parseMetadata(e){var t={};return t.title=this.getElementText(e,"title"),t.creator=this.getElementText(e,"creator"),t.description=this.getElementText(e,"description"),t.pubdate=this.getElementText(e,"date"),t.publisher=this.getElementText(e,"publisher"),t.identifier=this.getElementText(e,"identifier"),t.language=this.getElementText(e,"language"),t.rights=this.getElementText(e,"rights"),t.modified_date=this.getPropertyText(e,"dcterms:modified"),t.layout=this.getPropertyText(e,"rendition:layout"),t.orientation=this.getPropertyText(e,"rendition:orientation"),t.flow=this.getPropertyText(e,"rendition:flow"),t.viewport=this.getPropertyText(e,"rendition:viewport"),t.media_active_class=this.getPropertyText(e,"media:active-class"),t.spread=this.getPropertyText(e,"rendition:spread"),t}parseManifest(e){var t={},r=Nt(e,"item"),i=Array.prototype.slice.call(r);return i.forEach(function(s){var n=s.getAttribute("id"),a=s.getAttribute("href")||"",l=s.getAttribute("media-type")||"",f=s.getAttribute("media-overlay")||"",d=s.getAttribute("properties")||"";t[n]={href:a,type:l,overlay:f,properties:d.length?d.split(" "):[]}}),t}parseSpine(e,t){var r=[],i=Nt(e,"itemref"),s=Array.prototype.slice.call(i);return s.forEach(function(n,a){var l=n.getAttribute("idref"),f=n.getAttribute("properties")||"",d=f.length?f.split(" "):[],c={id:n.getAttribute("id"),idref:l,linear:n.getAttribute("linear")||"yes",properties:d,index:a};r.push(c)}),r}findUniqueIdentifier(e){var t=e.documentElement.getAttribute("unique-identifier");if(!t)return"";var r=e.getElementById(t);return r&&r.localName==="identifier"&&r.namespaceURI==="http://purl.org/dc/elements/1.1/"&&r.childNodes.length>0?r.childNodes[0].nodeValue.trim():""}findNavPath(e){var t=Wt(e,"item",{properties:"nav"});return t?t.getAttribute("href"):!1}findNcxPath(e,t){var r=Wt(e,"item",{"media-type":"application/x-dtbncx+xml"}),i;return r||(i=t.getAttribute("toc"),i&&(r=e.querySelector(`#${i}`))),r?r.getAttribute("href"):!1}findCoverPath(e){var t=He(e,"package");t.getAttribute("version");var r=Wt(e,"item",{properties:"cover-image"});if(r)return r.getAttribute("href");var i=Wt(e,"meta",{name:"cover"});if(i){var s=i.getAttribute("content"),n=e.getElementById(s);return n?n.getAttribute("href"):""}else return!1}getElementText(e,t){var r=e.getElementsByTagNameNS("http://purl.org/dc/elements/1.1/",t),i;return!r||r.length===0?"":(i=r[0],i.childNodes.length?i.childNodes[0].nodeValue:"")}getPropertyText(e,t){var r=Wt(e,"meta",{property:t});return r&&r.childNodes.length?r.childNodes[0].nodeValue:""}load(e){this.metadata=e.metadata;let t=e.readingOrder||e.spine;return this.spine=t.map((r,i)=>(r.index=i,r.linear=r.linear||"yes",r)),e.resources.forEach((r,i)=>{this.manifest[i]=r,r.rel&&r.rel[0]==="cover"&&(this.coverPath=r.href)}),this.spineNodeIndex=0,this.toc=e.toc.map((r,i)=>(r.label=r.title,r)),{metadata:this.metadata,spine:this.spine,manifest:this.manifest,navPath:this.navPath,ncxPath:this.ncxPath,coverPath:this.coverPath,spineNodeIndex:this.spineNodeIndex,toc:this.toc}}destroy(){this.manifest=void 0,this.navPath=void 0,this.ncxPath=void 0,this.coverPath=void 0,this.spineNodeIndex=void 0,this.spine=void 0,this.metadata=void 0}}class Xr{constructor(e){this.toc=[],this.tocByHref={},this.tocById={},this.landmarks=[],this.landmarksByType={},this.length=0,e&&this.parse(e)}parse(e){let t=e.nodeType,r,i;t&&(r=He(e,"html"),i=He(e,"ncx")),t?r?(this.toc=this.parseNav(e),this.landmarks=this.parseLandmarks(e)):i&&(this.toc=this.parseNcx(e)):this.toc=this.load(e),this.length=0,this.unpack(this.toc)}unpack(e){for(var t,r=0;r<e.length;r++)t=e[r],t.href&&(this.tocByHref[t.href]=r),t.id&&(this.tocById[t.id]=r),this.length++,t.subitems.length&&this.unpack(t.subitems)}get(e){var t;return e?(e.indexOf("#")===0?t=this.tocById[e.substring(1)]:e in this.tocByHref&&(t=this.tocByHref[e]),this.getByIndex(e,t,this.toc)):this.toc}getByIndex(e,t,r){if(r.length===0)return;const i=r[t];if(i&&(e===i.id||e===i.href))return i;{let s;for(let n=0;n<r.length&&(s=this.getByIndex(e,t,r[n].subitems),!s);++n);return s}}landmark(e){var t;return e?(t=this.landmarksByType[e],this.landmarks[t]):this.landmarks}parseNav(e){var t=gr(e,"nav","toc"),r=[];if(!t)return r;let i=Ht(t,"ol",!0);return i&&(r=this.parseNavList(i)),r}parseNavList(e,t){const r=[];if(!e||!e.children)return r;for(let i=0;i<e.children.length;i++){const s=this.navItem(e.children[i],t);s&&r.push(s)}return r}navItem(e,t){let r=e.getAttribute("id")||void 0,i=Ht(e,"a",!0)||Ht(e,"span",!0);if(!i)return;let s=i.getAttribute("href")||"";r||(r=s);let n=i.textContent||"",a=[],l=Ht(e,"ol",!0);return l&&(a=this.parseNavList(l,r)),{id:r,href:s,label:n,subitems:a,parent:t}}parseLandmarks(e){var t=gr(e,"nav","landmarks"),r=t?Nt(t,"li"):[],i=r.length,s,n=[],a;if(!r||i===0)return n;for(s=0;s<i;++s)a=this.landmarkItem(r[s]),a&&(n.push(a),this.landmarksByType[a.type]=s);return n}landmarkItem(e){let t=Ht(e,"a",!0);if(!t)return;let r=t.getAttributeNS("http://www.idpf.org/2007/ops","type")||void 0,i=t.getAttribute("href")||"",s=t.textContent||"";return{href:i,label:s,type:r}}parseNcx(e){var t=Nt(e,"navPoint"),r=t.length,i,s={},n=[],a,l;if(!t||r===0)return n;for(i=0;i<r;++i)a=this.ncxItem(t[i]),s[a.id]=a,a.parent?(l=s[a.parent],l.subitems.push(a)):n.push(a);return n}ncxItem(e){var t=e.getAttribute("id")||!1,r=He(e,"content"),i=r.getAttribute("src"),s=He(e,"navLabel"),n=s.textContent?s.textContent:"",a=[],l=e.parentNode,f;return l&&(l.nodeName==="navPoint"||l.nodeName.split(":").slice(-1)[0]==="navPoint")&&(f=l.getAttribute("id")),{id:t,href:i,label:n,subitems:a,parent:f}}load(e){return e.map(t=>(t.label=t.title,t.subitems=t.children?this.load(t.children):[],t))}forEach(e){return this.toc.forEach(e)}}var Kt={application:{ecmascript:["es","ecma"],javascript:"js",ogg:"ogx",pdf:"pdf",postscript:["ps","ai","eps","epsi","epsf","eps2","eps3"],"rdf+xml":"rdf",smil:["smi","smil"],"xhtml+xml":["xhtml","xht"],xml:["xml","xsl","xsd","opf","ncx"],zip:"zip","x-httpd-eruby":"rhtml","x-latex":"latex","x-maker":["frm","maker","frame","fm","fb","book","fbdoc"],"x-object":"o","x-shockwave-flash":["swf","swfl"],"x-silverlight":"scr","epub+zip":"epub","font-tdpfr":"pfr","inkml+xml":["ink","inkml"],json:"json","jsonml+json":"jsonml","mathml+xml":"mathml","metalink+xml":"metalink",mp4:"mp4s","omdoc+xml":"omdoc",oxps:"oxps","vnd.amazon.ebook":"azw",widget:"wgt","x-dtbook+xml":"dtb","x-dtbresource+xml":"res","x-font-bdf":"bdf","x-font-ghostscript":"gsf","x-font-linux-psf":"psf","x-font-otf":"otf","x-font-pcf":"pcf","x-font-snf":"snf","x-font-ttf":["ttf","ttc"],"x-font-type1":["pfa","pfb","pfm","afm"],"x-font-woff":"woff","x-mobipocket-ebook":["prc","mobi"],"x-mspublisher":"pub","x-nzb":"nzb","x-tgif":"obj","xaml+xml":"xaml","xml-dtd":"dtd","xproc+xml":"xpl","xslt+xml":"xslt","internet-property-stream":"acx","x-compress":"z","x-compressed":"tgz","x-gzip":"gz"},audio:{flac:"flac",midi:["mid","midi","kar","rmi"],mpeg:["mpga","mpega","mp2","mp3","m4a","mp2a","m2a","m3a"],mpegurl:"m3u",ogg:["oga","ogg","spx"],"x-aiff":["aif","aiff","aifc"],"x-ms-wma":"wma","x-wav":"wav",adpcm:"adp",mp4:"mp4a",webm:"weba","x-aac":"aac","x-caf":"caf","x-matroska":"mka","x-pn-realaudio-plugin":"rmp",xm:"xm",mid:["mid","rmi"]},image:{gif:"gif",ief:"ief",jpeg:["jpeg","jpg","jpe"],pcx:"pcx",png:"png","svg+xml":["svg","svgz"],tiff:["tiff","tif"],"x-icon":"ico",bmp:"bmp",webp:"webp","x-pict":["pic","pct"],"x-tga":"tga","cis-cod":"cod"},text:{"cache-manifest":["manifest","appcache"],css:"css",csv:"csv",html:["html","htm","shtml","stm"],mathml:"mml",plain:["txt","text","brf","conf","def","list","log","in","bas"],richtext:"rtx","tab-separated-values":"tsv","x-bibtex":"bib"},video:{mpeg:["mpeg","mpg","mpe","m1v","m2v","mp2","mpa","mpv2"],mp4:["mp4","mp4v","mpg4"],quicktime:["qt","mov"],ogg:"ogv","vnd.mpegurl":["mxu","m4u"],"x-flv":"flv","x-la-asf":["lsf","lsx"],"x-mng":"mng","x-ms-asf":["asf","asx","asr"],"x-ms-wm":"wm","x-ms-wmv":"wmv","x-ms-wmx":"wmx","x-ms-wvx":"wvx","x-msvideo":"avi","x-sgi-movie":"movie","x-matroska":["mpv","mkv","mk3d","mks"],"3gpp2":"3g2",h261:"h261",h263:"h263",h264:"h264",jpeg:"jpgv",jpm:["jpm","jpgm"],mj2:["mj2","mjp2"],"vnd.ms-playready.media.pyv":"pyv","vnd.uvvu.mp4":["uvu","uvvu"],"vnd.vivo":"viv",webm:"webm","x-f4v":"f4v","x-m4v":"m4v","x-ms-vob":"vob","x-smv":"smv"}},ra=(function(){var x,e,t,r,i={};for(x in Kt)if(Kt.hasOwnProperty(x)){for(e in Kt[x])if(Kt[x].hasOwnProperty(e))if(t=Kt[x][e],typeof t=="string")i[t]=x+"/"+e;else for(r=0;r<t.length;r++)i[t[r]]=x+"/"+e}return i})(),ia="text/plain";function na(x){return x&&ra[x.split(".").pop().toLowerCase()]||ia}const Vt={lookup:na};class sa{constructor(e,t){this.settings={replacements:t&&t.replacements||"base64",archive:t&&t.archive,resolver:t&&t.resolver,request:t&&t.request},this.process(e)}process(e){this.manifest=e,this.resources=Object.keys(e).map(function(t){return e[t]}),this.replacementUrls=[],this.html=[],this.assets=[],this.css=[],this.urls=[],this.cssUrls=[],this.split(),this.splitUrls()}split(){this.html=this.resources.filter(function(e){if(e.type==="application/xhtml+xml"||e.type==="text/html")return!0}),this.assets=this.resources.filter(function(e){if(e.type!=="application/xhtml+xml"&&e.type!=="text/html")return!0}),this.css=this.resources.filter(function(e){if(e.type==="text/css")return!0})}splitUrls(){this.urls=this.assets.map((function(e){return e.href}).bind(this)),this.cssUrls=this.css.map(function(e){return e.href})}createUrl(e){var t=new Dt(e),r=Vt.lookup(t.filename);return this.settings.archive?this.settings.archive.createUrl(e,{base64:this.settings.replacements==="base64"}):this.settings.replacements==="base64"?this.settings.request(e,"blob").then(i=>Hn(i)).then(i=>vi(i,r)):this.settings.request(e,"blob").then(i=>pr(i,r))}replacements(){if(this.settings.replacements==="none")return new Promise((function(t){t(this.urls)}).bind(this));var e=this.urls.map(t=>{var r=this.settings.resolver(t);return this.createUrl(r).catch(i=>(console.error(i),null))});return Promise.all(e).then(t=>(this.replacementUrls=t.filter(r=>typeof r=="string"),t))}replaceCss(e,t){var r=[];return e=e||this.settings.archive,t=t||this.settings.resolver,this.cssUrls.forEach((function(i){var s=this.createCssFile(i,e,t).then((function(n){var a=this.urls.indexOf(i);a>-1&&(this.replacementUrls[a]=n)}).bind(this));r.push(s)}).bind(this)),Promise.all(r)}createCssFile(e){var t;if(It.isAbsolute(e))return new Promise(function(n){n()});var r=this.settings.resolver(e),i;this.settings.archive?i=this.settings.archive.getText(r):i=this.settings.request(r,"text");var s=this.urls.map(n=>{var a=this.settings.resolver(n),l=new Rt(r).relative(a);return l});return i?i.then(n=>(n=on(n,s,this.replacementUrls),this.settings.replacements==="base64"?t=vi(n,"text/css"):t=pr(n,"text/css"),t),n=>new Promise(function(a){a()})):new Promise(function(n){n()})}relativeTo(e,t){return t=t||this.settings.resolver,this.urls.map((function(r){var i=t(r),s=new Rt(e).relative(i);return s}).bind(this))}get(e){var t=this.urls.indexOf(e);if(t!==-1)return this.replacementUrls.length?new Promise((function(r,i){r(this.replacementUrls[t])}).bind(this)):this.createUrl(e)}substitute(e,t){var r;return t?r=this.relativeTo(t):r=this.urls,on(e,r,this.replacementUrls)}destroy(){this.settings=void 0,this.manifest=void 0,this.resources=void 0,this.replacementUrls=void 0,this.html=void 0,this.assets=void 0,this.css=void 0,this.urls=void 0,this.cssUrls=void 0}}class Yr{constructor(e){this.pages=[],this.locations=[],this.epubcfi=new Pe,this.firstPage=0,this.lastPage=0,this.totalPages=0,this.toc=void 0,this.ncx=void 0,e&&(this.pageList=this.parse(e)),this.pageList&&this.pageList.length&&this.process(this.pageList)}parse(e){var t=He(e,"html"),r=He(e,"ncx");if(t)return this.parseNav(e);if(r)return this.parseNcx(e)}parseNav(e){var t=gr(e,"nav","page-list"),r=t?Nt(t,"li"):[],i=r.length,s,n=[],a;if(!r||i===0)return n;for(s=0;s<i;++s)a=this.item(r[s]),n.push(a);return n}parseNcx(e){var t=[],r=0,i,s,n,a=0;if(s=He(e,"pageList"),!s||(n=Nt(s,"pageTarget"),a=n.length,!n||n.length===0))return t;for(r=0;r<a;++r)i=this.ncxItem(n[r]),t.push(i);return t}ncxItem(e){var t=He(e,"navLabel"),r=He(t,"text"),i=r.textContent,s=He(e,"content"),n=s.getAttribute("src"),a=parseInt(i,10);return{href:n,page:a}}item(e){var t=He(e,"a"),r=t.getAttribute("href")||"",i=t.textContent||"",s=parseInt(i),n=r.indexOf("epubcfi"),a,l,f;return n!=-1?(a=r.split("#"),l=a[0],f=a.length>1?a[1]:!1,{cfi:f,href:r,packageUrl:l,page:s}):{href:r,page:s}}process(e){e.forEach(function(t){this.pages.push(t.page),t.cfi&&this.locations.push(t.cfi)},this),this.firstPage=parseInt(this.pages[0]),this.lastPage=parseInt(this.pages[this.pages.length-1]),this.totalPages=this.lastPage-this.firstPage}pageFromCfi(e){var t=-1;if(this.locations.length===0)return-1;var r=fr(e,this.locations,this.epubcfi.compare);return r!=-1?t=this.pages[r]:(r=Gt(e,this.locations,this.epubcfi.compare),t=r-1>=0?this.pages[r-1]:this.pages[0],t!==void 0||(t=-1)),t}cfiFromPage(e){var t=-1;typeof e!="number"&&(e=parseInt(e));var r=this.pages.indexOf(e);return r!=-1&&(t=this.locations[r]),t}pageFromPercentage(e){var t=Math.round(this.totalPages*e);return t}percentageFromPage(e){var t=(e-this.firstPage)/this.totalPages;return Math.round(t*1e3)/1e3}percentageFromCfi(e){var t=this.pageFromCfi(e),r=this.percentageFromPage(t);return r}destroy(){this.pages=void 0,this.locations=void 0,this.epubcfi=void 0,this.pageList=void 0,this.toc=void 0,this.ncx=void 0}}class Xn{constructor(e){this.settings=e,this.name=e.layout||"reflowable",this._spread=e.spread!=="none",this._minSpreadWidth=e.minSpreadWidth||800,this._evenSpreads=e.evenSpreads||!1,e.flow==="scrolled"||e.flow==="scrolled-continuous"||e.flow==="scrolled-doc"?this._flow="scrolled":this._flow="paginated",this.width=0,this.height=0,this.spreadWidth=0,this.delta=0,this.columnWidth=0,this.gap=0,this.divisor=1,this.props={name:this.name,spread:this._spread,flow:this._flow,width:0,height:0,spreadWidth:0,delta:0,columnWidth:0,gap:0,divisor:1}}flow(e){return typeof e<"u"&&(e==="scrolled"||e==="scrolled-continuous"||e==="scrolled-doc"?this._flow="scrolled":this._flow="paginated",this.update({flow:this._flow})),this._flow}spread(e,t){return e&&(this._spread=e!=="none",this.update({spread:this._spread})),t>=0&&(this._minSpreadWidth=t),this._spread}calculate(e,t,r){var i=1,s=r||0,n=e,a=t,l=Math.floor(n/12),f,d,c,b;this._spread&&n>=this._minSpreadWidth?i=2:i=1,this.name==="reflowable"&&this._flow==="paginated"&&!(r>=0)&&(s=l%2===0?l:l-1),this.name==="pre-paginated"&&(s=0),i>1?(f=n/i-s,c=f+s):(f=n,c=n),this.name==="pre-paginated"&&i>1&&(n=f),d=f*i+s,b=n,this.width=n,this.height=a,this.spreadWidth=d,this.pageWidth=c,this.delta=b,this.columnWidth=f,this.gap=s,this.divisor=i,this.update({width:n,height:a,spreadWidth:d,pageWidth:c,delta:b,columnWidth:f,gap:s,divisor:i})}format(e,t,r){var i;return this.name==="pre-paginated"?i=e.fit(this.columnWidth,this.height,t):this._flow==="paginated"?i=e.columns(this.width,this.height,this.columnWidth,this.gap,this.settings.direction):r&&r==="horizontal"?i=e.size(null,this.height):i=e.size(this.width,null),i}count(e,t){let r,i;return this.name==="pre-paginated"?(r=1,i=1):this._flow==="paginated"?(t=t||this.delta,r=Math.ceil(e/t),i=r*this.divisor):(t=t||this.height,r=Math.ceil(e/t),i=r),{spreads:r,pages:i}}update(e){if(Object.keys(e).forEach(t=>{this.props[t]===e[t]&&delete e[t]}),Object.keys(e).length>0){let t=ut(this.props,e);this.emit(pe.LAYOUT.UPDATED,t,e)}}}St(Xn.prototype);class aa{constructor(e){this.rendition=e,this._themes={default:{rules:{},url:"",serialized:""}},this._overrides={},this._current="default",this._injected=[],this.rendition.hooks.content.register(this.inject.bind(this)),this.rendition.hooks.content.register(this.overrides.bind(this))}register(){if(arguments.length!==0){if(arguments.length===1&&typeof arguments[0]=="object")return this.registerThemes(arguments[0]);if(arguments.length===1&&typeof arguments[0]=="string")return this.default(arguments[0]);if(arguments.length===2&&typeof arguments[1]=="string")return this.registerUrl(arguments[0],arguments[1]);if(arguments.length===2&&typeof arguments[1]=="object")return this.registerRules(arguments[0],arguments[1])}}default(e){if(e){if(typeof e=="string")return this.registerUrl("default",e);if(typeof e=="object")return this.registerRules("default",e)}}registerThemes(e){for(var t in e)e.hasOwnProperty(t)&&(typeof e[t]=="string"?this.registerUrl(t,e[t]):this.registerRules(t,e[t]))}registerCss(e,t){this._themes[e]={serialized:t},(this._injected[e]||e=="default")&&this.update(e)}registerUrl(e,t){var r=new Dt(t);this._themes[e]={url:r.toString()},(this._injected[e]||e=="default")&&this.update(e)}registerRules(e,t){this._themes[e]={rules:t},(this._injected[e]||e=="default")&&this.update(e)}select(e){var t=this._current,r;this._current=e,this.update(e),r=this.rendition.getContents(),r.forEach(i=>{i.removeClass(t),i.addClass(e)})}update(e){var t=this.rendition.getContents();t.forEach(r=>{this.add(e,r)})}inject(e){var t=[],r=this._themes,i;for(var s in r)r.hasOwnProperty(s)&&(s===this._current||s==="default")&&(i=r[s],(i.rules&&Object.keys(i.rules).length>0||i.url&&t.indexOf(i.url)===-1)&&this.add(s,e),this._injected.push(s));this._current!="default"&&e.addClass(this._current)}add(e,t){var r=this._themes[e];!r||!t||(r.url?t.addStylesheet(r.url):r.serialized?(t.addStylesheetCss(r.serialized,e),r.injected=!0):r.rules&&(t.addStylesheetRules(r.rules,e),r.injected=!0))}override(e,t,r){var i=this.rendition.getContents();this._overrides[e]={value:t,priority:r===!0},i.forEach(s=>{s.css(e,this._overrides[e].value,this._overrides[e].priority)})}removeOverride(e){var t=this.rendition.getContents();delete this._overrides[e],t.forEach(r=>{r.css(e)})}overrides(e){var t=this._overrides;for(var r in t)t.hasOwnProperty(r)&&e.css(r,t[r].value,t[r].priority)}fontSize(e){this.override("font-size",e)}font(e){this.override("font-family",e,!0)}destroy(){this.rendition=void 0,this._themes=void 0,this._overrides=void 0,this._current=void 0,this._injected=void 0}}class mr{constructor(e,t,r,i=!1){this.layout=e,this.horizontal=r==="horizontal",this.direction=t||"ltr",this._dev=i}section(e){var t=this.findRanges(e),r=this.rangeListToCfiList(e.section.cfiBase,t);return r}page(e,t,r,i){var s=e&&e.document?e.document.body:!1,n;if(s){if(n=this.rangePairToCfiPair(t,{start:this.findStart(s,r,i),end:this.findEnd(s,r,i)}),this._dev===!0){let a=e.document,l=new Pe(n.start).toRange(a),f=new Pe(n.end).toRange(a),d=a.defaultView.getSelection(),c=a.createRange();d.removeAllRanges(),c.setStart(l.startContainer,l.startOffset),c.setEnd(f.endContainer,f.endOffset),d.addRange(c)}return n}}walk(e,t){if(!(e&&e.nodeType===Node.TEXT_NODE)){var r={acceptNode:function(l){return l.data.trim().length>0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT}},i=r.acceptNode;i.acceptNode=r.acceptNode;for(var s=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,i,!1),n,a;(n=s.nextNode())&&(a=t(n),!a););return a}}findRanges(e){for(var t=[],r=e.contents.scrollWidth(),i=Math.ceil(r/this.layout.spreadWidth),s=i*this.layout.divisor,n=this.layout.columnWidth,a=this.layout.gap,l,f,d=0;d<s.pages;d++)l=(n+a)*d,f=n*(d+1)+a*d,t.push({start:this.findStart(e.document.body,l,f),end:this.findEnd(e.document.body,l,f)});return t}findStart(e,t,r){for(var i=[e],s,n,a=e;i.length;)if(s=i.shift(),n=this.walk(s,l=>{var f,d,c,b,m;if(m=pi(l),this.horizontal&&this.direction==="ltr"){if(f=this.horizontal?m.left:m.top,d=this.horizontal?m.right:m.bottom,f>=t&&f<=r)return l;if(d>t)return l;a=l,i.push(l)}else if(this.horizontal&&this.direction==="rtl"){if(f=m.left,d=m.right,d<=r&&d>=t)return l;if(f<r)return l;a=l,i.push(l)}else{if(c=m.top,b=m.bottom,c>=t&&c<=r)return l;if(b>t)return l;a=l,i.push(l)}}),n)return this.findTextStartRange(n,t,r);return this.findTextStartRange(a,t,r)}findEnd(e,t,r){for(var i=[e],s,n=e,a;i.length;)if(s=i.shift(),a=this.walk(s,l=>{var f,d,c,b,m;if(m=pi(l),this.horizontal&&this.direction==="ltr"){if(f=Math.round(m.left),d=Math.round(m.right),f>r&&n)return n;if(d>r)return l;n=l,i.push(l)}else if(this.horizontal&&this.direction==="rtl"){if(f=Math.round(this.horizontal?m.left:m.top),d=Math.round(this.horizontal?m.right:m.bottom),d<t&&n)return n;if(f<t)return l;n=l,i.push(l)}else{if(c=Math.round(m.top),b=Math.round(m.bottom),c>r&&n)return n;if(b>r)return l;n=l,i.push(l)}}),a)return this.findTextEndRange(a,t,r);return this.findTextEndRange(n,t,r)}findTextStartRange(e,t,r){for(var i=this.splitTextNodeIntoRanges(e),s,n,a,l,f,d=0;d<i.length;d++)if(s=i[d],n=s.getBoundingClientRect(),this.horizontal&&this.direction==="ltr"){if(a=n.left,a>=t)return s}else if(this.horizontal&&this.direction==="rtl"){if(f=n.right,f<=r)return s}else if(l=n.top,l>=t)return s;return i[0]}findTextEndRange(e,t,r){for(var i=this.splitTextNodeIntoRanges(e),s,n,a,l,f,d,c,b=0;b<i.length;b++){if(n=i[b],a=n.getBoundingClientRect(),this.horizontal&&this.direction==="ltr"){if(l=a.left,f=a.right,l>r&&s)return s;if(f>r)return n}else if(this.horizontal&&this.direction==="rtl"){if(l=a.left,f=a.right,f<t&&s)return s;if(l<t)return n}else{if(d=a.top,c=a.bottom,d>r&&s)return s;if(c>r)return n}s=n}return i[i.length-1]}splitTextNodeIntoRanges(e,t){var r=[],i=e.textContent||"",s=i.trim(),n,a=e.ownerDocument,l=t||" ",f=s.indexOf(l);if(f===-1||e.nodeType!=Node.TEXT_NODE)return n=a.createRange(),n.selectNodeContents(e),[n];for(n=a.createRange(),n.setStart(e,0),n.setEnd(e,f),r.push(n),n=!1;f!=-1;)f=s.indexOf(l,f+1),f>0&&(n&&(n.setEnd(e,f),r.push(n)),n=a.createRange(),n.setStart(e,f+1));return n&&(n.setEnd(e,s.length),r.push(n)),r}rangePairToCfiPair(e,t){var r=t.start,i=t.end;r.collapse(!0),i.collapse(!1);let s=new Pe(r,e).toString(),n=new Pe(i,e).toString();return{start:s,end:n}}rangeListToCfiList(e,t){for(var r=[],i,s=0;s<t.length;s++)i=this.rangePairToCfiPair(e,t[s]),r.push(i);return r}axis(e){return e&&(this.horizontal=e==="horizontal"),this.horizontal}}const Yn=typeof navigator<"u",oa=Yn&&/Chrome/.test(navigator.userAgent),ln=Yn&&!oa&&/AppleWebKit/.test(navigator.userAgent),ua=1;class Di{constructor(e,t,r,i){this.epubcfi=new Pe,this.document=e,this.documentElement=this.document.documentElement,this.content=t||this.document.body,this.window=this.document.defaultView,this._size={width:0,height:0},this.sectionIndex=i||0,this.cfiBase=r||"",this.epubReadingSystem("epub.js",_r),this.called=0,this.active=!0,this.listeners()}static get listenedEvents(){return hr}width(e){var t=this.content;return e&&$e(e)&&(e=e+"px"),e&&(t.style.width=e),parseInt(this.window.getComputedStyle(t).width)}height(e){var t=this.content;return e&&$e(e)&&(e=e+"px"),e&&(t.style.height=e),parseInt(this.window.getComputedStyle(t).height)}contentWidth(e){var t=this.content||this.document.body;return e&&$e(e)&&(e=e+"px"),e&&(t.style.width=e),parseInt(this.window.getComputedStyle(t).width)}contentHeight(e){var t=this.content||this.document.body;return e&&$e(e)&&(e=e+"px"),e&&(t.style.height=e),parseInt(this.window.getComputedStyle(t).height)}textWidth(){let e,t,r=this.document.createRange(),i=this.content||this.document.body,s=cr(i);return r.selectNodeContents(i),e=r.getBoundingClientRect(),t=e.width,s&&s.width&&(t+=s.width),Math.round(t)}textHeight(){let e,t,r=this.document.createRange(),i=this.content||this.document.body;return r.selectNodeContents(i),e=r.getBoundingClientRect(),t=e.bottom,Math.round(t)}scrollWidth(){var e=this.documentElement.scrollWidth;return e}scrollHeight(){var e=this.documentElement.scrollHeight;return e}overflow(e){return e&&(this.documentElement.style.overflow=e),this.window.getComputedStyle(this.documentElement).overflow}overflowX(e){return e&&(this.documentElement.style.overflowX=e),this.window.getComputedStyle(this.documentElement).overflowX}overflowY(e){return e&&(this.documentElement.style.overflowY=e),this.window.getComputedStyle(this.documentElement).overflowY}css(e,t,r){var i=this.content||this.document.body;return t?i.style.setProperty(e,t,r?"important":""):i.style.removeProperty(e),this.window.getComputedStyle(i)[e]}viewport(e){var t=this.document.querySelector("meta[name='viewport']"),r={width:void 0,height:void 0,scale:void 0,minimum:void 0,maximum:void 0,scalable:void 0},i=[],s={};if(t&&t.hasAttribute("content")){let n=t.getAttribute("content"),a=n.match(/width\s*=\s*([^,]*)/),l=n.match(/height\s*=\s*([^,]*)/),f=n.match(/initial-scale\s*=\s*([^,]*)/),d=n.match(/minimum-scale\s*=\s*([^,]*)/),c=n.match(/maximum-scale\s*=\s*([^,]*)/),b=n.match(/user-scalable\s*=\s*([^,]*)/);a&&a.length&&typeof a[1]<"u"&&(r.width=a[1]),l&&l.length&&typeof l[1]<"u"&&(r.height=l[1]),f&&f.length&&typeof f[1]<"u"&&(r.scale=f[1]),d&&d.length&&typeof d[1]<"u"&&(r.minimum=d[1]),c&&c.length&&typeof c[1]<"u"&&(r.maximum=c[1]),b&&b.length&&typeof b[1]<"u"&&(r.scalable=b[1])}return s=zn(e||{},r),e&&(s.width&&i.push("width="+s.width),s.height&&i.push("height="+s.height),s.scale&&i.push("initial-scale="+s.scale),s.scalable==="no"?(i.push("minimum-scale="+s.scale),i.push("maximum-scale="+s.scale),i.push("user-scalable="+s.scalable)):(s.scalable&&i.push("user-scalable="+s.scalable),s.minimum&&i.push("minimum-scale="+s.minimum),s.maximum&&i.push("minimum-scale="+s.maximum)),t||(t=this.document.createElement("meta"),t.setAttribute("name","viewport"),this.document.querySelector("head").appendChild(t)),t.setAttribute("content",i.join(", ")),this.window.scrollTo(0,0)),s}expand(){this.emit(pe.CONTENTS.EXPAND)}listeners(){this.imageLoadListeners(),this.mediaQueryListeners(),this.addEventListeners(),this.addSelectionListeners(),typeof ResizeObserver>"u"?(this.resizeListeners(),this.visibilityListeners()):this.resizeObservers(),this.linksHandler()}removeListeners(){this.removeEventListeners(),this.removeSelectionListeners(),this.observer&&this.observer.disconnect(),clearTimeout(this.expanding)}resizeCheck(){let e=this.textWidth(),t=this.textHeight();(e!=this._size.width||t!=this._size.height)&&(this._size={width:e,height:t},this.onResize&&this.onResize(this._size),this.emit(pe.CONTENTS.RESIZE,this._size))}resizeListeners(){clearTimeout(this.expanding),requestAnimationFrame(this.resizeCheck.bind(this)),this.expanding=setTimeout(this.resizeListeners.bind(this),350)}visibilityListeners(){document.addEventListener("visibilitychange",()=>{document.visibilityState==="visible"&&this.active===!1?(this.active=!0,this.resizeListeners()):(this.active=!1,clearTimeout(this.expanding))})}transitionListeners(){let e=this.content;e.style.transitionProperty="font, font-size, font-size-adjust, font-stretch, font-variation-settings, font-weight, width, height",e.style.transitionDuration="0.001ms",e.style.transitionTimingFunction="linear",e.style.transitionDelay="0",this._resizeCheck=this.resizeCheck.bind(this),this.document.addEventListener("transitionend",this._resizeCheck)}mediaQueryListeners(){for(var e=this.document.styleSheets,t=(function(a){a.matches&&!this._expanding&&setTimeout(this.expand.bind(this),1)}).bind(this),r=0;r<e.length;r+=1){var i;try{i=e[r].cssRules}catch{return}if(!i)return;for(var s=0;s<i.length;s+=1)if(i[s].media){var n=this.window.matchMedia(i[s].media.mediaText);n.addListener(t)}}}resizeObservers(){this.observer=new ResizeObserver(e=>{requestAnimationFrame(this.resizeCheck.bind(this))}),this.observer.observe(this.document.documentElement)}mutationObservers(){this.observer=new MutationObserver(t=>{this.resizeCheck()});let e={attributes:!0,childList:!0,characterData:!0,subtree:!0};this.observer.observe(this.document,e)}imageLoadListeners(){for(var e=this.document.querySelectorAll("img"),t,r=0;r<e.length;r++)t=e[r],typeof t.naturalWidth<"u"&&t.naturalWidth===0&&(t.onload=this.expand.bind(this))}fontLoadListeners(){!this.document||!this.document.fonts||this.document.fonts.ready.then((function(){this.resizeCheck()}).bind(this))}root(){return this.document?this.document.documentElement:null}locationOf(e,t){var r,i={left:0,top:0};if(!this.document)return i;if(this.epubcfi.isCfiString(e)){let s=new Pe(e).toRange(this.document,t);if(s){try{if(!s.endContainer||s.startContainer==s.endContainer&&s.startOffset==s.endOffset){let n=s.startContainer.textContent.indexOf(" ",s.startOffset);n==-1&&(n=s.startContainer.textContent.length),s.setEnd(s.startContainer,n)}}catch(n){console.error("setting end offset to start container length failed",n)}if(s.startContainer.nodeType===Node.ELEMENT_NODE)r=s.startContainer.getBoundingClientRect(),i.left=r.left,i.top=r.top;else if(ln){let n=s.startContainer,a=new Range;try{n.nodeType===ua?r=n.getBoundingClientRect():s.startOffset+2<n.length?(a.setStart(n,s.startOffset),a.setEnd(n,s.startOffset+2),r=a.getBoundingClientRect()):s.startOffset-2>0?(a.setStart(n,s.startOffset-2),a.setEnd(n,s.startOffset),r=a.getBoundingClientRect()):r=n.parentNode.getBoundingClientRect()}catch(l){console.error(l,l.stack)}}else r=s.getBoundingClientRect()}}else if(typeof e=="string"&&e.indexOf("#")>-1){let s=e.substring(e.indexOf("#")+1),n=this.document.getElementById(s);if(n)if(ln){let a=new Range;a.selectNode(n),r=a.getBoundingClientRect()}else r=n.getBoundingClientRect()}return r&&(i.left=r.left,i.top=r.top),i}addStylesheet(e){return new Promise((function(t,r){var i,s=!1;if(!this.document){t(!1);return}if(i=this.document.querySelector("link[href='"+e+"']"),i){t(!0);return}i=this.document.createElement("link"),i.type="text/css",i.rel="stylesheet",i.href=e,i.onload=i.onreadystatechange=function(){!s&&(!this.readyState||this.readyState=="complete")&&(s=!0,setTimeout(()=>{t(!0)},1))},this.document.head.appendChild(i)}).bind(this))}_getStylesheetNode(e){var t;return e="epubjs-inserted-css-"+(e||""),this.document?(t=this.document.getElementById(e),t||(t=this.document.createElement("style"),t.id=e,this.document.head.appendChild(t)),t):!1}addStylesheetCss(e,t){if(!this.document||!e)return!1;var r;return r=this._getStylesheetNode(t),r.innerHTML=e,!0}addStylesheetRules(e,t){var r;if(!(!this.document||!e||e.length===0))if(r=this._getStylesheetNode(t).sheet,Object.prototype.toString.call(e)==="[object Array]")for(var i=0,s=e.length;i<s;i++){var n=1,a=e[i],l=e[i][0],f="";Object.prototype.toString.call(a[1][0])==="[object Array]"&&(a=a[1],n=0);for(var d=a.length;n<d;n++){var c=a[n];f+=c[0]+":"+c[1]+(c[2]?" !important":"")+`;
`}r.insertRule(l+"{"+f+"}",r.cssRules.length)}else Object.keys(e).forEach(m=>{const N=e[m];if(Array.isArray(N))N.forEach(w=>{const v=Object.keys(w).map(g=>`${g}:${w[g]}`).join(";");r.insertRule(`${m}{${v}}`,r.cssRules.length)});else{const h=Object.keys(N).map(v=>`${v}:${N[v]}`).join(";");r.insertRule(`${m}{${h}}`,r.cssRules.length)}})}addScript(e){return new Promise((function(t,r){var i,s=!1;if(!this.document){t(!1);return}i=this.document.createElement("script"),i.type="text/javascript",i.async=!0,i.src=e,i.onload=i.onreadystatechange=function(){!s&&(!this.readyState||this.readyState=="complete")&&(s=!0,setTimeout(function(){t(!0)},1))},this.document.head.appendChild(i)}).bind(this))}addClass(e){var t;this.document&&(t=this.content||this.document.body,t&&t.classList.add(e))}removeClass(e){var t;this.document&&(t=this.content||this.document.body,t&&t.classList.remove(e))}addEventListeners(){this.document&&(this._triggerEvent=this.triggerEvent.bind(this),hr.forEach(function(e){this.document.addEventListener(e,this._triggerEvent,{passive:!0})},this))}removeEventListeners(){this.document&&(hr.forEach(function(e){this.document.removeEventListener(e,this._triggerEvent,{passive:!0})},this),this._triggerEvent=void 0)}triggerEvent(e){this.emit(e.type,e)}addSelectionListeners(){this.document&&(this._onSelectionChange=this.onSelectionChange.bind(this),this.document.addEventListener("selectionchange",this._onSelectionChange,{passive:!0}))}removeSelectionListeners(){this.document&&(this.document.removeEventListener("selectionchange",this._onSelectionChange,{passive:!0}),this._onSelectionChange=void 0)}onSelectionChange(e){this.selectionEndTimeout&&clearTimeout(this.selectionEndTimeout),this.selectionEndTimeout=setTimeout((function(){var t=this.window.getSelection();this.triggerSelectedEvent(t)}).bind(this),250)}triggerSelectedEvent(e){var t,r;e&&e.rangeCount>0&&(t=e.getRangeAt(0),t.collapsed||(r=new Pe(t,this.cfiBase).toString(),this.emit(pe.CONTENTS.SELECTED,r),this.emit(pe.CONTENTS.SELECTED_RANGE,t)))}range(e,t){var r=new Pe(e);return r.toRange(this.document,t)}cfiFromRange(e,t){return new Pe(e,this.cfiBase,t).toString()}cfiFromNode(e,t){return new Pe(e,this.cfiBase,t).toString()}map(e){var t=new mr(e);return t.section()}size(e,t){var r={scale:1,scalable:"no"};this.layoutStyle("scrolling"),e>=0&&(this.width(e),r.width=e,this.css("padding","0 "+e/12+"px")),t>=0&&(this.height(t),r.height=t),this.css("margin","0"),this.css("box-sizing","border-box"),this.viewport(r)}columns(e,t,r,i,s){let n=qt("column-axis"),a=qt("column-gap"),l=qt("column-width"),f=qt("column-fill"),c=this.writingMode().indexOf("vertical")===0?"vertical":"horizontal";this.layoutStyle("paginated"),s==="rtl"&&c==="horizontal"&&this.direction(s),this.width(e),this.height(t),this.viewport({width:e,height:t,scale:1,scalable:"no"}),this.css("overflow-y","hidden"),this.css("margin","0",!0),c==="vertical"?(this.css("padding-top",i/2+"px",!0),this.css("padding-bottom",i/2+"px",!0),this.css("padding-left","20px"),this.css("padding-right","20px"),this.css(n,"vertical")):(this.css("padding-top","20px"),this.css("padding-bottom","20px"),this.css("padding-left",i/2+"px",!0),this.css("padding-right",i/2+"px",!0),this.css(n,"horizontal")),this.css("box-sizing","border-box"),this.css("max-width","inherit"),this.css(f,"auto"),this.css(a,i+"px"),this.css(l,r+"px"),this.css("-webkit-line-box-contain","block glyphs replaced")}scaler(e,t,r){var i="scale("+e+")",s="";this.css("transform-origin","top left"),(t>=0||r>=0)&&(s=" translate("+(t||0)+"px, "+(r||0)+"px )"),this.css("transform",i+s)}fit(e,t,r){var i=this.viewport(),s=parseInt(i.width),n=parseInt(i.height),a=e/s,l=t/n,f=a<l?a:l;if(this.layoutStyle("paginated"),this.width(s),this.height(n),this.overflow("hidden"),this.scaler(f,0,0),this.css("background-size",s*f+"px "+n*f+"px"),this.css("background-color","transparent"),r&&r.properties.includes("page-spread-left")){var d=e-s*f;this.css("margin-left",d+"px")}}direction(e){this.documentElement&&(this.documentElement.style.direction=e)}mapPage(e,t,r,i,s){var n=new mr(t,s);return n.page(this,e,r,i)}linksHandler(){Js(this.content,e=>{this.emit(pe.CONTENTS.LINK_CLICKED,e)})}writingMode(e){let t=qt("writing-mode");return e&&this.documentElement&&(this.documentElement.style[t]=e),this.window.getComputedStyle(this.documentElement)[t]||""}layoutStyle(e){return e&&(this._layoutStyle=e,navigator.epubReadingSystem.layoutStyle=this._layoutStyle),this._layoutStyle||"paginated"}epubReadingSystem(e,t){return navigator.epubReadingSystem={name:e,version:t,layoutStyle:this.layoutStyle(),hasFeature:function(r){switch(r){case"dom-manipulation":return!0;case"layout-changes":return!0;case"touch-events":return!0;case"mouse-events":return!0;case"keyboard-events":return!0;case"spine-scripting":return!1;default:return!1}}},navigator.epubReadingSystem}destroy(){this.removeListeners()}}St(Di.prototype);class la{constructor(e){this.rendition=e,this.highlights=[],this.underlines=[],this.marks=[],this._annotations={},this._annotationsBySectionIndex={},this.rendition.hooks.render.register(this.inject.bind(this)),this.rendition.hooks.unloaded.register(this.clear.bind(this))}add(e,t,r,i,s,n){let a=encodeURI(t+e),f=new Pe(t).spinePos,d=new $n({type:e,cfiRange:t,data:r,sectionIndex:f,cb:i,className:s,styles:n});return this._annotations[a]=d,f in this._annotationsBySectionIndex?this._annotationsBySectionIndex[f].push(a):this._annotationsBySectionIndex[f]=[a],this.rendition.views().forEach(b=>{d.sectionIndex===b.index&&d.attach(b)}),d}remove(e,t){let r=encodeURI(e+t);if(r in this._annotations){let i=this._annotations[r];if(t&&i.type!==t)return;this.rendition.views().forEach(n=>{this._removeFromAnnotationBySectionIndex(i.sectionIndex,r),i.sectionIndex===n.index&&i.detach(n)}),delete this._annotations[r]}}_removeFromAnnotationBySectionIndex(e,t){this._annotationsBySectionIndex[e]=this._annotationsAt(e).filter(r=>r!==t)}_annotationsAt(e){return this._annotationsBySectionIndex[e]}highlight(e,t,r,i,s){return this.add("highlight",e,t,r,i,s)}underline(e,t,r,i,s){return this.add("underline",e,t,r,i,s)}mark(e,t,r){return this.add("mark",e,t,r)}each(){return this._annotations.forEach.apply(this._annotations,arguments)}inject(e){let t=e.index;t in this._annotationsBySectionIndex&&this._annotationsBySectionIndex[t].forEach(i=>{this._annotations[i].attach(e)})}clear(e){let t=e.index;t in this._annotationsBySectionIndex&&this._annotationsBySectionIndex[t].forEach(i=>{this._annotations[i].detach(e)})}show(){}hide(){}}class $n{constructor({type:e,cfiRange:t,data:r,sectionIndex:i,cb:s,className:n,styles:a}){this.type=e,this.cfiRange=t,this.data=r,this.sectionIndex=i,this.mark=void 0,this.cb=s,this.className=n,this.styles=a}update(e){this.data=e}attach(e){let{cfiRange:t,data:r,type:i,mark:s,cb:n,className:a,styles:l}=this,f;return i==="highlight"?f=e.highlight(t,r,n,a,l):i==="underline"?f=e.underline(t,r,n,a,l):i==="mark"&&(f=e.mark(t,r,n)),this.mark=f,this.emit(pe.ANNOTATION.ATTACH,f),f}detach(e){let{cfiRange:t,type:r}=this,i;return e&&(r==="highlight"?i=e.unhighlight(t):r==="underline"?i=e.ununderline(t):r==="mark"&&(i=e.unmark(t))),this.mark=void 0,this.emit(pe.ANNOTATION.DETACH,i),i}text(){}}St($n.prototype);var xt={},Jt={},hn;function ha(){if(hn)return Jt;hn=1,Object.defineProperty(Jt,"__esModule",{value:!0}),Jt.createElement=x;function x(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}return Jt.default={createElement:x},Jt}var jt={},fn;function fa(){if(fn)return jt;fn=1,Object.defineProperty(jt,"__esModule",{value:!0}),jt.proxyMouse=x,jt.clone=e,jt.default={proxyMouse:x};function x(r,i){function s(f){for(var d=i.length-1;d>=0;d--){var c=i[d],b=f.clientX,m=f.clientY;if(f.touches&&f.touches.length&&(b=f.touches[0].clientX,m=f.touches[0].clientY),!!t(c,r,b,m)){c.dispatchEvent(e(f));break}}}if(r.nodeName==="iframe"||r.nodeName==="IFRAME")try{this.target=r.contentDocument}catch{this.target=r}else this.target=r;for(var n=["mouseup","mousedown","click","touchstart"],a=0;a<n.length;a++){var l=n[a];this.target.addEventListener(l,function(f){return s(f)},!1)}}function e(r){var i=Object.assign({},r,{bubbles:!1});try{return new MouseEvent(r.type,i)}catch{var s=document.createEvent("MouseEvents");return s.initMouseEvent(r.type,!1,i.cancelable,i.view,i.detail,i.screenX,i.screenY,i.clientX,i.clientY,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.button,i.relatedTarget),s}}function t(r,i,s,n){var a=i.getBoundingClientRect();function l(m,N,w){var h=m.top-a.top,v=m.left-a.left,g=h+m.height,E=v+m.width;return h<=w&&v<=N&&g>w&&E>N}var f=r.getBoundingClientRect();if(!l(f,s,n))return!1;for(var d=r.getClientRects(),c=0,b=d.length;c<b;c++)if(l(d[c],s,n))return!0;return!1}return jt}var cn;function ca(){if(cn)return xt;cn=1,Object.defineProperty(xt,"__esModule",{value:!0}),xt.Underline=xt.Highlight=xt.Mark=xt.Pane=void 0;var x=function w(h,v,g){h===null&&(h=Function.prototype);var E=Object.getOwnPropertyDescriptor(h,v);if(E===void 0){var L=Object.getPrototypeOf(h);return L===null?void 0:w(L,v,g)}else{if("value"in E)return E.value;var y=E.get;return y===void 0?void 0:y.call(g)}},e=(function(){function w(h,v){for(var g=0;g<v.length;g++){var E=v[g];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(h,E.key,E)}}return function(h,v,g){return v&&w(h.prototype,v),g&&w(h,g),h}})(),t=ha(),r=n(t),i=fa(),s=n(i);function n(w){return w&&w.__esModule?w:{default:w}}function a(w,h){if(!w)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return h&&(typeof h=="object"||typeof h=="function")?h:w}function l(w,h){if(typeof h!="function"&&h!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof h);w.prototype=Object.create(h&&h.prototype,{constructor:{value:w,enumerable:!1,writable:!0,configurable:!0}}),h&&(Object.setPrototypeOf?Object.setPrototypeOf(w,h):w.__proto__=h)}function f(w,h){if(!(w instanceof h))throw new TypeError("Cannot call a class as a function")}xt.Pane=(function(){function w(h){var v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document.body;f(this,w),this.target=h,this.element=r.default.createElement("svg"),this.marks=[],this.element.style.position="absolute",this.element.setAttribute("pointer-events","none"),s.default.proxyMouse(this.target,this.marks),this.container=v,this.container.appendChild(this.element),this.render()}return e(w,[{key:"addMark",value:function(v){var g=r.default.createElement("g");return this.element.appendChild(g),v.bind(g,this.container),this.marks.push(v),v.render(),v}},{key:"removeMark",value:function(v){var g=this.marks.indexOf(v);if(g!==-1){var E=v.unbind();this.element.removeChild(E),this.marks.splice(g,1)}}},{key:"render",value:function(){m(this.element,b(this.target,this.container));var v=!0,g=!1,E=void 0;try{for(var L=this.marks[Symbol.iterator](),y;!(v=(y=L.next()).done);v=!0){var S=y.value;S.render()}}catch(R){g=!0,E=R}finally{try{!v&&L.return&&L.return()}finally{if(g)throw E}}}}]),w})();var d=xt.Mark=(function(){function w(){f(this,w),this.element=null}return e(w,[{key:"bind",value:function(v,g){this.element=v,this.container=g}},{key:"unbind",value:function(){var v=this.element;return this.element=null,v}},{key:"render",value:function(){}},{key:"dispatchEvent",value:function(v){this.element&&this.element.dispatchEvent(v)}},{key:"getBoundingClientRect",value:function(){return this.element.getBoundingClientRect()}},{key:"getClientRects",value:function(){for(var v=[],g=this.element.firstChild;g;)v.push(g.getBoundingClientRect()),g=g.nextSibling;return v}},{key:"filteredRanges",value:function(){var v=Array.from(this.range.getClientRects());return v.filter(function(g){for(var E=0;E<v.length;E++){if(v[E]===g)return!0;var L=N(v[E],g);if(L)return!1}return!0})}}]),w})(),c=xt.Highlight=(function(w){l(h,w);function h(v,g,E,L){f(this,h);var y=a(this,(h.__proto__||Object.getPrototypeOf(h)).call(this));return y.range=v,y.className=g,y.data=E||{},y.attributes=L||{},y}return e(h,[{key:"bind",value:function(g,E){x(h.prototype.__proto__||Object.getPrototypeOf(h.prototype),"bind",this).call(this,g,E);for(var L in this.data)this.data.hasOwnProperty(L)&&(this.element.dataset[L]=this.data[L]);for(var L in this.attributes)this.attributes.hasOwnProperty(L)&&this.element.setAttribute(L,this.attributes[L]);this.className&&this.element.classList.add(this.className)}},{key:"render",value:function(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);for(var g=this.element.ownerDocument.createDocumentFragment(),E=this.filteredRanges(),L=this.element.getBoundingClientRect(),y=this.container.getBoundingClientRect(),S=0,R=E.length;S<R;S++){var I=E[S],k=r.default.createElement("rect");k.setAttribute("x",I.left-L.left+y.left),k.setAttribute("y",I.top-L.top+y.top),k.setAttribute("height",I.height),k.setAttribute("width",I.width),g.appendChild(k)}this.element.appendChild(g)}}]),h})(d);xt.Underline=(function(w){l(h,w);function h(v,g,E,L){return f(this,h),a(this,(h.__proto__||Object.getPrototypeOf(h)).call(this,v,g,E,L))}return e(h,[{key:"render",value:function(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);for(var g=this.element.ownerDocument.createDocumentFragment(),E=this.filteredRanges(),L=this.element.getBoundingClientRect(),y=this.container.getBoundingClientRect(),S=0,R=E.length;S<R;S++){var I=E[S],k=r.default.createElement("rect");k.setAttribute("x",I.left-L.left+y.left),k.setAttribute("y",I.top-L.top+y.top),k.setAttribute("height",I.height),k.setAttribute("width",I.width),k.setAttribute("fill","none");var O=r.default.createElement("line");O.setAttribute("x1",I.left-L.left+y.left),O.setAttribute("x2",I.left-L.left+y.left+I.width),O.setAttribute("y1",I.top-L.top+y.top+I.height-1),O.setAttribute("y2",I.top-L.top+y.top+I.height-1),O.setAttribute("stroke-width",1),O.setAttribute("stroke","black"),O.setAttribute("stroke-linecap","square"),g.appendChild(k),g.appendChild(O)}this.element.appendChild(g)}}]),h})(c);function b(w,h){var v=h.getBoundingClientRect(),g=w.getBoundingClientRect();return{top:g.top-v.top,left:g.left-v.left,height:w.scrollHeight,width:w.scrollWidth}}function m(w,h){w.style.setProperty("top",h.top+"px","important"),w.style.setProperty("left",h.left+"px","important"),w.style.setProperty("height",h.height+"px","important"),w.style.setProperty("width",h.width+"px","important")}function N(w,h){return h.right<=w.right&&h.left>=w.left&&h.top>=w.top&&h.bottom<=w.bottom}return xt}var or=ca();class Kn{constructor(e,t){this.settings=ut({ignoreClass:"",axis:void 0,direction:void 0,width:0,height:0,layout:void 0,globalLayoutProperties:{},method:void 0,forceRight:!1,allowScriptedContent:!1,allowPopups:!1},t||{}),this.id="epubjs-view-"+wr(),this.section=e,this.index=e.index,this.element=this.container(this.settings.axis),this.added=!1,this.displayed=!1,this.rendered=!1,this.fixedWidth=0,this.fixedHeight=0,this.epubcfi=new Pe,this.layout=this.settings.layout,this.pane=void 0,this.highlights={},this.underlines={},this.marks={}}container(e){var t=document.createElement("div");return t.classList.add("epub-view"),t.style.height="0px",t.style.width="0px",t.style.overflow="hidden",t.style.position="relative",t.style.display="block",e&&e=="horizontal"?t.style.flex="none":t.style.flex="initial",t}create(){return this.iframe?this.iframe:(this.element||(this.element=this.createContainer()),this.iframe=document.createElement("iframe"),this.iframe.id=this.id,this.iframe.scrolling="no",this.iframe.style.overflow="hidden",this.iframe.seamless="seamless",this.iframe.style.border="none",this.iframe.sandbox="allow-same-origin",this.settings.allowScriptedContent&&(this.iframe.sandbox+=" allow-scripts"),this.settings.allowPopups&&(this.iframe.sandbox+=" allow-popups"),this.iframe.setAttribute("enable-annotation","true"),this.resizing=!0,this.element.style.visibility="hidden",this.iframe.style.visibility="hidden",this.iframe.style.width="0",this.iframe.style.height="0",this._width=0,this._height=0,this.element.setAttribute("ref",this.index),this.added=!0,this.elementBounds=lr(this.element),"srcdoc"in this.iframe?this.supportsSrcdoc=!0:this.supportsSrcdoc=!1,this.settings.method||(this.settings.method=this.supportsSrcdoc?"srcdoc":"write"),this.iframe)}render(e,t){return this.create(),this.size(),this.sectionRender||(this.sectionRender=this.section.render(e)),this.sectionRender.then((function(r){return this.load(r)}).bind(this)).then((function(){let r=this.contents.writingMode(),i;return this.settings.flow==="scrolled"?i=r.indexOf("vertical")===0?"horizontal":"vertical":i=r.indexOf("vertical")===0?"vertical":"horizontal",r.indexOf("vertical")===0&&this.settings.flow==="paginated"&&(this.layout.delta=this.layout.height),this.setAxis(i),this.emit(pe.VIEWS.AXIS,i),this.setWritingMode(r),this.emit(pe.VIEWS.WRITING_MODE,r),this.layout.format(this.contents,this.section,this.axis),this.addListeners(),new Promise((s,n)=>{this.expand(),this.settings.forceRight&&(this.element.style.marginLeft=this.width()+"px"),s()})}).bind(this),(function(r){return this.emit(pe.VIEWS.LOAD_ERROR,r),new Promise((i,s)=>{s(r)})}).bind(this)).then((function(){this.emit(pe.VIEWS.RENDERED,this.section)}).bind(this))}reset(){this.iframe&&(this.iframe.style.width="0",this.iframe.style.height="0",this._width=0,this._height=0,this._textWidth=void 0,this._contentWidth=void 0,this._textHeight=void 0,this._contentHeight=void 0),this._needsReframe=!0}size(e,t){var r=e||this.settings.width,i=t||this.settings.height;this.layout.name==="pre-paginated"?this.lock("both",r,i):this.settings.axis==="horizontal"?this.lock("height",r,i):this.lock("width",r,i),this.settings.width=r,this.settings.height=i}lock(e,t,r){var i=cr(this.element),s;this.iframe?s=cr(this.iframe):s={width:0,height:0},e=="width"&&$e(t)&&(this.lockedWidth=t-i.width-s.width),e=="height"&&$e(r)&&(this.lockedHeight=r-i.height-s.height),e==="both"&&$e(t)&&$e(r)&&(this.lockedWidth=t-i.width-s.width,this.lockedHeight=r-i.height-s.height),this.displayed&&this.iframe&&this.expand()}expand(e){var t=this.lockedWidth,r=this.lockedHeight,i;!this.iframe||this._expanding||(this._expanding=!0,this.layout.name==="pre-paginated"?(t=this.layout.columnWidth,r=this.layout.height):this.settings.axis==="horizontal"?(t=this.contents.textWidth(),t%this.layout.pageWidth>0&&(t=Math.ceil(t/this.layout.pageWidth)*this.layout.pageWidth),this.settings.forceEvenPages&&(i=t/this.layout.pageWidth,this.layout.divisor>1&&this.layout.name==="reflowable"&&i%2>0&&(t+=this.layout.pageWidth))):this.settings.axis==="vertical"&&(r=this.contents.textHeight(),this.settings.flow==="paginated"&&r%this.layout.height>0&&(r=Math.ceil(r/this.layout.height)*this.layout.height)),(this._needsReframe||t!=this._width||r!=this._height)&&this.reframe(t,r),this._expanding=!1)}reframe(e,t){var r;$e(e)&&(this.element.style.width=e+"px",this.iframe.style.width=e+"px",this._width=e),$e(t)&&(this.element.style.height=t+"px",this.iframe.style.height=t+"px",this._height=t);let i=this.prevBounds?e-this.prevBounds.width:e,s=this.prevBounds?t-this.prevBounds.height:t;r={width:e,height:t,widthDelta:i,heightDelta:s},this.pane&&this.pane.render(),requestAnimationFrame(()=>{let n;for(let a in this.marks)this.marks.hasOwnProperty(a)&&(n=this.marks[a],this.placeMark(n.element,n.range))}),this.onResize(this,r),this.emit(pe.VIEWS.RESIZED,r),this.prevBounds=r,this.elementBounds=lr(this.element)}load(e){var t=new Fe,r=t.promise;if(!this.iframe)return t.reject(new Error("No Iframe Available")),r;if(this.iframe.onload=(function(s){this.onLoad(s,t)}).bind(this),this.settings.method==="blobUrl")this.blobUrl=pr(e,"application/xhtml+xml"),this.iframe.src=this.blobUrl,this.element.appendChild(this.iframe);else if(this.settings.method==="srcdoc")this.iframe.srcdoc=e,this.element.appendChild(this.iframe);else{if(this.element.appendChild(this.iframe),this.document=this.iframe.contentDocument,!this.document)return t.reject(new Error("No Document Available")),r;if(this.iframe.contentDocument.open(),window.MSApp&&MSApp.execUnsafeLocalFunction){var i=this;MSApp.execUnsafeLocalFunction(function(){i.iframe.contentDocument.write(e)})}else this.iframe.contentDocument.write(e);this.iframe.contentDocument.close()}return r}onLoad(e,t){this.window=this.iframe.contentWindow,this.document=this.iframe.contentDocument,this.contents=new Di(this.document,this.document.body,this.section.cfiBase,this.section.index),this.rendering=!1;var r=this.document.querySelector("link[rel='canonical']");r?r.setAttribute("href",this.section.canonical):(r=this.document.createElement("link"),r.setAttribute("rel","canonical"),r.setAttribute("href",this.section.canonical),this.document.querySelector("head").appendChild(r)),this.contents.on(pe.CONTENTS.EXPAND,()=>{this.displayed&&this.iframe&&(this.expand(),this.contents&&this.layout.format(this.contents))}),this.contents.on(pe.CONTENTS.RESIZE,i=>{this.displayed&&this.iframe&&(this.expand(),this.contents&&this.layout.format(this.contents))}),t.resolve(this.contents)}setLayout(e){this.layout=e,this.contents&&(this.layout.format(this.contents),this.expand())}setAxis(e){this.settings.axis=e,e=="horizontal"?this.element.style.flex="none":this.element.style.flex="initial",this.size()}setWritingMode(e){this.writingMode=e}addListeners(){}removeListeners(e){}display(e){var t=new Fe;return this.displayed?t.resolve(this):this.render(e).then((function(){this.emit(pe.VIEWS.DISPLAYED,this),this.onDisplayed(this),this.displayed=!0,t.resolve(this)}).bind(this),function(r){t.reject(r,this)}),t.promise}show(){this.element.style.visibility="visible",this.iframe&&(this.iframe.style.visibility="visible",this.iframe.style.transform="translateZ(0)",this.iframe.offsetWidth,this.iframe.style.transform=null),this.emit(pe.VIEWS.SHOWN,this)}hide(){this.element.style.visibility="hidden",this.iframe.style.visibility="hidden",this.stopExpanding=!0,this.emit(pe.VIEWS.HIDDEN,this)}offset(){return{top:this.element.offsetTop,left:this.element.offsetLeft}}width(){return this._width}height(){return this._height}position(){return this.element.getBoundingClientRect()}locationOf(e){this.iframe.getBoundingClientRect();var t=this.contents.locationOf(e,this.settings.ignoreClass);return{left:t.left,top:t.top}}onDisplayed(e){}onResize(e,t){}bounds(e){return(e||!this.elementBounds)&&(this.elementBounds=lr(this.element)),this.elementBounds}highlight(e,t={},r,i="epubjs-hl",s={}){if(!this.contents)return;const n=Object.assign({fill:"yellow","fill-opacity":"0.3","mix-blend-mode":"multiply"},s);let a=this.contents.range(e),l=()=>{this.emit(pe.VIEWS.MARK_CLICKED,e,t)};t.epubcfi=e,this.pane||(this.pane=new or.Pane(this.iframe,this.element));let f=new or.Highlight(a,i,t,n),d=this.pane.addMark(f);return this.highlights[e]={mark:d,element:d.element,listeners:[l,r]},d.element.setAttribute("ref",i),d.element.addEventListener("click",l),d.element.addEventListener("touchstart",l),r&&(d.element.addEventListener("click",r),d.element.addEventListener("touchstart",r)),d}underline(e,t={},r,i="epubjs-ul",s={}){if(!this.contents)return;const n=Object.assign({stroke:"black","stroke-opacity":"0.3","mix-blend-mode":"multiply"},s);let a=this.contents.range(e),l=()=>{this.emit(pe.VIEWS.MARK_CLICKED,e,t)};t.epubcfi=e,this.pane||(this.pane=new or.Pane(this.iframe,this.element));let f=new or.Underline(a,i,t,n),d=this.pane.addMark(f);return this.underlines[e]={mark:d,element:d.element,listeners:[l,r]},d.element.setAttribute("ref",i),d.element.addEventListener("click",l),d.element.addEventListener("touchstart",l),r&&(d.element.addEventListener("click",r),d.element.addEventListener("touchstart",r)),d}mark(e,t={},r){if(!this.contents)return;if(e in this.marks)return this.marks[e];let i=this.contents.range(e);if(!i)return;let s=i.commonAncestorContainer,n=s.nodeType===1?s:s.parentNode,a=f=>{this.emit(pe.VIEWS.MARK_CLICKED,e,t)};i.collapsed&&s.nodeType===1?(i=new Range,i.selectNodeContents(s)):i.collapsed&&(i=new Range,i.selectNodeContents(n));let l=this.document.createElement("a");return l.setAttribute("ref","epubjs-mk"),l.style.position="absolute",l.dataset.epubcfi=e,t&&Object.keys(t).forEach(f=>{l.dataset[f]=t[f]}),r&&(l.addEventListener("click",r),l.addEventListener("touchstart",r)),l.addEventListener("click",a),l.addEventListener("touchstart",a),this.placeMark(l,i),this.element.appendChild(l),this.marks[e]={element:l,range:i,listeners:[a,r]},n}placeMark(e,t){let r,i,s;if(this.layout.name==="pre-paginated"||this.settings.axis!=="horizontal"){let a=t.getBoundingClientRect();r=a.top,i=a.right}else{let a=t.getClientRects(),l;for(var n=0;n!=a.length;n++)l=a[n],(!s||l.left<s)&&(s=l.left,i=Math.ceil(s/this.layout.props.pageWidth)*this.layout.props.pageWidth-this.layout.gap/2,r=l.top)}e.style.top=`${r}px`,e.style.left=`${i}px`}unhighlight(e){let t;e in this.highlights&&(t=this.highlights[e],this.pane.removeMark(t.mark),t.listeners.forEach(r=>{r&&(t.element.removeEventListener("click",r),t.element.removeEventListener("touchstart",r))}),delete this.highlights[e])}ununderline(e){let t;e in this.underlines&&(t=this.underlines[e],this.pane.removeMark(t.mark),t.listeners.forEach(r=>{r&&(t.element.removeEventListener("click",r),t.element.removeEventListener("touchstart",r))}),delete this.underlines[e])}unmark(e){let t;e in this.marks&&(t=this.marks[e],this.element.removeChild(t.element),t.listeners.forEach(r=>{r&&(t.element.removeEventListener("click",r),t.element.removeEventListener("touchstart",r))}),delete this.marks[e])}destroy(){for(let e in this.highlights)this.unhighlight(e);for(let e in this.underlines)this.ununderline(e);for(let e in this.marks)this.unmark(e);this.blobUrl&&jn(this.blobUrl),this.displayed&&(this.displayed=!1,this.removeListeners(),this.contents.destroy(),this.stopExpanding=!0,this.element.removeChild(this.iframe),this.pane&&(this.pane.element.remove(),this.pane=void 0),this.iframe=void 0,this.contents=void 0,this._textWidth=null,this._textHeight=null,this._width=null,this._height=null)}}St(Kn.prototype);function da(){var x="reverse",e=pa();return document.body.appendChild(e),e.scrollLeft>0?x="default":typeof Element<"u"&&Element.prototype.scrollIntoView?(e.children[0].children[1].scrollIntoView(),e.scrollLeft<0&&(x="negative")):(e.scrollLeft=1,e.scrollLeft===0&&(x="negative")),document.body.removeChild(e),x}function pa(){var x=document.createElement("div");x.dir="rtl",x.style.position="fixed",x.style.width="1px",x.style.height="1px",x.style.top="0px",x.style.left="0px",x.style.overflow="hidden";var e=document.createElement("div");e.style.width="2px";var t=document.createElement("span");t.style.width="1px",t.style.display="inline-block";var r=document.createElement("span");return r.style.width="1px",r.style.display="inline-block",e.appendChild(t),e.appendChild(r),x.appendChild(e),x}var $r,dn;function Ai(){if(dn)return $r;dn=1;function x(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}return $r=x,$r}var Kr,pn;function va(){if(pn)return Kr;pn=1;var x=typeof yt=="object"&&yt&&yt.Object===Object&&yt;return Kr=x,Kr}var Jr,vn;function Jn(){if(vn)return Jr;vn=1;var x=va(),e=typeof self=="object"&&self&&self.Object===Object&&self,t=x||e||Function("return this")();return Jr=t,Jr}var Qr,gn;function ga(){if(gn)return Qr;gn=1;var x=Jn(),e=function(){return x.Date.now()};return Qr=e,Qr}var ei,mn;function ma(){if(mn)return ei;mn=1;var x=/\s/;function e(t){for(var r=t.length;r--&&x.test(t.charAt(r)););return r}return ei=e,ei}var ti,bn;function ba(){if(bn)return ti;bn=1;var x=ma(),e=/^\s+/;function t(r){return r&&r.slice(0,x(r)+1).replace(e,"")}return ti=t,ti}var ri,yn;function Qn(){if(yn)return ri;yn=1;var x=Jn(),e=x.Symbol;return ri=e,ri}var ii,wn;function ya(){if(wn)return ii;wn=1;var x=Qn(),e=Object.prototype,t=e.hasOwnProperty,r=e.toString,i=x?x.toStringTag:void 0;function s(n){var a=t.call(n,i),l=n[i];try{n[i]=void 0;var f=!0}catch{}var d=r.call(n);return f&&(a?n[i]=l:delete n[i]),d}return ii=s,ii}var ni,_n;function wa(){if(_n)return ni;_n=1;var x=Object.prototype,e=x.toString;function t(r){return e.call(r)}return ni=t,ni}var si,xn;function _a(){if(xn)return si;xn=1;var x=Qn(),e=ya(),t=wa(),r="[object Null]",i="[object Undefined]",s=x?x.toStringTag:void 0;function n(a){return a==null?a===void 0?i:r:s&&s in Object(a)?e(a):t(a)}return si=n,si}var ai,En;function xa(){if(En)return ai;En=1;function x(e){return e!=null&&typeof e=="object"}return ai=x,ai}var oi,Dn;function Ea(){if(Dn)return oi;Dn=1;var x=_a(),e=xa(),t="[object Symbol]";function r(i){return typeof i=="symbol"||e(i)&&x(i)==t}return oi=r,oi}var ui,An;function Da(){if(An)return ui;An=1;var x=ba(),e=Ai(),t=Ea(),r=NaN,i=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,n=/^0o[0-7]+$/i,a=parseInt;function l(f){if(typeof f=="number")return f;if(t(f))return r;if(e(f)){var d=typeof f.valueOf=="function"?f.valueOf():f;f=e(d)?d+"":d}if(typeof f!="string")return f===0?f:+f;f=x(f);var c=s.test(f);return c||n.test(f)?a(f.slice(2),c?2:8):i.test(f)?r:+f}return ui=l,ui}var li,Cn;function es(){if(Cn)return li;Cn=1;var x=Ai(),e=ga(),t=Da(),r="Expected a function",i=Math.max,s=Math.min;function n(a,l,f){var d,c,b,m,N,w,h=0,v=!1,g=!1,E=!0;if(typeof a!="function")throw new TypeError(r);l=t(l)||0,x(f)&&(v=!!f.leading,g="maxWait"in f,b=g?i(t(f.maxWait)||0,l):b,E="trailing"in f?!!f.trailing:E);function L(Z){var K=d,J=c;return d=c=void 0,h=Z,m=a.apply(J,K),m}function y(Z){return h=Z,N=setTimeout(I,l),v?L(Z):m}function S(Z){var K=Z-w,J=Z-h,he=l-K;return g?s(he,b-J):he}function R(Z){var K=Z-w,J=Z-h;return w===void 0||K>=l||K<0||g&&J>=b}function I(){var Z=e();if(R(Z))return k(Z);N=setTimeout(I,S(Z))}function k(Z){return N=void 0,E&&d?L(Z):(d=c=void 0,m)}function O(){N!==void 0&&clearTimeout(N),h=0,d=w=c=N=void 0}function H(){return N===void 0?m:k(e())}function j(){var Z=e(),K=R(Z);if(d=arguments,c=this,w=Z,K){if(N===void 0)return y(w);if(g)return clearTimeout(N),N=setTimeout(I,l),L(w)}return N===void 0&&(N=setTimeout(I,l)),m}return j.cancel=O,j.flush=H,j}return li=n,li}var hi,Sn;function Aa(){if(Sn)return hi;Sn=1;var x=es(),e=Ai(),t="Expected a function";function r(i,s,n){var a=!0,l=!0;if(typeof i!="function")throw new TypeError(t);return e(n)&&(a="leading"in n?!!n.leading:a,l="trailing"in n?!!n.trailing:l),x(i,s,{leading:a,maxWait:s,trailing:l})}return hi=r,hi}var Ca=Aa();const Sa=Zt(Ca);class Ta{constructor(e){this.settings=e||{},this.id="epubjs-container-"+wr(),this.container=this.create(this.settings),this.settings.hidden&&(this.wrapper=this.wrap(this.container))}create(e){let t=e.height,r=e.width,i=e.overflow||!1,s=e.axis||"vertical",n=e.direction;ut(this.settings,e),e.height&&$e(e.height)&&(t=e.height+"px"),e.width&&$e(e.width)&&(r=e.width+"px");let a=document.createElement("div");return a.id=this.id,a.classList.add("epub-container"),a.style.wordSpacing="0",a.style.lineHeight="0",a.style.verticalAlign="top",a.style.position="relative",s==="horizontal"&&(a.style.display="flex",a.style.flexDirection="row",a.style.flexWrap="nowrap"),r&&(a.style.width=r),t&&(a.style.height=t),i&&(i==="scroll"&&s==="vertical"?(a.style["overflow-y"]=i,a.style["overflow-x"]="hidden"):i==="scroll"&&s==="horizontal"?(a.style["overflow-y"]="hidden",a.style["overflow-x"]=i):a.style.overflow=i),n&&(a.dir=n,a.style.direction=n),n&&this.settings.fullsize&&(document.body.style.direction=n),a}wrap(e){var t=document.createElement("div");return t.style.visibility="hidden",t.style.overflow="hidden",t.style.width="0",t.style.height="0",t.appendChild(e),t}getElement(e){var t;if(Fn(e)?t=e:typeof e=="string"&&(t=document.getElementById(e)),!t)throw new Error("Not an Element");return t}attachTo(e){var t=this.getElement(e),r;if(t)return this.settings.hidden?r=this.wrapper:r=this.container,t.appendChild(r),this.element=t,t}getContainer(){return this.container}onResize(e){(!$e(this.settings.width)||!$e(this.settings.height))&&(this.resizeFunc=Sa(e,50),window.addEventListener("resize",this.resizeFunc,!1))}onOrientationChange(e){this.orientationChangeFunc=e,window.addEventListener("orientationchange",this.orientationChangeFunc,!1)}size(e,t){var r;let i=e||this.settings.width,s=t||this.settings.height;e===null?(r=this.element.getBoundingClientRect(),r.width&&(e=Math.floor(r.width),this.container.style.width=e+"px")):$e(e)?this.container.style.width=e+"px":this.container.style.width=e,t===null?(r=r||this.element.getBoundingClientRect(),r.height&&(t=r.height,this.container.style.height=t+"px")):$e(t)?this.container.style.height=t+"px":this.container.style.height=t,$e(e)||(e=this.container.clientWidth),$e(t)||(t=this.container.clientHeight),this.containerStyles=window.getComputedStyle(this.container),this.containerPadding={left:parseFloat(this.containerStyles["padding-left"])||0,right:parseFloat(this.containerStyles["padding-right"])||0,top:parseFloat(this.containerStyles["padding-top"])||0,bottom:parseFloat(this.containerStyles["padding-bottom"])||0};let n=dr(),a=window.getComputedStyle(document.body),l={left:parseFloat(a["padding-left"])||0,right:parseFloat(a["padding-right"])||0,top:parseFloat(a["padding-top"])||0,bottom:parseFloat(a["padding-bottom"])||0};return i||(e=n.width-l.left-l.right),(this.settings.fullsize&&!s||!s)&&(t=n.height-l.top-l.bottom),{width:e-this.containerPadding.left-this.containerPadding.right,height:t-this.containerPadding.top-this.containerPadding.bottom}}bounds(){let e;return this.container.style.overflow!=="visible"&&(e=this.container&&this.container.getBoundingClientRect()),!e||!e.width||!e.height?dr():e}getSheet(){var e=document.createElement("style");return e.appendChild(document.createTextNode("")),document.head.appendChild(e),e.sheet}addStyleRules(e,t){var r="#"+this.id+" ",i="";this.sheet||(this.sheet=this.getSheet()),t.forEach(function(s){for(var n in s)s.hasOwnProperty(n)&&(i+=n+":"+s[n]+";")}),this.sheet.insertRule(r+e+" {"+i+"}",0)}axis(e){e==="horizontal"?(this.container.style.display="flex",this.container.style.flexDirection="row",this.container.style.flexWrap="nowrap"):this.container.style.display="block",this.settings.axis=e}direction(e){this.container&&(this.container.dir=e,this.container.style.direction=e),this.settings.fullsize&&(document.body.style.direction=e),this.settings.dir=e}overflow(e){this.container&&(e==="scroll"&&this.settings.axis==="vertical"?(this.container.style["overflow-y"]=e,this.container.style["overflow-x"]="hidden"):e==="scroll"&&this.settings.axis==="horizontal"?(this.container.style["overflow-y"]="hidden",this.container.style["overflow-x"]=e):this.container.style.overflow=e),this.settings.overflow=e}destroy(){this.element&&(this.settings.hidden?this.wrapper:this.container,this.element.contains(this.container)&&this.element.removeChild(this.container),window.removeEventListener("resize",this.resizeFunc),window.removeEventListener("orientationChange",this.orientationChangeFunc))}}class ka{constructor(e){this.container=e,this._views=[],this.length=0,this.hidden=!1}all(){return this._views}first(){return this._views[0]}last(){return this._views[this._views.length-1]}indexOf(e){return this._views.indexOf(e)}slice(){return this._views.slice.apply(this._views,arguments)}get(e){return this._views[e]}append(e){return this._views.push(e),this.container&&this.container.appendChild(e.element),this.length++,e}prepend(e){return this._views.unshift(e),this.container&&this.container.insertBefore(e.element,this.container.firstChild),this.length++,e}insert(e,t){return this._views.splice(t,0,e),this.container&&(t<this.container.children.length?this.container.insertBefore(e.element,this.container.children[t]):this.container.appendChild(e.element)),this.length++,e}remove(e){var t=this._views.indexOf(e);t>-1&&this._views.splice(t,1),this.destroy(e),this.length--}destroy(e){e.displayed&&e.destroy(),this.container&&this.container.removeChild(e.element),e=null}forEach(){return this._views.forEach.apply(this._views,arguments)}clear(){var e,t=this.length;if(this.length){for(var r=0;r<t;r++)e=this._views[r],this.destroy(e);this._views=[],this.length=0}}find(e){for(var t,r=this.length,i=0;i<r;i++)if(t=this._views[i],t.displayed&&t.section.index==e.index)return t}displayed(){for(var e=[],t,r=this.length,i=0;i<r;i++)t=this._views[i],t.displayed&&e.push(t);return e}show(){for(var e,t=this.length,r=0;r<t;r++)e=this._views[r],e.displayed&&e.show();this.hidden=!1}hide(){for(var e,t=this.length,r=0;r<t;r++)e=this._views[r],e.displayed&&e.hide();this.hidden=!0}}class br{constructor(e){this.name="default",this.optsSettings=e.settings,this.View=e.view,this.request=e.request,this.renditionQueue=e.queue,this.q=new Ei(this),this.settings=ut(this.settings||{},{infinite:!0,hidden:!1,width:void 0,height:void 0,axis:void 0,writingMode:void 0,flow:"scrolled",ignoreClass:"",fullsize:void 0,allowScriptedContent:!1,allowPopups:!1}),ut(this.settings,e.settings||{}),this.viewSettings={ignoreClass:this.settings.ignoreClass,axis:this.settings.axis,flow:this.settings.flow,layout:this.layout,method:this.settings.method,width:0,height:0,forceEvenPages:!0,allowScriptedContent:this.settings.allowScriptedContent,allowPopups:this.settings.allowPopups},this.rendered=!1}render(e,t){let r=e.tagName;typeof this.settings.fullsize>"u"&&r&&(r.toLowerCase()=="body"||r.toLowerCase()=="html")&&(this.settings.fullsize=!0),this.settings.fullsize&&(this.settings.overflow="visible",this.overflow=this.settings.overflow),this.settings.size=t,this.settings.rtlScrollType=da(),this.stage=new Ta({width:t.width,height:t.height,overflow:this.overflow,hidden:this.settings.hidden,axis:this.settings.axis,fullsize:this.settings.fullsize,direction:this.settings.direction}),this.stage.attachTo(e),this.container=this.stage.getContainer(),this.views=new ka(this.container),this._bounds=this.bounds(),this._stageSize=this.stage.size(),this.viewSettings.width=this._stageSize.width,this.viewSettings.height=this._stageSize.height,this.stage.onResize(this.onResized.bind(this)),this.stage.onOrientationChange(this.onOrientationChange.bind(this)),this.addEventListeners(),this.layout&&this.updateLayout(),this.rendered=!0}addEventListeners(){var e;window.addEventListener("unload",(function(t){this.destroy()}).bind(this)),this.settings.fullsize?e=window:e=this.container,this._onScroll=this.onScroll.bind(this),e.addEventListener("scroll",this._onScroll)}removeEventListeners(){var e;this.settings.fullsize?e=window:e=this.container,e.removeEventListener("scroll",this._onScroll),this._onScroll=void 0}destroy(){clearTimeout(this.orientationTimeout),clearTimeout(this.resizeTimeout),clearTimeout(this.afterScrolled),this.clear(),this.removeEventListeners(),this.stage.destroy(),this.rendered=!1}onOrientationChange(e){let{orientation:t}=window;this.optsSettings.resizeOnOrientationChange&&this.resize(),clearTimeout(this.orientationTimeout),this.orientationTimeout=setTimeout((function(){this.orientationTimeout=void 0,this.optsSettings.resizeOnOrientationChange&&this.resize(),this.emit(pe.MANAGERS.ORIENTATION_CHANGE,t)}).bind(this),500)}onResized(e){this.resize()}resize(e,t,r){let i=this.stage.size(e,t);if(this.winBounds=dr(),this.orientationTimeout&&this.winBounds.width===this.winBounds.height){this._stageSize=void 0;return}this._stageSize&&this._stageSize.width===i.width&&this._stageSize.height===i.height||(this._stageSize=i,this._bounds=this.bounds(),this.clear(),this.viewSettings.width=this._stageSize.width,this.viewSettings.height=this._stageSize.height,this.updateLayout(),this.emit(pe.MANAGERS.RESIZED,{width:this._stageSize.width,height:this._stageSize.height},r))}createView(e,t){return new this.View(e,ut(this.viewSettings,{forceRight:t}))}handleNextPrePaginated(e,t,r){let i;if(this.layout.name==="pre-paginated"&&this.layout.divisor>1){if(e||t.index===0)return;if(i=t.next(),i&&!i.properties.includes("page-spread-left"))return r.call(this,i)}}display(e,t){var r=new Fe,i=r.promise;(t===e.href||$e(t))&&(t=void 0);var s=this.views.find(e);if(s&&e&&this.layout.name!=="pre-paginated"){let a=s.offset();if(this.settings.direction==="ltr")this.scrollTo(a.left,a.top,!0);else{let l=s.width();this.scrollTo(a.left+l,a.top,!0)}if(t){let l=s.locationOf(t),f=s.width();this.moveTo(l,f)}return r.resolve(),i}this.clear();let n=!1;return this.layout.name==="pre-paginated"&&this.layout.divisor===2&&e.properties.includes("page-spread-right")&&(n=!0),this.add(e,n).then((function(a){if(t){let l=a.locationOf(t),f=a.width();this.moveTo(l,f)}}).bind(this),a=>{r.reject(a)}).then((function(){return this.handleNextPrePaginated(n,e,this.add)}).bind(this)).then((function(){this.views.show(),r.resolve()}).bind(this)),i}afterDisplayed(e){this.emit(pe.MANAGERS.ADDED,e)}afterResized(e){this.emit(pe.MANAGERS.RESIZE,e.section)}moveTo(e,t){var r=0,i=0;this.isPaginated?(r=Math.floor(e.left/this.layout.delta)*this.layout.delta,r+this.layout.delta>this.container.scrollWidth&&(r=this.container.scrollWidth-this.layout.delta),i=Math.floor(e.top/this.layout.delta)*this.layout.delta,i+this.layout.delta>this.container.scrollHeight&&(i=this.container.scrollHeight-this.layout.delta)):i=e.top,this.settings.direction==="rtl"&&(r=r+this.layout.delta,r=r-t),this.scrollTo(r,i,!0)}add(e,t){var r=this.createView(e,t);return this.views.append(r),r.onDisplayed=this.afterDisplayed.bind(this),r.onResize=this.afterResized.bind(this),r.on(pe.VIEWS.AXIS,i=>{this.updateAxis(i)}),r.on(pe.VIEWS.WRITING_MODE,i=>{this.updateWritingMode(i)}),r.display(this.request)}append(e,t){var r=this.createView(e,t);return this.views.append(r),r.onDisplayed=this.afterDisplayed.bind(this),r.onResize=this.afterResized.bind(this),r.on(pe.VIEWS.AXIS,i=>{this.updateAxis(i)}),r.on(pe.VIEWS.WRITING_MODE,i=>{this.updateWritingMode(i)}),r.display(this.request)}prepend(e,t){var r=this.createView(e,t);return r.on(pe.VIEWS.RESIZED,i=>{this.counter(i)}),this.views.prepend(r),r.onDisplayed=this.afterDisplayed.bind(this),r.onResize=this.afterResized.bind(this),r.on(pe.VIEWS.AXIS,i=>{this.updateAxis(i)}),r.on(pe.VIEWS.WRITING_MODE,i=>{this.updateWritingMode(i)}),r.display(this.request)}counter(e){this.settings.axis==="vertical"?this.scrollBy(0,e.heightDelta,!0):this.scrollBy(e.widthDelta,0,!0)}next(){var e,t;let r=this.settings.direction;if(this.views.length&&(this.isPaginated&&this.settings.axis==="horizontal"&&(!r||r==="ltr")?(this.scrollLeft=this.container.scrollLeft,t=this.container.scrollLeft+this.container.offsetWidth+this.layout.delta,t<=this.container.scrollWidth?this.scrollBy(this.layout.delta,0,!0):e=this.views.last().section.next()):this.isPaginated&&this.settings.axis==="horizontal"&&r==="rtl"?(this.scrollLeft=this.container.scrollLeft,this.settings.rtlScrollType==="default"?(t=this.container.scrollLeft,t>0?this.scrollBy(this.layout.delta,0,!0):e=this.views.last().section.next()):(t=this.container.scrollLeft+this.layout.delta*-1,t>this.container.scrollWidth*-1?this.scrollBy(this.layout.delta,0,!0):e=this.views.last().section.next())):this.isPaginated&&this.settings.axis==="vertical"?(this.scrollTop=this.container.scrollTop,this.container.scrollTop+this.container.offsetHeight<this.container.scrollHeight?this.scrollBy(0,this.layout.height,!0):e=this.views.last().section.next()):e=this.views.last().section.next(),e)){this.clear(),this.updateLayout();let i=!1;return this.layout.name==="pre-paginated"&&this.layout.divisor===2&&e.properties.includes("page-spread-right")&&(i=!0),this.append(e,i).then((function(){return this.handleNextPrePaginated(i,e,this.append)}).bind(this),s=>s).then((function(){!this.isPaginated&&this.settings.axis==="horizontal"&&this.settings.direction==="rtl"&&this.settings.rtlScrollType==="default"&&this.scrollTo(this.container.scrollWidth,0,!0),this.views.show()}).bind(this))}}prev(){var e,t;let r=this.settings.direction;if(this.views.length&&(this.isPaginated&&this.settings.axis==="horizontal"&&(!r||r==="ltr")?(this.scrollLeft=this.container.scrollLeft,t=this.container.scrollLeft,t>0?this.scrollBy(-this.layout.delta,0,!0):e=this.views.first().section.prev()):this.isPaginated&&this.settings.axis==="horizontal"&&r==="rtl"?(this.scrollLeft=this.container.scrollLeft,this.settings.rtlScrollType==="default"?(t=this.container.scrollLeft+this.container.offsetWidth,t<this.container.scrollWidth?this.scrollBy(-this.layout.delta,0,!0):e=this.views.first().section.prev()):(t=this.container.scrollLeft,t<0?this.scrollBy(-this.layout.delta,0,!0):e=this.views.first().section.prev())):this.isPaginated&&this.settings.axis==="vertical"?(this.scrollTop=this.container.scrollTop,this.container.scrollTop>0?this.scrollBy(0,-this.layout.height,!0):e=this.views.first().section.prev()):e=this.views.first().section.prev(),e)){this.clear(),this.updateLayout();let i=!1;return this.layout.name==="pre-paginated"&&this.layout.divisor===2&&typeof e.prev()!="object"&&(i=!0),this.prepend(e,i).then((function(){var s;if(this.layout.name==="pre-paginated"&&this.layout.divisor>1&&(s=e.prev(),s))return this.prepend(s)}).bind(this),s=>s).then((function(){this.isPaginated&&this.settings.axis==="horizontal"&&(this.settings.direction==="rtl"?this.settings.rtlScrollType==="default"?this.scrollTo(0,0,!0):this.scrollTo(this.container.scrollWidth*-1+this.layout.delta,0,!0):this.scrollTo(this.container.scrollWidth-this.layout.delta,0,!0)),this.views.show()}).bind(this))}}current(){var e=this.visible();return e.length?e[e.length-1]:null}clear(){this.views&&(this.views.hide(),this.scrollTo(0,0,!0),this.views.clear())}currentLocation(){return this.updateLayout(),this.isPaginated&&this.settings.axis==="horizontal"?this.location=this.paginatedLocation():this.location=this.scrolledLocation(),this.location}scrolledLocation(){let e=this.visible(),t=this.container.getBoundingClientRect(),r=t.height<window.innerHeight?t.height:window.innerHeight,i=t.width<window.innerWidth?t.width:window.innerWidth,s=this.settings.axis==="vertical";this.settings.direction;let n=0,a=0;return this.settings.fullsize&&(n=s?window.scrollY:window.scrollX),e.map(f=>{let{index:d,href:c}=f.section,b=f.position(),m=f.width(),N=f.height(),w,h,v,g;s?(w=n+t.top-b.top+a,h=w+r-a,g=this.layout.count(N,r).pages,v=r):(w=n+t.left-b.left+a,h=w+i-a,g=this.layout.count(m,i).pages,v=i);let E=Math.ceil(w/v),L=[],y=Math.ceil(h/v);if(this.settings.direction==="rtl"&&!s){let I=E;E=g-y,y=g-I}L=[];for(var S=E;S<=y;S++){let I=S+1;L.push(I)}let R=this.mapping.page(f.contents,f.section.cfiBase,w,h);return{index:d,href:c,pages:L,totalPages:g,mapping:R}})}paginatedLocation(){let e=this.visible(),t=this.container.getBoundingClientRect(),r=0,i=0;return this.settings.fullsize&&(r=window.scrollX),e.map(n=>{let{index:a,href:l}=n.section,f,d=n.position(),c=n.width(),b,m,N;this.settings.direction==="rtl"?(f=t.right-r,N=Math.min(Math.abs(f-d.left),this.layout.width)-i,m=d.width-(d.right-f)-i,b=m-N):(f=t.left+r,N=Math.min(d.right-f,this.layout.width)-i,b=f-d.left+i,m=b+N),i+=N;let w=this.mapping.page(n.contents,n.section.cfiBase,b,m),h=this.layout.count(c).pages,v=Math.floor(b/this.layout.pageWidth),g=[],E=Math.floor(m/this.layout.pageWidth);if(v<0&&(v=0,E=E+1),this.settings.direction==="rtl"){let y=v;v=h-E,E=h-y}for(var L=v+1;L<=E;L++){let y=L;g.push(y)}return{index:a,href:l,pages:g,totalPages:h,mapping:w}})}isVisible(e,t,r,i){var s=e.position(),n=i||this.bounds();return this.settings.axis==="horizontal"&&s.right>n.left-t&&s.left<n.right+r?!0:this.settings.axis==="vertical"&&s.bottom>n.top-t&&s.top<n.bottom+r}visible(){for(var e=this.bounds(),t=this.views.displayed(),r=t.length,i=[],s,n,a=0;a<r;a++)n=t[a],s=this.isVisible(n,0,0,e),s===!0&&i.push(n);return i}scrollBy(e,t,r){let i=this.settings.direction==="rtl"?-1:1;r&&(this.ignore=!0),this.settings.fullsize?window.scrollBy(e*i,t*i):(e&&(this.container.scrollLeft+=e*i),t&&(this.container.scrollTop+=t)),this.scrolled=!0}scrollTo(e,t,r){r&&(this.ignore=!0),this.settings.fullsize?window.scrollTo(e,t):(this.container.scrollLeft=e,this.container.scrollTop=t),this.scrolled=!0}onScroll(){let e,t;this.settings.fullsize?(e=window.scrollY,t=window.scrollX):(e=this.container.scrollTop,t=this.container.scrollLeft),this.scrollTop=e,this.scrollLeft=t,this.ignore?this.ignore=!1:(this.emit(pe.MANAGERS.SCROLL,{top:e,left:t}),clearTimeout(this.afterScrolled),this.afterScrolled=setTimeout((function(){this.emit(pe.MANAGERS.SCROLLED,{top:this.scrollTop,left:this.scrollLeft})}).bind(this),20))}bounds(){var e;return e=this.stage.bounds(),e}applyLayout(e){this.layout=e,this.updateLayout(),this.views&&this.views.length>0&&this.layout.name==="pre-paginated"&&this.display(this.views.first().section)}updateLayout(){this.stage&&(this._stageSize=this.stage.size(),this.isPaginated?(this.layout.calculate(this._stageSize.width,this._stageSize.height,this.settings.gap),this.settings.offset=this.layout.delta/this.layout.divisor):this.layout.calculate(this._stageSize.width,this._stageSize.height),this.viewSettings.width=this.layout.width,this.viewSettings.height=this.layout.height,this.setLayout(this.layout))}setLayout(e){this.viewSettings.layout=e,this.mapping=new mr(e.props,this.settings.direction,this.settings.axis),this.views&&this.views.forEach(function(t){t&&t.setLayout(e)})}updateWritingMode(e){this.writingMode=e}updateAxis(e,t){!t&&e===this.settings.axis||(this.settings.axis=e,this.stage&&this.stage.axis(e),this.viewSettings.axis=e,this.mapping&&(this.mapping=new mr(this.layout.props,this.settings.direction,this.settings.axis)),this.layout&&(e==="vertical"?this.layout.spread("none"):this.layout.spread(this.layout.settings.spread)))}updateFlow(e,t="auto"){let r=e==="paginated"||e==="auto";this.isPaginated=r,e==="scrolled-doc"||e==="scrolled-continuous"||e==="scrolled"?this.updateAxis("vertical"):this.updateAxis("horizontal"),this.viewSettings.flow=e,this.settings.overflow?this.overflow=this.settings.overflow:this.overflow=r?"hidden":t,this.stage&&this.stage.overflow(this.overflow),this.updateLayout()}getContents(){var e=[];return this.views&&this.views.forEach(function(t){const r=t&&t.contents;r&&e.push(r)}),e}direction(e="ltr"){this.settings.direction=e,this.stage&&this.stage.direction(e),this.viewSettings.direction=e,this.updateLayout()}isRendered(){return this.rendered}}St(br.prototype);const Na={easeInCubic:function(x){return Math.pow(x,3)}};class bi{constructor(e,t){this.settings=ut({duration:80,minVelocity:.2,minDistance:10,easing:Na.easeInCubic},t||{}),this.supportsTouch=this.supportsTouch(),this.supportsTouch&&this.setup(e)}setup(e){this.manager=e,this.layout=this.manager.layout,this.fullsize=this.manager.settings.fullsize,this.fullsize?(this.element=this.manager.stage.element,this.scroller=window,this.disableScroll()):(this.element=this.manager.stage.container,this.scroller=this.element,this.element.style.WebkitOverflowScrolling="touch"),this.manager.settings.offset=this.layout.width,this.manager.settings.afterScrolledTimeout=this.settings.duration*2,this.isVertical=this.manager.settings.axis==="vertical",!(!this.manager.isPaginated||this.isVertical)&&(this.touchCanceler=!1,this.resizeCanceler=!1,this.snapping=!1,this.scrollLeft,this.scrollTop,this.startTouchX=void 0,this.startTouchY=void 0,this.startTime=void 0,this.endTouchX=void 0,this.endTouchY=void 0,this.endTime=void 0,this.addListeners())}supportsTouch(){return!!("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch)}disableScroll(){this.element.style.overflow="hidden"}enableScroll(){this.element.style.overflow=""}addListeners(){this._onResize=this.onResize.bind(this),window.addEventListener("resize",this._onResize),this._onScroll=this.onScroll.bind(this),this.scroller.addEventListener("scroll",this._onScroll),this._onTouchStart=this.onTouchStart.bind(this),this.scroller.addEventListener("touchstart",this._onTouchStart,{passive:!0}),this.on("touchstart",this._onTouchStart),this._onTouchMove=this.onTouchMove.bind(this),this.scroller.addEventListener("touchmove",this._onTouchMove,{passive:!0}),this.on("touchmove",this._onTouchMove),this._onTouchEnd=this.onTouchEnd.bind(this),this.scroller.addEventListener("touchend",this._onTouchEnd,{passive:!0}),this.on("touchend",this._onTouchEnd),this._afterDisplayed=this.afterDisplayed.bind(this),this.manager.on(pe.MANAGERS.ADDED,this._afterDisplayed)}removeListeners(){window.removeEventListener("resize",this._onResize),this._onResize=void 0,this.scroller.removeEventListener("scroll",this._onScroll),this._onScroll=void 0,this.scroller.removeEventListener("touchstart",this._onTouchStart,{passive:!0}),this.off("touchstart",this._onTouchStart),this._onTouchStart=void 0,this.scroller.removeEventListener("touchmove",this._onTouchMove,{passive:!0}),this.off("touchmove",this._onTouchMove),this._onTouchMove=void 0,this.scroller.removeEventListener("touchend",this._onTouchEnd,{passive:!0}),this.off("touchend",this._onTouchEnd),this._onTouchEnd=void 0,this.manager.off(pe.MANAGERS.ADDED,this._afterDisplayed),this._afterDisplayed=void 0}afterDisplayed(e){let t=e.contents;["touchstart","touchmove","touchend"].forEach(r=>{t.on(r,i=>this.triggerViewEvent(i,t))})}triggerViewEvent(e,t){this.emit(e.type,e,t)}onScroll(e){this.scrollLeft=this.fullsize?window.scrollX:this.scroller.scrollLeft,this.scrollTop=this.fullsize?window.scrollY:this.scroller.scrollTop}onResize(e){this.resizeCanceler=!0}onTouchStart(e){let{screenX:t,screenY:r}=e.touches[0];this.fullsize&&this.enableScroll(),this.touchCanceler=!0,this.startTouchX||(this.startTouchX=t,this.startTouchY=r,this.startTime=this.now()),this.endTouchX=t,this.endTouchY=r,this.endTime=this.now()}onTouchMove(e){let{screenX:t,screenY:r}=e.touches[0],i=Math.abs(r-this.endTouchY);this.touchCanceler=!0,!this.fullsize&&i<10&&(this.element.scrollLeft-=t-this.endTouchX),this.endTouchX=t,this.endTouchY=r,this.endTime=this.now()}onTouchEnd(e){this.fullsize&&this.disableScroll(),this.touchCanceler=!1;let t=this.wasSwiped();t!==0?this.snap(t):this.snap(),this.startTouchX=void 0,this.startTouchY=void 0,this.startTime=void 0,this.endTouchX=void 0,this.endTouchY=void 0,this.endTime=void 0}wasSwiped(){let e=this.layout.pageWidth*this.layout.divisor,t=this.endTouchX-this.startTouchX,r=Math.abs(t),i=this.endTime-this.startTime,s=t/i,n=this.settings.minVelocity;if(r<=this.settings.minDistance||r>=e)return 0;if(s>n)return-1;if(s<-n)return 1}needsSnap(){let e=this.scrollLeft,t=this.layout.pageWidth*this.layout.divisor;return e%t!==0}snap(e=0){let t=this.scrollLeft,r=this.layout.pageWidth*this.layout.divisor,i=Math.round(t/r)*r;return e&&(i+=e*r),this.smoothScrollTo(i)}smoothScrollTo(e){const t=new Fe,r=this.scrollLeft,i=this.now(),s=this.settings.duration,n=this.settings.easing;this.snapping=!0;function a(){const l=this.now(),f=Math.min(1,(l-i)/s);if(n(f),this.touchCanceler||this.resizeCanceler){this.resizeCanceler=!1,this.snapping=!1,t.resolve();return}f<1?(window.requestAnimationFrame(a.bind(this)),this.scrollTo(r+(e-r)*f,0)):(this.scrollTo(e,0),this.snapping=!1,t.resolve())}return a.call(this),t.promise}scrollTo(e=0,t=0){this.fullsize?window.scroll(e,t):(this.scroller.scrollLeft=e,this.scroller.scrollTop=t)}now(){return"now"in window.performance?performance.now():new Date().getTime()}destroy(){this.scroller&&(this.fullsize&&this.enableScroll(),this.removeListeners(),this.scroller=void 0)}}St(bi.prototype);var Ra=es();const Ia=Zt(Ra);class Oa extends br{constructor(e){super(e),this.name="continuous",this.settings=ut(this.settings||{},{infinite:!0,overflow:void 0,axis:void 0,writingMode:void 0,flow:"scrolled",offset:500,offsetDelta:250,width:void 0,height:void 0,snap:!1,afterScrolledTimeout:10,allowScriptedContent:!1,allowPopups:!1}),ut(this.settings,e.settings||{}),e.settings.gap!="undefined"&&e.settings.gap===0&&(this.settings.gap=e.settings.gap),this.viewSettings={ignoreClass:this.settings.ignoreClass,axis:this.settings.axis,flow:this.settings.flow,layout:this.layout,width:0,height:0,forceEvenPages:!1,allowScriptedContent:this.settings.allowScriptedContent,allowPopups:this.settings.allowPopups},this.scrollTop=0,this.scrollLeft=0}display(e,t){return br.prototype.display.call(this,e,t).then((function(){return this.fill()}).bind(this))}fill(e){var t=e||new Fe;return this.q.enqueue(()=>this.check()).then(r=>{r?this.fill(t):t.resolve()}),t.promise}moveTo(e){var t=0,r=0;this.isPaginated?(t=Math.floor(e.left/this.layout.delta)*this.layout.delta,t+this.settings.offsetDelta):(r=e.top,e.top+this.settings.offsetDelta),(t>0||r>0)&&this.scrollBy(t,r,!0)}afterResized(e){this.emit(pe.MANAGERS.RESIZE,e.section)}removeShownListeners(e){e.onDisplayed=function(){}}add(e){var t=this.createView(e);return this.views.append(t),t.on(pe.VIEWS.RESIZED,r=>{t.expanded=!0}),t.on(pe.VIEWS.AXIS,r=>{this.updateAxis(r)}),t.on(pe.VIEWS.WRITING_MODE,r=>{this.updateWritingMode(r)}),t.onDisplayed=this.afterDisplayed.bind(this),t.onResize=this.afterResized.bind(this),t.display(this.request)}append(e){var t=this.createView(e);return t.on(pe.VIEWS.RESIZED,r=>{t.expanded=!0}),t.on(pe.VIEWS.AXIS,r=>{this.updateAxis(r)}),t.on(pe.VIEWS.WRITING_MODE,r=>{this.updateWritingMode(r)}),this.views.append(t),t.onDisplayed=this.afterDisplayed.bind(this),t}prepend(e){var t=this.createView(e);return t.on(pe.VIEWS.RESIZED,r=>{this.counter(r),t.expanded=!0}),t.on(pe.VIEWS.AXIS,r=>{this.updateAxis(r)}),t.on(pe.VIEWS.WRITING_MODE,r=>{this.updateWritingMode(r)}),this.views.prepend(t),t.onDisplayed=this.afterDisplayed.bind(this),t}counter(e){this.settings.axis==="vertical"?this.scrollBy(0,e.heightDelta,!0):this.scrollBy(e.widthDelta,0,!0)}update(e){for(var t=this.bounds(),r=this.views.all(),i=r.length,s=typeof e<"u"?e:this.settings.offset||0,n,a,l=new Fe,f=[],d=0;d<i;d++)if(a=r[d],n=this.isVisible(a,s,s,t),n===!0)if(a.displayed)a.show();else{let c=a.display(this.request).then(function(b){b.show()},b=>{a.hide()});f.push(c)}else this.q.enqueue(a.destroy.bind(a)),clearTimeout(this.trimTimeout),this.trimTimeout=setTimeout((function(){this.q.enqueue(this.trim.bind(this))}).bind(this),250);return f.length?Promise.all(f).catch(c=>{l.reject(c)}):(l.resolve(),l.promise)}check(e,t){var r=new Fe,i=[],s=this.settings.axis==="horizontal",n=this.settings.offset||0;e&&s&&(n=e),t&&!s&&(n=t);var a=this._bounds;let l=s?this.scrollLeft:this.scrollTop,f=s?Math.floor(a.width):a.height,d=s?this.container.scrollWidth:this.container.scrollHeight,c=this.writingMode&&this.writingMode.indexOf("vertical")===0?"vertical":"horizontal",b=this.settings.rtlScrollType,m=this.settings.direction==="rtl";this.settings.fullsize?(s&&m&&b==="negative"||!s&&m&&b==="default")&&(l=l*-1):(m&&b==="default"&&c==="horizontal"&&(l=d-f-l),m&&b==="negative"&&c==="horizontal"&&(l=l*-1));let N=()=>{let E=this.views.first(),L=E&&E.section.prev();L&&i.push(this.prepend(L))},w=()=>{let E=this.views.last(),L=E&&E.section.next();L&&i.push(this.append(L))},h=l+f+n,v=l-n;h>=d&&w(),v<0&&N();let g=i.map(E=>E.display(this.request));return i.length?Promise.all(g).then(()=>this.check()).then(()=>this.update(n),E=>E):(this.q.enqueue((function(){this.update()}).bind(this)),r.resolve(!1),r.promise)}trim(){for(var e=new Fe,t=this.views.displayed(),r=t[0],i=t[t.length-1],s=this.views.indexOf(r),n=this.views.indexOf(i),a=this.views.slice(0,s),l=this.views.slice(n+1),f=0;f<a.length-1;f++)this.erase(a[f],a);for(var d=1;d<l.length;d++)this.erase(l[d]);return e.resolve(),e.promise}erase(e,t){var r,i;this.settings.fullsize?(r=window.scrollY,i=window.scrollX):(r=this.container.scrollTop,i=this.container.scrollLeft);var s=e.bounds();this.views.remove(e),t&&(this.settings.axis==="vertical"?this.scrollTo(0,r-s.height,!0):this.settings.direction==="rtl"?this.settings.fullsize?this.scrollTo(i+Math.floor(s.width),0,!0):this.scrollTo(i,0,!0):this.scrollTo(i-Math.floor(s.width),0,!0))}addEventListeners(e){window.addEventListener("unload",(function(t){this.ignore=!0,this.destroy()}).bind(this)),this.addScrollListeners(),this.isPaginated&&this.settings.snap&&(this.snapper=new bi(this,this.settings.snap&&typeof this.settings.snap=="object"&&this.settings.snap))}addScrollListeners(){var e;this.tick=wi;let t=this.settings.direction==="rtl"&&this.settings.rtlScrollType==="default"?-1:1;this.scrollDeltaVert=0,this.scrollDeltaHorz=0,this.settings.fullsize?(e=window,this.scrollTop=window.scrollY*t,this.scrollLeft=window.scrollX*t):(e=this.container,this.scrollTop=this.container.scrollTop,this.scrollLeft=this.container.scrollLeft),this._onScroll=this.onScroll.bind(this),e.addEventListener("scroll",this._onScroll),this._scrolled=Ia(this.scrolled.bind(this),30),this.didScroll=!1}removeEventListeners(){var e;this.settings.fullsize?e=window:e=this.container,e.removeEventListener("scroll",this._onScroll),this._onScroll=void 0}onScroll(){let e,t,r=this.settings.direction==="rtl"&&this.settings.rtlScrollType==="default"?-1:1;this.settings.fullsize?(e=window.scrollY*r,t=window.scrollX*r):(e=this.container.scrollTop,t=this.container.scrollLeft),this.scrollTop=e,this.scrollLeft=t,this.ignore?this.ignore=!1:this._scrolled(),this.scrollDeltaVert+=Math.abs(e-this.prevScrollTop),this.scrollDeltaHorz+=Math.abs(t-this.prevScrollLeft),this.prevScrollTop=e,this.prevScrollLeft=t,clearTimeout(this.scrollTimeout),this.scrollTimeout=setTimeout((function(){this.scrollDeltaVert=0,this.scrollDeltaHorz=0}).bind(this),150),clearTimeout(this.afterScrolled),this.didScroll=!1}scrolled(){this.q.enqueue((function(){return this.check()}).bind(this)),this.emit(pe.MANAGERS.SCROLL,{top:this.scrollTop,left:this.scrollLeft}),clearTimeout(this.afterScrolled),this.afterScrolled=setTimeout((function(){this.snapper&&this.snapper.supportsTouch&&this.snapper.needsSnap()||this.emit(pe.MANAGERS.SCROLLED,{top:this.scrollTop,left:this.scrollLeft})}).bind(this),this.settings.afterScrolledTimeout)}next(){let e=this.layout.props.name==="pre-paginated"&&this.layout.props.spread?this.layout.props.delta*2:this.layout.props.delta;this.views.length&&(this.isPaginated&&this.settings.axis==="horizontal"?this.scrollBy(e,0,!0):this.scrollBy(0,this.layout.height,!0),this.q.enqueue((function(){return this.check()}).bind(this)))}prev(){let e=this.layout.props.name==="pre-paginated"&&this.layout.props.spread?this.layout.props.delta*2:this.layout.props.delta;this.views.length&&(this.isPaginated&&this.settings.axis==="horizontal"?this.scrollBy(-e,0,!0):this.scrollBy(0,-this.layout.height,!0),this.q.enqueue((function(){return this.check()}).bind(this)))}updateFlow(e){this.rendered&&this.snapper&&(this.snapper.destroy(),this.snapper=void 0),super.updateFlow(e,"scroll"),this.rendered&&this.isPaginated&&this.settings.snap&&(this.snapper=new bi(this,this.settings.snap&&typeof this.settings.snap=="object"&&this.settings.snap))}destroy(){super.destroy(),this.snapper&&this.snapper.destroy()}}class Ci{constructor(e,t){this.settings=ut(this.settings||{},{width:null,height:null,ignoreClass:"",manager:"default",view:"iframe",flow:null,layout:null,spread:null,minSpreadWidth:800,stylesheet:null,resizeOnOrientationChange:!0,script:null,snap:!1,defaultDirection:"ltr",allowScriptedContent:!1,allowPopups:!1}),ut(this.settings,t),typeof this.settings.manager=="object"&&(this.manager=this.settings.manager),this.book=e,this.hooks={},this.hooks.display=new At(this),this.hooks.serialize=new At(this),this.hooks.content=new At(this),this.hooks.unloaded=new At(this),this.hooks.layout=new At(this),this.hooks.render=new At(this),this.hooks.show=new At(this),this.hooks.content.register(this.handleLinks.bind(this)),this.hooks.content.register(this.passEvents.bind(this)),this.hooks.content.register(this.adjustImages.bind(this)),this.book.spine.hooks.content.register(this.injectIdentifier.bind(this)),this.settings.stylesheet&&this.book.spine.hooks.content.register(this.injectStylesheet.bind(this)),this.settings.script&&this.book.spine.hooks.content.register(this.injectScript.bind(this)),this.themes=new aa(this),this.annotations=new la(this),this.epubcfi=new Pe,this.q=new Ei(this),this.location=void 0,this.q.enqueue(this.book.opened),this.starting=new Fe,this.started=this.starting.promise,this.q.enqueue(this.start)}setManager(e){this.manager=e}requireManager(e){var t;return typeof e=="string"&&e==="default"?t=br:typeof e=="string"&&e==="continuous"?t=Oa:t=e,t}requireView(e){var t;return typeof e=="string"&&e==="iframe"?t=Kn:t=e,t}start(){switch(!this.settings.layout&&(this.book.package.metadata.layout==="pre-paginated"||this.book.displayOptions.fixedLayout==="true")&&(this.settings.layout="pre-paginated"),this.book.package.metadata.spread){case"none":this.settings.spread="none";break;case"both":this.settings.spread=!0;break}this.manager||(this.ViewManager=this.requireManager(this.settings.manager),this.View=this.requireView(this.settings.view),this.manager=new this.ViewManager({view:this.View,queue:this.q,request:this.book.load.bind(this.book),settings:this.settings})),this.direction(this.book.package.metadata.direction||this.settings.defaultDirection),this.settings.globalLayoutProperties=this.determineLayoutProperties(this.book.package.metadata),this.flow(this.settings.globalLayoutProperties.flow),this.layout(this.settings.globalLayoutProperties),this.manager.on(pe.MANAGERS.ADDED,this.afterDisplayed.bind(this)),this.manager.on(pe.MANAGERS.REMOVED,this.afterRemoved.bind(this)),this.manager.on(pe.MANAGERS.RESIZED,this.onResized.bind(this)),this.manager.on(pe.MANAGERS.ORIENTATION_CHANGE,this.onOrientationChange.bind(this)),this.manager.on(pe.MANAGERS.SCROLLED,this.reportLocation.bind(this)),this.emit(pe.RENDITION.STARTED),this.starting.resolve()}attachTo(e){return this.q.enqueue((function(){this.manager.render(e,{width:this.settings.width,height:this.settings.height}),this.emit(pe.RENDITION.ATTACHED)}).bind(this))}display(e){return this.displaying&&this.displaying.resolve(),this.q.enqueue(this._display,e)}_display(e){if(this.book){this.epubcfi.isCfiString(e);var t=new Fe,r=t.promise,i;return this.displaying=t,this.book.locations.length()&&Pn(e)&&(e=this.book.locations.cfiFromPercentage(parseFloat(e))),i=this.book.spine.get(e),i?(this.manager.display(i,e).then(()=>{t.resolve(i),this.displaying=void 0,this.emit(pe.RENDITION.DISPLAYED,i),this.reportLocation()},s=>{this.emit(pe.RENDITION.DISPLAY_ERROR,s)}),r):(t.reject(new Error("No Section Found")),r)}}afterDisplayed(e){e.on(pe.VIEWS.MARK_CLICKED,(t,r)=>this.triggerMarkEvent(t,r,e.contents)),this.hooks.render.trigger(e,this).then(()=>{e.contents?this.hooks.content.trigger(e.contents,this).then(()=>{this.emit(pe.RENDITION.RENDERED,e.section,e)}):this.emit(pe.RENDITION.RENDERED,e.section,e)})}afterRemoved(e){this.hooks.unloaded.trigger(e,this).then(()=>{this.emit(pe.RENDITION.REMOVED,e.section,e)})}onResized(e,t){this.emit(pe.RENDITION.RESIZED,{width:e.width,height:e.height},t),this.location&&this.location.start&&this.display(t||this.location.start.cfi)}onOrientationChange(e){this.emit(pe.RENDITION.ORIENTATION_CHANGE,e)}moveTo(e){this.manager.moveTo(e)}resize(e,t,r){e&&(this.settings.width=e),t&&(this.settings.height=t),this.manager.resize(e,t,r)}clear(){this.manager.clear()}next(){return this.q.enqueue(this.manager.next.bind(this.manager)).then(this.reportLocation.bind(this))}prev(){return this.q.enqueue(this.manager.prev.bind(this.manager)).then(this.reportLocation.bind(this))}determineLayoutProperties(e){var t,r=this.settings.layout||e.layout||"reflowable",i=this.settings.spread||e.spread||"auto",s=this.settings.orientation||e.orientation||"auto",n=this.settings.flow||e.flow||"auto",a=e.viewport||"",l=this.settings.minSpreadWidth||e.minSpreadWidth||800,f=this.settings.direction||e.direction||"ltr";return(this.settings.width===0||this.settings.width>0)&&(this.settings.height===0||this.settings.height>0),t={layout:r,spread:i,orientation:s,flow:n,viewport:a,minSpreadWidth:l,direction:f},t}flow(e){var t=e;(e==="scrolled"||e==="scrolled-doc"||e==="scrolled-continuous")&&(t="scrolled"),(e==="auto"||e==="paginated")&&(t="paginated"),this.settings.flow=e,this._layout&&this._layout.flow(t),this.manager&&this._layout&&this.manager.applyLayout(this._layout),this.manager&&this.manager.updateFlow(t),this.manager&&this.manager.isRendered()&&this.location&&(this.manager.clear(),this.display(this.location.start.cfi))}layout(e){return e&&(this._layout=new Xn(e),this._layout.spread(e.spread,this.settings.minSpreadWidth),this._layout.on(pe.LAYOUT.UPDATED,(t,r)=>{this.emit(pe.RENDITION.LAYOUT,t,r)})),this.manager&&this._layout&&this.manager.applyLayout(this._layout),this._layout}spread(e,t){this.settings.spread=e,t&&(this.settings.minSpreadWidth=t),this._layout&&this._layout.spread(e,t),this.manager&&this.manager.isRendered()&&this.manager.updateLayout()}direction(e){this.settings.direction=e||"ltr",this.manager&&this.manager.direction(this.settings.direction),this.manager&&this.manager.isRendered()&&this.location&&(this.manager.clear(),this.display(this.location.start.cfi))}reportLocation(){return this.q.enqueue((function(){requestAnimationFrame((function(){var r=this.manager.currentLocation();if(r&&r.then&&typeof r.then=="function")r.then((function(i){let s=this.located(i);!s||!s.start||!s.end||(this.location=s,this.emit(pe.RENDITION.LOCATION_CHANGED,{index:this.location.start.index,href:this.location.start.href,start:this.location.start.cfi,end:this.location.end.cfi,percentage:this.location.start.percentage}),this.emit(pe.RENDITION.RELOCATED,this.location))}).bind(this));else if(r){let i=this.located(r);if(!i||!i.start||!i.end)return;this.location=i,this.emit(pe.RENDITION.LOCATION_CHANGED,{index:this.location.start.index,href:this.location.start.href,start:this.location.start.cfi,end:this.location.end.cfi,percentage:this.location.start.percentage}),this.emit(pe.RENDITION.RELOCATED,this.location)}}).bind(this))}).bind(this))}currentLocation(){var e=this.manager.currentLocation();if(e&&e.then&&typeof e.then=="function")e.then((function(t){return this.located(t)}).bind(this));else if(e)return this.located(e)}located(e){if(!e.length)return{};let t=e[0],r=e[e.length-1],i={start:{index:t.index,href:t.href,cfi:t.mapping.start,displayed:{page:t.pages[0]||1,total:t.totalPages}},end:{index:r.index,href:r.href,cfi:r.mapping.end,displayed:{page:r.pages[r.pages.length-1]||1,total:r.totalPages}}},s=this.book.locations.locationFromCfi(t.mapping.start),n=this.book.locations.locationFromCfi(r.mapping.end);s!=null&&(i.start.location=s,i.start.percentage=this.book.locations.percentageFromLocation(s)),n!=null&&(i.end.location=n,i.end.percentage=this.book.locations.percentageFromLocation(n));let a=this.book.pageList.pageFromCfi(t.mapping.start),l=this.book.pageList.pageFromCfi(r.mapping.end);return a!=-1&&(i.start.page=a),l!=-1&&(i.end.page=l),r.index===this.book.spine.last().index&&i.end.displayed.page>=i.end.displayed.total&&(i.atEnd=!0),t.index===this.book.spine.first().index&&i.start.displayed.page===1&&(i.atStart=!0),i}destroy(){this.manager&&this.manager.destroy(),this.book=void 0}passEvents(e){hr.forEach(t=>{e.on(t,r=>this.triggerViewEvent(r,e))}),e.on(pe.CONTENTS.SELECTED,t=>this.triggerSelectedEvent(t,e))}triggerViewEvent(e,t){this.emit(e.type,e,t)}triggerSelectedEvent(e,t){this.emit(pe.RENDITION.SELECTED,e,t)}triggerMarkEvent(e,t,r){this.emit(pe.RENDITION.MARK_CLICKED,e,t,r)}getRange(e,t){var r=new Pe(e),i=this.manager.visible().filter(function(s){if(r.spinePos===s.index)return!0});if(i.length)return i[0].contents.range(r,t)}adjustImages(e){if(this._layout.name==="pre-paginated")return new Promise(function(s){s()});let t=e.window.getComputedStyle(e.content,null),r=(e.content.offsetHeight-(parseFloat(t.paddingTop)+parseFloat(t.paddingBottom)))*.95,i=parseFloat(t.paddingLeft)+parseFloat(t.paddingRight);return e.addStylesheetRules({img:{"max-width":(this._layout.columnWidth?this._layout.columnWidth-i+"px":"100%")+"!important","max-height":r+"px!important","object-fit":"contain","page-break-inside":"avoid","break-inside":"avoid","box-sizing":"border-box"},svg:{"max-width":(this._layout.columnWidth?this._layout.columnWidth-i+"px":"100%")+"!important","max-height":r+"px!important","page-break-inside":"avoid","break-inside":"avoid"}}),new Promise(function(s,n){setTimeout(function(){s()},1)})}getContents(){return this.manager?this.manager.getContents():[]}views(){return(this.manager?this.manager.views:void 0)||[]}handleLinks(e){e&&e.on(pe.CONTENTS.LINK_CLICKED,t=>{let r=this.book.path.relative(t);this.display(r)})}injectStylesheet(e,t){let r=e.createElement("link");r.setAttribute("type","text/css"),r.setAttribute("rel","stylesheet"),r.setAttribute("href",this.settings.stylesheet),e.getElementsByTagName("head")[0].appendChild(r)}injectScript(e,t){let r=e.createElement("script");r.setAttribute("type","text/javascript"),r.setAttribute("src",this.settings.script),r.textContent=" ",e.getElementsByTagName("head")[0].appendChild(r)}injectIdentifier(e,t){let r=this.book.packaging.metadata.identifier,i=e.createElement("meta");i.setAttribute("name","dc.relation.ispartof"),r&&i.setAttribute("content",r),e.getElementsByTagName("head")[0].appendChild(i)}}St(Ci.prototype);function Ot(x){throw new Error('Could not dynamically require "'+x+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var fi={exports:{}};var Tn;function La(){return Tn||(Tn=1,(function(x,e){(function(t){x.exports=t()})(function(){return(function t(r,i,s){function n(f,d){if(!i[f]){if(!r[f]){var c=typeof Ot=="function"&&Ot;if(!d&&c)return c(f,!0);if(a)return a(f,!0);var b=new Error("Cannot find module '"+f+"'");throw b.code="MODULE_NOT_FOUND",b}var m=i[f]={exports:{}};r[f][0].call(m.exports,function(N){var w=r[f][1][N];return n(w||N)},m,m.exports,t,r,i,s)}return i[f].exports}for(var a=typeof Ot=="function"&&Ot,l=0;l<s.length;l++)n(s[l]);return n})({1:[function(t,r,i){var s=t("./utils"),n=t("./support"),a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";i.encode=function(l){for(var f=[],d,c,b,m,N,w,h,v=0,g=l.length,E=g,L=s.getTypeOf(l)!=="string";v<l.length;)E=g-v,L?(d=l[v++],c=v<g?l[v++]:0,b=v<g?l[v++]:0):(d=l.charCodeAt(v++),c=v<g?l.charCodeAt(v++):0,b=v<g?l.charCodeAt(v++):0),m=d>>2,N=(d&3)<<4|c>>4,w=E>1?(c&15)<<2|b>>6:64,h=E>2?b&63:64,f.push(a.charAt(m)+a.charAt(N)+a.charAt(w)+a.charAt(h));return f.join("")},i.decode=function(l){var f,d,c,b,m,N,w,h=0,v=0,g="data:";if(l.substr(0,g.length)===g)throw new Error("Invalid base64 input, it looks like a data url.");l=l.replace(/[^A-Za-z0-9+/=]/g,"");var E=l.length*3/4;if(l.charAt(l.length-1)===a.charAt(64)&&E--,l.charAt(l.length-2)===a.charAt(64)&&E--,E%1!==0)throw new Error("Invalid base64 input, bad content length.");var L;for(n.uint8array?L=new Uint8Array(E|0):L=new Array(E|0);h<l.length;)b=a.indexOf(l.charAt(h++)),m=a.indexOf(l.charAt(h++)),N=a.indexOf(l.charAt(h++)),w=a.indexOf(l.charAt(h++)),f=b<<2|m>>4,d=(m&15)<<4|N>>2,c=(N&3)<<6|w,L[v++]=f,N!==64&&(L[v++]=d),w!==64&&(L[v++]=c);return L}},{"./support":30,"./utils":32}],2:[function(t,r,i){var s=t("./external"),n=t("./stream/DataWorker"),a=t("./stream/Crc32Probe"),l=t("./stream/DataLengthProbe");function f(d,c,b,m,N){this.compressedSize=d,this.uncompressedSize=c,this.crc32=b,this.compression=m,this.compressedContent=N}f.prototype={getContentWorker:function(){var d=new n(s.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new l("data_length")),c=this;return d.on("end",function(){if(this.streamInfo.data_length!==c.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),d},getCompressedWorker:function(){return new n(s.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},f.createWorkerFrom=function(d,c,b){return d.pipe(new a).pipe(new l("uncompressedSize")).pipe(c.compressWorker(b)).pipe(new l("compressedSize")).withStreamInfo("compression",c)},r.exports=f},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(t,r,i){var s=t("./stream/GenericWorker");i.STORE={magic:"\0\0",compressWorker:function(){return new s("STORE compression")},uncompressWorker:function(){return new s("STORE decompression")}},i.DEFLATE=t("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(t,r,i){var s=t("./utils");function n(){for(var d,c=[],b=0;b<256;b++){d=b;for(var m=0;m<8;m++)d=d&1?3988292384^d>>>1:d>>>1;c[b]=d}return c}var a=n();function l(d,c,b,m){var N=a,w=m+b;d=d^-1;for(var h=m;h<w;h++)d=d>>>8^N[(d^c[h])&255];return d^-1}function f(d,c,b,m){var N=a,w=m+b;d=d^-1;for(var h=m;h<w;h++)d=d>>>8^N[(d^c.charCodeAt(h))&255];return d^-1}r.exports=function(c,b){if(typeof c>"u"||!c.length)return 0;var m=s.getTypeOf(c)!=="string";return m?l(b|0,c,c.length,0):f(b|0,c,c.length,0)}},{"./utils":32}],5:[function(t,r,i){i.base64=!1,i.binary=!1,i.dir=!1,i.createFolders=!0,i.date=null,i.compression=null,i.compressionOptions=null,i.comment=null,i.unixPermissions=null,i.dosPermissions=null},{}],6:[function(t,r,i){var s=null;typeof Promise<"u"?s=Promise:s=t("lie"),r.exports={Promise:s}},{lie:37}],7:[function(t,r,i){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",n=t("pako"),a=t("./utils"),l=t("./stream/GenericWorker"),f=s?"uint8array":"array";i.magic="\b\0";function d(c,b){l.call(this,"FlateWorker/"+c),this._pako=null,this._pakoAction=c,this._pakoOptions=b,this.meta={}}a.inherits(d,l),d.prototype.processChunk=function(c){this.meta=c.meta,this._pako===null&&this._createPako(),this._pako.push(a.transformTo(f,c.data),!1)},d.prototype.flush=function(){l.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},d.prototype.cleanUp=function(){l.prototype.cleanUp.call(this),this._pako=null},d.prototype._createPako=function(){this._pako=new n[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var c=this;this._pako.onData=function(b){c.push({data:b,meta:c.meta})}},i.compressWorker=function(c){return new d("Deflate",c)},i.uncompressWorker=function(){return new d("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(t,r,i){var s=t("../utils"),n=t("../stream/GenericWorker"),a=t("../utf8"),l=t("../crc32"),f=t("../signature"),d=function(v,g){var E="",L;for(L=0;L<g;L++)E+=String.fromCharCode(v&255),v=v>>>8;return E},c=function(v,g){var E=v;return v||(E=g?16893:33204),(E&65535)<<16},b=function(v){return(v||0)&63},m=function(v,g,E,L,y,S){var R=v.file,I=v.compression,k=S!==a.utf8encode,O=s.transformTo("string",S(R.name)),H=s.transformTo("string",a.utf8encode(R.name)),j=R.comment,Z=s.transformTo("string",S(j)),K=s.transformTo("string",a.utf8encode(j)),J=H.length!==R.name.length,he=K.length!==j.length,Q,Y,ae="",ye="",re="",ce=R.dir,Te=R.date,xe={crc32:0,compressedSize:0,uncompressedSize:0};(!g||E)&&(xe.crc32=v.crc32,xe.compressedSize=v.compressedSize,xe.uncompressedSize=v.uncompressedSize);var Ne=0;g&&(Ne|=8),!k&&(J||he)&&(Ne|=2048);var je=0,ze=0;ce&&(je|=16),y==="UNIX"?(ze=798,je|=c(R.unixPermissions,ce)):(ze=20,je|=b(R.dosPermissions)),Q=Te.getUTCHours(),Q=Q<<6,Q=Q|Te.getUTCMinutes(),Q=Q<<5,Q=Q|Te.getUTCSeconds()/2,Y=Te.getUTCFullYear()-1980,Y=Y<<4,Y=Y|Te.getUTCMonth()+1,Y=Y<<5,Y=Y|Te.getUTCDate(),J&&(ye=d(1,1)+d(l(O),4)+H,ae+="up"+d(ye.length,2)+ye),he&&(re=d(1,1)+d(l(Z),4)+K,ae+="uc"+d(re.length,2)+re);var we="";we+=`
\0`,we+=d(Ne,2),we+=I.magic,we+=d(Q,2),we+=d(Y,2),we+=d(xe.crc32,4),we+=d(xe.compressedSize,4),we+=d(xe.uncompressedSize,4),we+=d(O.length,2),we+=d(ae.length,2);var Me=f.LOCAL_FILE_HEADER+we+O+ae,oe=f.CENTRAL_FILE_HEADER+d(ze,2)+we+d(Z.length,2)+"\0\0\0\0"+d(je,4)+d(L,4)+O+ae+Z;return{fileRecord:Me,dirRecord:oe}},N=function(v,g,E,L,y){var S="",R=s.transformTo("string",y(L));return S=f.CENTRAL_DIRECTORY_END+"\0\0\0\0"+d(v,2)+d(v,2)+d(g,4)+d(E,4)+d(R.length,2)+R,S},w=function(v){var g="";return g=f.DATA_DESCRIPTOR+d(v.crc32,4)+d(v.compressedSize,4)+d(v.uncompressedSize,4),g};function h(v,g,E,L){n.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=g,this.zipPlatform=E,this.encodeFileName=L,this.streamFiles=v,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}s.inherits(h,n),h.prototype.push=function(v){var g=v.meta.percent||0,E=this.entriesCount,L=this._sources.length;this.accumulate?this.contentBuffer.push(v):(this.bytesWritten+=v.data.length,n.prototype.push.call(this,{data:v.data,meta:{currentFile:this.currentFile,percent:E?(g+100*(E-L-1))/E:100}}))},h.prototype.openedSource=function(v){this.currentSourceOffset=this.bytesWritten,this.currentFile=v.file.name;var g=this.streamFiles&&!v.file.dir;if(g){var E=m(v,g,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:E.fileRecord,meta:{percent:0}})}else this.accumulate=!0},h.prototype.closedSource=function(v){this.accumulate=!1;var g=this.streamFiles&&!v.file.dir,E=m(v,g,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(E.dirRecord),g)this.push({data:w(v),meta:{percent:100}});else for(this.push({data:E.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},h.prototype.flush=function(){for(var v=this.bytesWritten,g=0;g<this.dirRecords.length;g++)this.push({data:this.dirRecords[g],meta:{percent:100}});var E=this.bytesWritten-v,L=N(this.dirRecords.length,E,v,this.zipComment,this.encodeFileName);this.push({data:L,meta:{percent:100}})},h.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},h.prototype.registerPrevious=function(v){this._sources.push(v);var g=this;return v.on("data",function(E){g.processChunk(E)}),v.on("end",function(){g.closedSource(g.previous.streamInfo),g._sources.length?g.prepareNextSource():g.end()}),v.on("error",function(E){g.error(E)}),this},h.prototype.resume=function(){if(!n.prototype.resume.call(this))return!1;if(!this.previous&&this._sources.length)return this.prepareNextSource(),!0;if(!this.previous&&!this._sources.length&&!this.generatedError)return this.end(),!0},h.prototype.error=function(v){var g=this._sources;if(!n.prototype.error.call(this,v))return!1;for(var E=0;E<g.length;E++)try{g[E].error(v)}catch{}return!0},h.prototype.lock=function(){n.prototype.lock.call(this);for(var v=this._sources,g=0;g<v.length;g++)v[g].lock()},r.exports=h},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(t,r,i){var s=t("../compressions"),n=t("./ZipFileWorker"),a=function(l,f){var d=l||f,c=s[d];if(!c)throw new Error(d+" is not a valid compression method !");return c};i.generateWorker=function(l,f,d){var c=new n(f.streamFiles,d,f.platform,f.encodeFileName),b=0;try{l.forEach(function(m,N){b++;var w=a(N.options.compression,f.compression),h=N.options.compressionOptions||f.compressionOptions||{},v=N.dir,g=N.date;N._compressWorker(w,h).withStreamInfo("file",{name:m,dir:v,date:g,comment:N.comment||"",unixPermissions:N.unixPermissions,dosPermissions:N.dosPermissions}).pipe(c)}),c.entriesCount=b}catch(m){c.error(m)}return c}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(t,r,i){function s(){if(!(this instanceof s))return new s;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var n=new s;for(var a in this)typeof this[a]!="function"&&(n[a]=this[a]);return n}}s.prototype=t("./object"),s.prototype.loadAsync=t("./load"),s.support=t("./support"),s.defaults=t("./defaults"),s.version="3.10.1",s.loadAsync=function(n,a){return new s().loadAsync(n,a)},s.external=t("./external"),r.exports=s},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(t,r,i){var s=t("./utils"),n=t("./external"),a=t("./utf8"),l=t("./zipEntries"),f=t("./stream/Crc32Probe"),d=t("./nodejsUtils");function c(b){return new n.Promise(function(m,N){var w=b.decompressed.getContentWorker().pipe(new f);w.on("error",function(h){N(h)}).on("end",function(){w.streamInfo.crc32!==b.decompressed.crc32?N(new Error("Corrupted zip : CRC32 mismatch")):m()}).resume()})}r.exports=function(b,m){var N=this;return m=s.extend(m||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:a.utf8decode}),d.isNode&&d.isStream(b)?n.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):s.prepareContent("the loaded zip file",b,!0,m.optimizedBinaryString,m.base64).then(function(w){var h=new l(m);return h.load(w),h}).then(function(h){var v=[n.Promise.resolve(h)],g=h.files;if(m.checkCRC32)for(var E=0;E<g.length;E++)v.push(c(g[E]));return n.Promise.all(v)}).then(function(h){for(var v=h.shift(),g=v.files,E=0;E<g.length;E++){var L=g[E],y=L.fileNameStr,S=s.resolve(L.fileNameStr);N.file(S,L.decompressed,{binary:!0,optimizedBinaryString:!0,date:L.date,dir:L.dir,comment:L.fileCommentStr.length?L.fileCommentStr:null,unixPermissions:L.unixPermissions,dosPermissions:L.dosPermissions,createFolders:m.createFolders}),L.dir||(N.file(S).unsafeOriginalName=y)}return v.zipComment.length&&(N.comment=v.zipComment),N})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(t,r,i){var s=t("../utils"),n=t("../stream/GenericWorker");function a(l,f){n.call(this,"Nodejs stream input adapter for "+l),this._upstreamEnded=!1,this._bindStream(f)}s.inherits(a,n),a.prototype._bindStream=function(l){var f=this;this._stream=l,l.pause(),l.on("data",function(d){f.push({data:d,meta:{percent:0}})}).on("error",function(d){f.isPaused?this.generatedError=d:f.error(d)}).on("end",function(){f.isPaused?f._upstreamEnded=!0:f.end()})},a.prototype.pause=function(){return n.prototype.pause.call(this)?(this._stream.pause(),!0):!1},a.prototype.resume=function(){return n.prototype.resume.call(this)?(this._upstreamEnded?this.end():this._stream.resume(),!0):!1},r.exports=a},{"../stream/GenericWorker":28,"../utils":32}],13:[function(t,r,i){var s=t("readable-stream").Readable,n=t("../utils");n.inherits(a,s);function a(l,f,d){s.call(this,f),this._helper=l;var c=this;l.on("data",function(b,m){c.push(b)||c._helper.pause(),d&&d(m)}).on("error",function(b){c.emit("error",b)}).on("end",function(){c.push(null)})}a.prototype._read=function(){this._helper.resume()},r.exports=a},{"../utils":32,"readable-stream":16}],14:[function(t,r,i){r.exports={isNode:typeof Buffer<"u",newBufferFrom:function(s,n){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(s,n);if(typeof s=="number")throw new Error('The "data" argument must not be a number');return new Buffer(s,n)},allocBuffer:function(s){if(Buffer.alloc)return Buffer.alloc(s);var n=new Buffer(s);return n.fill(0),n},isBuffer:function(s){return Buffer.isBuffer(s)},isStream:function(s){return s&&typeof s.on=="function"&&typeof s.pause=="function"&&typeof s.resume=="function"}}},{}],15:[function(t,r,i){var s=t("./utf8"),n=t("./utils"),a=t("./stream/GenericWorker"),l=t("./stream/StreamHelper"),f=t("./defaults"),d=t("./compressedObject"),c=t("./zipObject"),b=t("./generate"),m=t("./nodejsUtils"),N=t("./nodejs/NodejsStreamInputAdapter"),w=function(y,S,R){var I=n.getTypeOf(S),k,O=n.extend(R||{},f);O.date=O.date||new Date,O.compression!==null&&(O.compression=O.compression.toUpperCase()),typeof O.unixPermissions=="string"&&(O.unixPermissions=parseInt(O.unixPermissions,8)),O.unixPermissions&&O.unixPermissions&16384&&(O.dir=!0),O.dosPermissions&&O.dosPermissions&16&&(O.dir=!0),O.dir&&(y=v(y)),O.createFolders&&(k=h(y))&&g.call(this,k,!0);var H=I==="string"&&O.binary===!1&&O.base64===!1;(!R||typeof R.binary>"u")&&(O.binary=!H);var j=S instanceof d&&S.uncompressedSize===0;(j||O.dir||!S||S.length===0)&&(O.base64=!1,O.binary=!0,S="",O.compression="STORE",I="string");var Z=null;S instanceof d||S instanceof a?Z=S:m.isNode&&m.isStream(S)?Z=new N(y,S):Z=n.prepareContent(y,S,O.binary,O.optimizedBinaryString,O.base64);var K=new c(y,Z,O);this.files[y]=K},h=function(y){y.slice(-1)==="/"&&(y=y.substring(0,y.length-1));var S=y.lastIndexOf("/");return S>0?y.substring(0,S):""},v=function(y){return y.slice(-1)!=="/"&&(y+="/"),y},g=function(y,S){return S=typeof S<"u"?S:f.createFolders,y=v(y),this.files[y]||w.call(this,y,null,{dir:!0,createFolders:S}),this.files[y]};function E(y){return Object.prototype.toString.call(y)==="[object RegExp]"}var L={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(y){var S,R,I;for(S in this.files)I=this.files[S],R=S.slice(this.root.length,S.length),R&&S.slice(0,this.root.length)===this.root&&y(R,I)},filter:function(y){var S=[];return this.forEach(function(R,I){y(R,I)&&S.push(I)}),S},file:function(y,S,R){if(arguments.length===1)if(E(y)){var I=y;return this.filter(function(O,H){return!H.dir&&I.test(O)})}else{var k=this.files[this.root+y];return k&&!k.dir?k:null}else y=this.root+y,w.call(this,y,S,R);return this},folder:function(y){if(!y)return this;if(E(y))return this.filter(function(k,O){return O.dir&&y.test(k)});var S=this.root+y,R=g.call(this,S),I=this.clone();return I.root=R.name,I},remove:function(y){y=this.root+y;var S=this.files[y];if(S||(y.slice(-1)!=="/"&&(y+="/"),S=this.files[y]),S&&!S.dir)delete this.files[y];else for(var R=this.filter(function(k,O){return O.name.slice(0,y.length)===y}),I=0;I<R.length;I++)delete this.files[R[I].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(y){var S,R={};try{if(R=n.extend(y||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:s.utf8encode}),R.type=R.type.toLowerCase(),R.compression=R.compression.toUpperCase(),R.type==="binarystring"&&(R.type="string"),!R.type)throw new Error("No output type specified.");n.checkSupport(R.type),(R.platform==="darwin"||R.platform==="freebsd"||R.platform==="linux"||R.platform==="sunos")&&(R.platform="UNIX"),R.platform==="win32"&&(R.platform="DOS");var I=R.comment||this.comment||"";S=b.generateWorker(this,R,I)}catch(k){S=new a("error"),S.error(k)}return new l(S,R.type||"string",R.mimeType)},generateAsync:function(y,S){return this.generateInternalStream(y).accumulate(S)},generateNodeStream:function(y,S){return y=y||{},y.type||(y.type="nodebuffer"),this.generateInternalStream(y).toNodejsStream(S)}};r.exports=L},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(t,r,i){r.exports=t("stream")},{stream:void 0}],17:[function(t,r,i){var s=t("./DataReader"),n=t("../utils");function a(l){s.call(this,l);for(var f=0;f<this.data.length;f++)l[f]=l[f]&255}n.inherits(a,s),a.prototype.byteAt=function(l){return this.data[this.zero+l]},a.prototype.lastIndexOfSignature=function(l){for(var f=l.charCodeAt(0),d=l.charCodeAt(1),c=l.charCodeAt(2),b=l.charCodeAt(3),m=this.length-4;m>=0;--m)if(this.data[m]===f&&this.data[m+1]===d&&this.data[m+2]===c&&this.data[m+3]===b)return m-this.zero;return-1},a.prototype.readAndCheckSignature=function(l){var f=l.charCodeAt(0),d=l.charCodeAt(1),c=l.charCodeAt(2),b=l.charCodeAt(3),m=this.readData(4);return f===m[0]&&d===m[1]&&c===m[2]&&b===m[3]},a.prototype.readData=function(l){if(this.checkOffset(l),l===0)return[];var f=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,f},r.exports=a},{"../utils":32,"./DataReader":18}],18:[function(t,r,i){var s=t("../utils");function n(a){this.data=a,this.length=a.length,this.index=0,this.zero=0}n.prototype={checkOffset:function(a){this.checkIndex(this.index+a)},checkIndex:function(a){if(this.length<this.zero+a||a<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+a+"). Corrupted zip ?")},setIndex:function(a){this.checkIndex(a),this.index=a},skip:function(a){this.setIndex(this.index+a)},byteAt:function(){},readInt:function(a){var l=0,f;for(this.checkOffset(a),f=this.index+a-1;f>=this.index;f--)l=(l<<8)+this.byteAt(f);return this.index+=a,l},readString:function(a){return s.transformTo("string",this.readData(a))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var a=this.readInt(4);return new Date(Date.UTC((a>>25&127)+1980,(a>>21&15)-1,a>>16&31,a>>11&31,a>>5&63,(a&31)<<1))}},r.exports=n},{"../utils":32}],19:[function(t,r,i){var s=t("./Uint8ArrayReader"),n=t("../utils");function a(l){s.call(this,l)}n.inherits(a,s),a.prototype.readData=function(l){this.checkOffset(l);var f=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,f},r.exports=a},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(t,r,i){var s=t("./DataReader"),n=t("../utils");function a(l){s.call(this,l)}n.inherits(a,s),a.prototype.byteAt=function(l){return this.data.charCodeAt(this.zero+l)},a.prototype.lastIndexOfSignature=function(l){return this.data.lastIndexOf(l)-this.zero},a.prototype.readAndCheckSignature=function(l){var f=this.readData(4);return l===f},a.prototype.readData=function(l){this.checkOffset(l);var f=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,f},r.exports=a},{"../utils":32,"./DataReader":18}],21:[function(t,r,i){var s=t("./ArrayReader"),n=t("../utils");function a(l){s.call(this,l)}n.inherits(a,s),a.prototype.readData=function(l){if(this.checkOffset(l),l===0)return new Uint8Array(0);var f=this.data.subarray(this.zero+this.index,this.zero+this.index+l);return this.index+=l,f},r.exports=a},{"../utils":32,"./ArrayReader":17}],22:[function(t,r,i){var s=t("../utils"),n=t("../support"),a=t("./ArrayReader"),l=t("./StringReader"),f=t("./NodeBufferReader"),d=t("./Uint8ArrayReader");r.exports=function(c){var b=s.getTypeOf(c);return s.checkSupport(b),b==="string"&&!n.uint8array?new l(c):b==="nodebuffer"?new f(c):n.uint8array?new d(s.transformTo("uint8array",c)):new a(s.transformTo("array",c))}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(t,r,i){i.LOCAL_FILE_HEADER="PK",i.CENTRAL_FILE_HEADER="PK",i.CENTRAL_DIRECTORY_END="PK",i.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",i.ZIP64_CENTRAL_DIRECTORY_END="PK",i.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(t,r,i){var s=t("./GenericWorker"),n=t("../utils");function a(l){s.call(this,"ConvertWorker to "+l),this.destType=l}n.inherits(a,s),a.prototype.processChunk=function(l){this.push({data:n.transformTo(this.destType,l.data),meta:l.meta})},r.exports=a},{"../utils":32,"./GenericWorker":28}],25:[function(t,r,i){var s=t("./GenericWorker"),n=t("../crc32"),a=t("../utils");function l(){s.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}a.inherits(l,s),l.prototype.processChunk=function(f){this.streamInfo.crc32=n(f.data,this.streamInfo.crc32||0),this.push(f)},r.exports=l},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(t,r,i){var s=t("../utils"),n=t("./GenericWorker");function a(l){n.call(this,"DataLengthProbe for "+l),this.propName=l,this.withStreamInfo(l,0)}s.inherits(a,n),a.prototype.processChunk=function(l){if(l){var f=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=f+l.data.length}n.prototype.processChunk.call(this,l)},r.exports=a},{"../utils":32,"./GenericWorker":28}],27:[function(t,r,i){var s=t("../utils"),n=t("./GenericWorker"),a=16*1024;function l(f){n.call(this,"DataWorker");var d=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,f.then(function(c){d.dataIsReady=!0,d.data=c,d.max=c&&c.length||0,d.type=s.getTypeOf(c),d.isPaused||d._tickAndRepeat()},function(c){d.error(c)})}s.inherits(l,n),l.prototype.cleanUp=function(){n.prototype.cleanUp.call(this),this.data=null},l.prototype.resume=function(){return n.prototype.resume.call(this)?(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,s.delay(this._tickAndRepeat,[],this)),!0):!1},l.prototype._tickAndRepeat=function(){this._tickScheduled=!1,!(this.isPaused||this.isFinished)&&(this._tick(),this.isFinished||(s.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},l.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var f=a,d=null,c=Math.min(this.max,this.index+f);if(this.index>=this.max)return this.end();switch(this.type){case"string":d=this.data.substring(this.index,c);break;case"uint8array":d=this.data.subarray(this.index,c);break;case"array":case"nodebuffer":d=this.data.slice(this.index,c);break}return this.index=c,this.push({data:d,meta:{percent:this.max?this.index/this.max*100:0}})},r.exports=l},{"../utils":32,"./GenericWorker":28}],28:[function(t,r,i){function s(n){this.name=n||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}s.prototype={push:function(n){this.emit("data",n)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(n){this.emit("error",n)}return!0},error:function(n){return this.isFinished?!1:(this.isPaused?this.generatedError=n:(this.isFinished=!0,this.emit("error",n),this.previous&&this.previous.error(n),this.cleanUp()),!0)},on:function(n,a){return this._listeners[n].push(a),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(n,a){if(this._listeners[n])for(var l=0;l<this._listeners[n].length;l++)this._listeners[n][l].call(this,a)},pipe:function(n){return n.registerPrevious(this)},registerPrevious:function(n){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=n.streamInfo,this.mergeStreamInfo(),this.previous=n;var a=this;return n.on("data",function(l){a.processChunk(l)}),n.on("end",function(){a.end()}),n.on("error",function(l){a.error(l)}),this},pause:function(){return this.isPaused||this.isFinished?!1:(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;this.isPaused=!1;var n=!1;return this.generatedError&&(this.error(this.generatedError),n=!0),this.previous&&this.previous.resume(),!n},flush:function(){},processChunk:function(n){this.push(n)},withStreamInfo:function(n,a){return this.extraStreamInfo[n]=a,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var n in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,n)&&(this.streamInfo[n]=this.extraStreamInfo[n])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var n="Worker "+this.name;return this.previous?this.previous+" -> "+n:n}},r.exports=s},{}],29:[function(t,r,i){var s=t("../utils"),n=t("./ConvertWorker"),a=t("./GenericWorker"),l=t("../base64"),f=t("../support"),d=t("../external"),c=null;if(f.nodestream)try{c=t("../nodejs/NodejsStreamOutputAdapter")}catch{}function b(h,v,g){switch(h){case"blob":return s.newBlob(s.transformTo("arraybuffer",v),g);case"base64":return l.encode(v);default:return s.transformTo(h,v)}}function m(h,v){var g,E=0,L=null,y=0;for(g=0;g<v.length;g++)y+=v[g].length;switch(h){case"string":return v.join("");case"array":return Array.prototype.concat.apply([],v);case"uint8array":for(L=new Uint8Array(y),g=0;g<v.length;g++)L.set(v[g],E),E+=v[g].length;return L;case"nodebuffer":return Buffer.concat(v);default:throw new Error("concat : unsupported type '"+h+"'")}}function N(h,v){return new d.Promise(function(g,E){var L=[],y=h._internalType,S=h._outputType,R=h._mimeType;h.on("data",function(I,k){L.push(I),v&&v(k)}).on("error",function(I){L=[],E(I)}).on("end",function(){try{var I=b(S,m(y,L),R);g(I)}catch(k){E(k)}L=[]}).resume()})}function w(h,v,g){var E=v;switch(v){case"blob":case"arraybuffer":E="uint8array";break;case"base64":E="string";break}try{this._internalType=E,this._outputType=v,this._mimeType=g,s.checkSupport(E),this._worker=h.pipe(new n(E)),h.lock()}catch(L){this._worker=new a("error"),this._worker.error(L)}}w.prototype={accumulate:function(h){return N(this,h)},on:function(h,v){var g=this;return h==="data"?this._worker.on(h,function(E){v.call(g,E.data,E.meta)}):this._worker.on(h,function(){s.delay(v,arguments,g)}),this},resume:function(){return s.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(h){if(s.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new c(this,{objectMode:this._outputType!=="nodebuffer"},h)}},r.exports=w},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(t,r,i){if(i.base64=!0,i.array=!0,i.string=!0,i.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",i.nodebuffer=typeof Buffer<"u",i.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")i.blob=!1;else{var s=new ArrayBuffer(0);try{i.blob=new Blob([s],{type:"application/zip"}).size===0}catch{try{var n=self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder,a=new n;a.append(s),i.blob=a.getBlob("application/zip").size===0}catch{i.blob=!1}}}try{i.nodestream=!!t("readable-stream").Readable}catch{i.nodestream=!1}},{"readable-stream":16}],31:[function(t,r,i){for(var s=t("./utils"),n=t("./support"),a=t("./nodejsUtils"),l=t("./stream/GenericWorker"),f=new Array(256),d=0;d<256;d++)f[d]=d>=252?6:d>=248?5:d>=240?4:d>=224?3:d>=192?2:1;f[254]=f[254]=1;var c=function(h){var v,g,E,L,y,S=h.length,R=0;for(L=0;L<S;L++)g=h.charCodeAt(L),(g&64512)===55296&&L+1<S&&(E=h.charCodeAt(L+1),(E&64512)===56320&&(g=65536+(g-55296<<10)+(E-56320),L++)),R+=g<128?1:g<2048?2:g<65536?3:4;for(n.uint8array?v=new Uint8Array(R):v=new Array(R),y=0,L=0;y<R;L++)g=h.charCodeAt(L),(g&64512)===55296&&L+1<S&&(E=h.charCodeAt(L+1),(E&64512)===56320&&(g=65536+(g-55296<<10)+(E-56320),L++)),g<128?v[y++]=g:g<2048?(v[y++]=192|g>>>6,v[y++]=128|g&63):g<65536?(v[y++]=224|g>>>12,v[y++]=128|g>>>6&63,v[y++]=128|g&63):(v[y++]=240|g>>>18,v[y++]=128|g>>>12&63,v[y++]=128|g>>>6&63,v[y++]=128|g&63);return v},b=function(h,v){var g;for(v=v||h.length,v>h.length&&(v=h.length),g=v-1;g>=0&&(h[g]&192)===128;)g--;return g<0||g===0?v:g+f[h[g]]>v?g:v},m=function(h){var v,g,E,L,y=h.length,S=new Array(y*2);for(g=0,v=0;v<y;){if(E=h[v++],E<128){S[g++]=E;continue}if(L=f[E],L>4){S[g++]=65533,v+=L-1;continue}for(E&=L===2?31:L===3?15:7;L>1&&v<y;)E=E<<6|h[v++]&63,L--;if(L>1){S[g++]=65533;continue}E<65536?S[g++]=E:(E-=65536,S[g++]=55296|E>>10&1023,S[g++]=56320|E&1023)}return S.length!==g&&(S.subarray?S=S.subarray(0,g):S.length=g),s.applyFromCharCode(S)};i.utf8encode=function(v){return n.nodebuffer?a.newBufferFrom(v,"utf-8"):c(v)},i.utf8decode=function(v){return n.nodebuffer?s.transformTo("nodebuffer",v).toString("utf-8"):(v=s.transformTo(n.uint8array?"uint8array":"array",v),m(v))};function N(){l.call(this,"utf-8 decode"),this.leftOver=null}s.inherits(N,l),N.prototype.processChunk=function(h){var v=s.transformTo(n.uint8array?"uint8array":"array",h.data);if(this.leftOver&&this.leftOver.length){if(n.uint8array){var g=v;v=new Uint8Array(g.length+this.leftOver.length),v.set(this.leftOver,0),v.set(g,this.leftOver.length)}else v=this.leftOver.concat(v);this.leftOver=null}var E=b(v),L=v;E!==v.length&&(n.uint8array?(L=v.subarray(0,E),this.leftOver=v.subarray(E,v.length)):(L=v.slice(0,E),this.leftOver=v.slice(E,v.length))),this.push({data:i.utf8decode(L),meta:h.meta})},N.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:i.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},i.Utf8DecodeWorker=N;function w(){l.call(this,"utf-8 encode")}s.inherits(w,l),w.prototype.processChunk=function(h){this.push({data:i.utf8encode(h.data),meta:h.meta})},i.Utf8EncodeWorker=w},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(t,r,i){var s=t("./support"),n=t("./base64"),a=t("./nodejsUtils"),l=t("./external");t("setimmediate");function f(h){var v=null;return s.uint8array?v=new Uint8Array(h.length):v=new Array(h.length),c(h,v)}i.newBlob=function(h,v){i.checkSupport("blob");try{return new Blob([h],{type:v})}catch{try{var g=self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder,E=new g;return E.append(h),E.getBlob(v)}catch{throw new Error("Bug : can't construct the Blob.")}}};function d(h){return h}function c(h,v){for(var g=0;g<h.length;++g)v[g]=h.charCodeAt(g)&255;return v}var b={stringifyByChunk:function(h,v,g){var E=[],L=0,y=h.length;if(y<=g)return String.fromCharCode.apply(null,h);for(;L<y;)v==="array"||v==="nodebuffer"?E.push(String.fromCharCode.apply(null,h.slice(L,Math.min(L+g,y)))):E.push(String.fromCharCode.apply(null,h.subarray(L,Math.min(L+g,y)))),L+=g;return E.join("")},stringifyByChar:function(h){for(var v="",g=0;g<h.length;g++)v+=String.fromCharCode(h[g]);return v},applyCanBeUsed:{uint8array:(function(){try{return s.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}})(),nodebuffer:(function(){try{return s.nodebuffer&&String.fromCharCode.apply(null,a.allocBuffer(1)).length===1}catch{return!1}})()}};function m(h){var v=65536,g=i.getTypeOf(h),E=!0;if(g==="uint8array"?E=b.applyCanBeUsed.uint8array:g==="nodebuffer"&&(E=b.applyCanBeUsed.nodebuffer),E)for(;v>1;)try{return b.stringifyByChunk(h,g,v)}catch{v=Math.floor(v/2)}return b.stringifyByChar(h)}i.applyFromCharCode=m;function N(h,v){for(var g=0;g<h.length;g++)v[g]=h[g];return v}var w={};w.string={string:d,array:function(h){return c(h,new Array(h.length))},arraybuffer:function(h){return w.string.uint8array(h).buffer},uint8array:function(h){return c(h,new Uint8Array(h.length))},nodebuffer:function(h){return c(h,a.allocBuffer(h.length))}},w.array={string:m,array:d,arraybuffer:function(h){return new Uint8Array(h).buffer},uint8array:function(h){return new Uint8Array(h)},nodebuffer:function(h){return a.newBufferFrom(h)}},w.arraybuffer={string:function(h){return m(new Uint8Array(h))},array:function(h){return N(new Uint8Array(h),new Array(h.byteLength))},arraybuffer:d,uint8array:function(h){return new Uint8Array(h)},nodebuffer:function(h){return a.newBufferFrom(new Uint8Array(h))}},w.uint8array={string:m,array:function(h){return N(h,new Array(h.length))},arraybuffer:function(h){return h.buffer},uint8array:d,nodebuffer:function(h){return a.newBufferFrom(h)}},w.nodebuffer={string:m,array:function(h){return N(h,new Array(h.length))},arraybuffer:function(h){return w.nodebuffer.uint8array(h).buffer},uint8array:function(h){return N(h,new Uint8Array(h.length))},nodebuffer:d},i.transformTo=function(h,v){if(v||(v=""),!h)return v;i.checkSupport(h);var g=i.getTypeOf(v),E=w[g][h](v);return E},i.resolve=function(h){for(var v=h.split("/"),g=[],E=0;E<v.length;E++){var L=v[E];L==="."||L===""&&E!==0&&E!==v.length-1||(L===".."?g.pop():g.push(L))}return g.join("/")},i.getTypeOf=function(h){if(typeof h=="string")return"string";if(Object.prototype.toString.call(h)==="[object Array]")return"array";if(s.nodebuffer&&a.isBuffer(h))return"nodebuffer";if(s.uint8array&&h instanceof Uint8Array)return"uint8array";if(s.arraybuffer&&h instanceof ArrayBuffer)return"arraybuffer"},i.checkSupport=function(h){var v=s[h.toLowerCase()];if(!v)throw new Error(h+" is not supported by this platform")},i.MAX_VALUE_16BITS=65535,i.MAX_VALUE_32BITS=-1,i.pretty=function(h){var v="",g,E;for(E=0;E<(h||"").length;E++)g=h.charCodeAt(E),v+="\\x"+(g<16?"0":"")+g.toString(16).toUpperCase();return v},i.delay=function(h,v,g){setImmediate(function(){h.apply(g||null,v||[])})},i.inherits=function(h,v){var g=function(){};g.prototype=v.prototype,h.prototype=new g},i.extend=function(){var h={},v,g;for(v=0;v<arguments.length;v++)for(g in arguments[v])Object.prototype.hasOwnProperty.call(arguments[v],g)&&typeof h[g]>"u"&&(h[g]=arguments[v][g]);return h},i.prepareContent=function(h,v,g,E,L){var y=l.Promise.resolve(v).then(function(S){var R=s.blob&&(S instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(S))!==-1);return R&&typeof FileReader<"u"?new l.Promise(function(I,k){var O=new FileReader;O.onload=function(H){I(H.target.result)},O.onerror=function(H){k(H.target.error)},O.readAsArrayBuffer(S)}):S});return y.then(function(S){var R=i.getTypeOf(S);return R?(R==="arraybuffer"?S=i.transformTo("uint8array",S):R==="string"&&(L?S=n.decode(S):g&&E!==!0&&(S=f(S))),S):l.Promise.reject(new Error("Can't read the data of '"+h+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(t,r,i){var s=t("./reader/readerFor"),n=t("./utils"),a=t("./signature"),l=t("./zipEntry"),f=t("./support");function d(c){this.files=[],this.loadOptions=c}d.prototype={checkSignature:function(c){if(!this.reader.readAndCheckSignature(c)){this.reader.index-=4;var b=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+n.pretty(b)+", expected "+n.pretty(c)+")")}},isSignature:function(c,b){var m=this.reader.index;this.reader.setIndex(c);var N=this.reader.readString(4),w=N===b;return this.reader.setIndex(m),w},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var c=this.reader.readData(this.zipCommentLength),b=f.uint8array?"uint8array":"array",m=n.transformTo(b,c);this.zipComment=this.loadOptions.decodeFileName(m)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var c=this.zip64EndOfCentralSize-44,b=0,m,N,w;b<c;)m=this.reader.readInt(2),N=this.reader.readInt(4),w=this.reader.readData(N),this.zip64ExtensibleData[m]={id:m,length:N,value:w}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var c,b;for(c=0;c<this.files.length;c++)b=this.files[c],this.reader.setIndex(b.localHeaderOffset),this.checkSignature(a.LOCAL_FILE_HEADER),b.readLocalPart(this.reader),b.handleUTF8(),b.processAttributes()},readCentralDir:function(){var c;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(a.CENTRAL_FILE_HEADER);)c=new l({zip64:this.zip64},this.loadOptions),c.readCentralPart(this.reader),this.files.push(c);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var c=this.reader.lastIndexOfSignature(a.CENTRAL_DIRECTORY_END);if(c<0){var b=!this.isSignature(0,a.LOCAL_FILE_HEADER);throw b?new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html"):new Error("Corrupted zip: can't find end of central directory")}this.reader.setIndex(c);var m=c;if(this.checkSignature(a.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===n.MAX_VALUE_16BITS||this.diskWithCentralDirStart===n.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===n.MAX_VALUE_16BITS||this.centralDirRecords===n.MAX_VALUE_16BITS||this.centralDirSize===n.MAX_VALUE_32BITS||this.centralDirOffset===n.MAX_VALUE_32BITS){if(this.zip64=!0,c=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR),c<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(c),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,a.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var N=this.centralDirOffset+this.centralDirSize;this.zip64&&(N+=20,N+=12+this.zip64EndOfCentralSize);var w=m-N;if(w>0)this.isSignature(m,a.CENTRAL_FILE_HEADER)||(this.reader.zero=w);else if(w<0)throw new Error("Corrupted zip: missing "+Math.abs(w)+" bytes.")},prepareReader:function(c){this.reader=s(c)},load:function(c){this.prepareReader(c),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},r.exports=d},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(t,r,i){var s=t("./reader/readerFor"),n=t("./utils"),a=t("./compressedObject"),l=t("./crc32"),f=t("./utf8"),d=t("./compressions"),c=t("./support"),b=0,m=3,N=function(h){for(var v in d)if(Object.prototype.hasOwnProperty.call(d,v)&&d[v].magic===h)return d[v];return null};function w(h,v){this.options=h,this.loadOptions=v}w.prototype={isEncrypted:function(){return(this.bitFlag&1)===1},useUTF8:function(){return(this.bitFlag&2048)===2048},readLocalPart:function(h){var v,g;if(h.skip(22),this.fileNameLength=h.readInt(2),g=h.readInt(2),this.fileName=h.readData(this.fileNameLength),h.skip(g),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(v=N(this.compressionMethod),v===null)throw new Error("Corrupted zip : compression "+n.pretty(this.compressionMethod)+" unknown (inner file : "+n.transformTo("string",this.fileName)+")");this.decompressed=new a(this.compressedSize,this.uncompressedSize,this.crc32,v,h.readData(this.compressedSize))},readCentralPart:function(h){this.versionMadeBy=h.readInt(2),h.skip(2),this.bitFlag=h.readInt(2),this.compressionMethod=h.readString(2),this.date=h.readDate(),this.crc32=h.readInt(4),this.compressedSize=h.readInt(4),this.uncompressedSize=h.readInt(4);var v=h.readInt(2);if(this.extraFieldsLength=h.readInt(2),this.fileCommentLength=h.readInt(2),this.diskNumberStart=h.readInt(2),this.internalFileAttributes=h.readInt(2),this.externalFileAttributes=h.readInt(4),this.localHeaderOffset=h.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");h.skip(v),this.readExtraFields(h),this.parseZIP64ExtraField(h),this.fileComment=h.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var h=this.versionMadeBy>>8;this.dir=!!(this.externalFileAttributes&16),h===b&&(this.dosPermissions=this.externalFileAttributes&63),h===m&&(this.unixPermissions=this.externalFileAttributes>>16&65535),!this.dir&&this.fileNameStr.slice(-1)==="/"&&(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var h=s(this.extraFields[1].value);this.uncompressedSize===n.MAX_VALUE_32BITS&&(this.uncompressedSize=h.readInt(8)),this.compressedSize===n.MAX_VALUE_32BITS&&(this.compressedSize=h.readInt(8)),this.localHeaderOffset===n.MAX_VALUE_32BITS&&(this.localHeaderOffset=h.readInt(8)),this.diskNumberStart===n.MAX_VALUE_32BITS&&(this.diskNumberStart=h.readInt(4))}},readExtraFields:function(h){var v=h.index+this.extraFieldsLength,g,E,L;for(this.extraFields||(this.extraFields={});h.index+4<v;)g=h.readInt(2),E=h.readInt(2),L=h.readData(E),this.extraFields[g]={id:g,length:E,value:L};h.setIndex(v)},handleUTF8:function(){var h=c.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=f.utf8decode(this.fileName),this.fileCommentStr=f.utf8decode(this.fileComment);else{var v=this.findExtraFieldUnicodePath();if(v!==null)this.fileNameStr=v;else{var g=n.transformTo(h,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(g)}var E=this.findExtraFieldUnicodeComment();if(E!==null)this.fileCommentStr=E;else{var L=n.transformTo(h,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(L)}}},findExtraFieldUnicodePath:function(){var h=this.extraFields[28789];if(h){var v=s(h.value);return v.readInt(1)!==1||l(this.fileName)!==v.readInt(4)?null:f.utf8decode(v.readData(h.length-5))}return null},findExtraFieldUnicodeComment:function(){var h=this.extraFields[25461];if(h){var v=s(h.value);return v.readInt(1)!==1||l(this.fileComment)!==v.readInt(4)?null:f.utf8decode(v.readData(h.length-5))}return null}},r.exports=w},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(t,r,i){var s=t("./stream/StreamHelper"),n=t("./stream/DataWorker"),a=t("./utf8"),l=t("./compressedObject"),f=t("./stream/GenericWorker"),d=function(N,w,h){this.name=N,this.dir=h.dir,this.date=h.date,this.comment=h.comment,this.unixPermissions=h.unixPermissions,this.dosPermissions=h.dosPermissions,this._data=w,this._dataBinary=h.binary,this.options={compression:h.compression,compressionOptions:h.compressionOptions}};d.prototype={internalStream:function(N){var w=null,h="string";try{if(!N)throw new Error("No output type specified.");h=N.toLowerCase();var v=h==="string"||h==="text";(h==="binarystring"||h==="text")&&(h="string"),w=this._decompressWorker();var g=!this._dataBinary;g&&!v&&(w=w.pipe(new a.Utf8EncodeWorker)),!g&&v&&(w=w.pipe(new a.Utf8DecodeWorker))}catch(E){w=new f("error"),w.error(E)}return new s(w,h,"")},async:function(N,w){return this.internalStream(N).accumulate(w)},nodeStream:function(N,w){return this.internalStream(N||"nodebuffer").toNodejsStream(w)},_compressWorker:function(N,w){if(this._data instanceof l&&this._data.compression.magic===N.magic)return this._data.getCompressedWorker();var h=this._decompressWorker();return this._dataBinary||(h=h.pipe(new a.Utf8EncodeWorker)),l.createWorkerFrom(h,N,w)},_decompressWorker:function(){return this._data instanceof l?this._data.getContentWorker():this._data instanceof f?this._data:new n(this._data)}};for(var c=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],b=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},m=0;m<c.length;m++)d.prototype[c[m]]=b;r.exports=d},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(t,r,i){(function(s){var n=s.MutationObserver||s.WebKitMutationObserver,a;if(n){var l=0,f=new n(N),d=s.document.createTextNode("");f.observe(d,{characterData:!0}),a=function(){d.data=l=++l%2}}else if(!s.setImmediate&&typeof s.MessageChannel<"u"){var c=new s.MessageChannel;c.port1.onmessage=N,a=function(){c.port2.postMessage(0)}}else"document"in s&&"onreadystatechange"in s.document.createElement("script")?a=function(){var h=s.document.createElement("script");h.onreadystatechange=function(){N(),h.onreadystatechange=null,h.parentNode.removeChild(h),h=null},s.document.documentElement.appendChild(h)}:a=function(){setTimeout(N,0)};var b,m=[];function N(){b=!0;for(var h,v,g=m.length;g;){for(v=m,m=[],h=-1;++h<g;)v[h]();g=m.length}b=!1}r.exports=w;function w(h){m.push(h)===1&&!b&&a()}}).call(this,typeof yt<"u"?yt:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(t,r,i){var s=t("immediate");function n(){}var a={},l=["REJECTED"],f=["FULFILLED"],d=["PENDING"];r.exports=c;function c(y){if(typeof y!="function")throw new TypeError("resolver must be a function");this.state=d,this.queue=[],this.outcome=void 0,y!==n&&w(this,y)}c.prototype.finally=function(y){if(typeof y!="function")return this;var S=this.constructor;return this.then(R,I);function R(k){function O(){return k}return S.resolve(y()).then(O)}function I(k){function O(){throw k}return S.resolve(y()).then(O)}},c.prototype.catch=function(y){return this.then(null,y)},c.prototype.then=function(y,S){if(typeof y!="function"&&this.state===f||typeof S!="function"&&this.state===l)return this;var R=new this.constructor(n);if(this.state!==d){var I=this.state===f?y:S;m(R,I,this.outcome)}else this.queue.push(new b(R,y,S));return R};function b(y,S,R){this.promise=y,typeof S=="function"&&(this.onFulfilled=S,this.callFulfilled=this.otherCallFulfilled),typeof R=="function"&&(this.onRejected=R,this.callRejected=this.otherCallRejected)}b.prototype.callFulfilled=function(y){a.resolve(this.promise,y)},b.prototype.otherCallFulfilled=function(y){m(this.promise,this.onFulfilled,y)},b.prototype.callRejected=function(y){a.reject(this.promise,y)},b.prototype.otherCallRejected=function(y){m(this.promise,this.onRejected,y)};function m(y,S,R){s(function(){var I;try{I=S(R)}catch(k){return a.reject(y,k)}I===y?a.reject(y,new TypeError("Cannot resolve promise with itself")):a.resolve(y,I)})}a.resolve=function(y,S){var R=h(N,S);if(R.status==="error")return a.reject(y,R.value);var I=R.value;if(I)w(y,I);else{y.state=f,y.outcome=S;for(var k=-1,O=y.queue.length;++k<O;)y.queue[k].callFulfilled(S)}return y},a.reject=function(y,S){y.state=l,y.outcome=S;for(var R=-1,I=y.queue.length;++R<I;)y.queue[R].callRejected(S);return y};function N(y){var S=y&&y.then;if(y&&(typeof y=="object"||typeof y=="function")&&typeof S=="function")return function(){S.apply(y,arguments)}}function w(y,S){var R=!1;function I(j){R||(R=!0,a.reject(y,j))}function k(j){R||(R=!0,a.resolve(y,j))}function O(){S(k,I)}var H=h(O);H.status==="error"&&I(H.value)}function h(y,S){var R={};try{R.value=y(S),R.status="success"}catch(I){R.status="error",R.value=I}return R}c.resolve=v;function v(y){return y instanceof this?y:a.resolve(new this(n),y)}c.reject=g;function g(y){var S=new this(n);return a.reject(S,y)}c.all=E;function E(y){var S=this;if(Object.prototype.toString.call(y)!=="[object Array]")return this.reject(new TypeError("must be an array"));var R=y.length,I=!1;if(!R)return this.resolve([]);for(var k=new Array(R),O=0,H=-1,j=new this(n);++H<R;)Z(y[H],H);return j;function Z(K,J){S.resolve(K).then(he,function(Q){I||(I=!0,a.reject(j,Q))});function he(Q){k[J]=Q,++O===R&&!I&&(I=!0,a.resolve(j,k))}}}c.race=L;function L(y){var S=this;if(Object.prototype.toString.call(y)!=="[object Array]")return this.reject(new TypeError("must be an array"));var R=y.length,I=!1;if(!R)return this.resolve([]);for(var k=-1,O=new this(n);++k<R;)H(y[k]);return O;function H(j){S.resolve(j).then(function(Z){I||(I=!0,a.resolve(O,Z))},function(Z){I||(I=!0,a.reject(O,Z))})}}},{immediate:36}],38:[function(t,r,i){var s=t("./lib/utils/common").assign,n=t("./lib/deflate"),a=t("./lib/inflate"),l=t("./lib/zlib/constants"),f={};s(f,n,a,l),r.exports=f},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(t,r,i){var s=t("./zlib/deflate"),n=t("./utils/common"),a=t("./utils/strings"),l=t("./zlib/messages"),f=t("./zlib/zstream"),d=Object.prototype.toString,c=0,b=4,m=0,N=1,w=2,h=-1,v=0,g=8;function E(R){if(!(this instanceof E))return new E(R);this.options=n.assign({level:h,method:g,chunkSize:16384,windowBits:15,memLevel:8,strategy:v,to:""},R||{});var I=this.options;I.raw&&I.windowBits>0?I.windowBits=-I.windowBits:I.gzip&&I.windowBits>0&&I.windowBits<16&&(I.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new f,this.strm.avail_out=0;var k=s.deflateInit2(this.strm,I.level,I.method,I.windowBits,I.memLevel,I.strategy);if(k!==m)throw new Error(l[k]);if(I.header&&s.deflateSetHeader(this.strm,I.header),I.dictionary){var O;if(typeof I.dictionary=="string"?O=a.string2buf(I.dictionary):d.call(I.dictionary)==="[object ArrayBuffer]"?O=new Uint8Array(I.dictionary):O=I.dictionary,k=s.deflateSetDictionary(this.strm,O),k!==m)throw new Error(l[k]);this._dict_set=!0}}E.prototype.push=function(R,I){var k=this.strm,O=this.options.chunkSize,H,j;if(this.ended)return!1;j=I===~~I?I:I===!0?b:c,typeof R=="string"?k.input=a.string2buf(R):d.call(R)==="[object ArrayBuffer]"?k.input=new Uint8Array(R):k.input=R,k.next_in=0,k.avail_in=k.input.length;do{if(k.avail_out===0&&(k.output=new n.Buf8(O),k.next_out=0,k.avail_out=O),H=s.deflate(k,j),H!==N&&H!==m)return this.onEnd(H),this.ended=!0,!1;(k.avail_out===0||k.avail_in===0&&(j===b||j===w))&&(this.options.to==="string"?this.onData(a.buf2binstring(n.shrinkBuf(k.output,k.next_out))):this.onData(n.shrinkBuf(k.output,k.next_out)))}while((k.avail_in>0||k.avail_out===0)&&H!==N);return j===b?(H=s.deflateEnd(this.strm),this.onEnd(H),this.ended=!0,H===m):(j===w&&(this.onEnd(m),k.avail_out=0),!0)},E.prototype.onData=function(R){this.chunks.push(R)},E.prototype.onEnd=function(R){R===m&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=n.flattenChunks(this.chunks)),this.chunks=[],this.err=R,this.msg=this.strm.msg};function L(R,I){var k=new E(I);if(k.push(R,!0),k.err)throw k.msg||l[k.err];return k.result}function y(R,I){return I=I||{},I.raw=!0,L(R,I)}function S(R,I){return I=I||{},I.gzip=!0,L(R,I)}i.Deflate=E,i.deflate=L,i.deflateRaw=y,i.gzip=S},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(t,r,i){var s=t("./zlib/inflate"),n=t("./utils/common"),a=t("./utils/strings"),l=t("./zlib/constants"),f=t("./zlib/messages"),d=t("./zlib/zstream"),c=t("./zlib/gzheader"),b=Object.prototype.toString;function m(h){if(!(this instanceof m))return new m(h);this.options=n.assign({chunkSize:16384,windowBits:0,to:""},h||{});var v=this.options;v.raw&&v.windowBits>=0&&v.windowBits<16&&(v.windowBits=-v.windowBits,v.windowBits===0&&(v.windowBits=-15)),v.windowBits>=0&&v.windowBits<16&&!(h&&h.windowBits)&&(v.windowBits+=32),v.windowBits>15&&v.windowBits<48&&(v.windowBits&15)===0&&(v.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new d,this.strm.avail_out=0;var g=s.inflateInit2(this.strm,v.windowBits);if(g!==l.Z_OK)throw new Error(f[g]);this.header=new c,s.inflateGetHeader(this.strm,this.header)}m.prototype.push=function(h,v){var g=this.strm,E=this.options.chunkSize,L=this.options.dictionary,y,S,R,I,k,O,H=!1;if(this.ended)return!1;S=v===~~v?v:v===!0?l.Z_FINISH:l.Z_NO_FLUSH,typeof h=="string"?g.input=a.binstring2buf(h):b.call(h)==="[object ArrayBuffer]"?g.input=new Uint8Array(h):g.input=h,g.next_in=0,g.avail_in=g.input.length;do{if(g.avail_out===0&&(g.output=new n.Buf8(E),g.next_out=0,g.avail_out=E),y=s.inflate(g,l.Z_NO_FLUSH),y===l.Z_NEED_DICT&&L&&(typeof L=="string"?O=a.string2buf(L):b.call(L)==="[object ArrayBuffer]"?O=new Uint8Array(L):O=L,y=s.inflateSetDictionary(this.strm,O)),y===l.Z_BUF_ERROR&&H===!0&&(y=l.Z_OK,H=!1),y!==l.Z_STREAM_END&&y!==l.Z_OK)return this.onEnd(y),this.ended=!0,!1;g.next_out&&(g.avail_out===0||y===l.Z_STREAM_END||g.avail_in===0&&(S===l.Z_FINISH||S===l.Z_SYNC_FLUSH))&&(this.options.to==="string"?(R=a.utf8border(g.output,g.next_out),I=g.next_out-R,k=a.buf2string(g.output,R),g.next_out=I,g.avail_out=E-I,I&&n.arraySet(g.output,g.output,R,I,0),this.onData(k)):this.onData(n.shrinkBuf(g.output,g.next_out))),g.avail_in===0&&g.avail_out===0&&(H=!0)}while((g.avail_in>0||g.avail_out===0)&&y!==l.Z_STREAM_END);return y===l.Z_STREAM_END&&(S=l.Z_FINISH),S===l.Z_FINISH?(y=s.inflateEnd(this.strm),this.onEnd(y),this.ended=!0,y===l.Z_OK):(S===l.Z_SYNC_FLUSH&&(this.onEnd(l.Z_OK),g.avail_out=0),!0)},m.prototype.onData=function(h){this.chunks.push(h)},m.prototype.onEnd=function(h){h===l.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=n.flattenChunks(this.chunks)),this.chunks=[],this.err=h,this.msg=this.strm.msg};function N(h,v){var g=new m(v);if(g.push(h,!0),g.err)throw g.msg||f[g.err];return g.result}function w(h,v){return v=v||{},v.raw=!0,N(h,v)}i.Inflate=m,i.inflate=N,i.inflateRaw=w,i.ungzip=N},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(t,r,i){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";i.assign=function(l){for(var f=Array.prototype.slice.call(arguments,1);f.length;){var d=f.shift();if(d){if(typeof d!="object")throw new TypeError(d+"must be non-object");for(var c in d)d.hasOwnProperty(c)&&(l[c]=d[c])}}return l},i.shrinkBuf=function(l,f){return l.length===f?l:l.subarray?l.subarray(0,f):(l.length=f,l)};var n={arraySet:function(l,f,d,c,b){if(f.subarray&&l.subarray){l.set(f.subarray(d,d+c),b);return}for(var m=0;m<c;m++)l[b+m]=f[d+m]},flattenChunks:function(l){var f,d,c,b,m,N;for(c=0,f=0,d=l.length;f<d;f++)c+=l[f].length;for(N=new Uint8Array(c),b=0,f=0,d=l.length;f<d;f++)m=l[f],N.set(m,b),b+=m.length;return N}},a={arraySet:function(l,f,d,c,b){for(var m=0;m<c;m++)l[b+m]=f[d+m]},flattenChunks:function(l){return[].concat.apply([],l)}};i.setTyped=function(l){l?(i.Buf8=Uint8Array,i.Buf16=Uint16Array,i.Buf32=Int32Array,i.assign(i,n)):(i.Buf8=Array,i.Buf16=Array,i.Buf32=Array,i.assign(i,a))},i.setTyped(s)},{}],42:[function(t,r,i){var s=t("./common"),n=!0,a=!0;try{String.fromCharCode.apply(null,[0])}catch{n=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{a=!1}for(var l=new s.Buf8(256),f=0;f<256;f++)l[f]=f>=252?6:f>=248?5:f>=240?4:f>=224?3:f>=192?2:1;l[254]=l[254]=1,i.string2buf=function(c){var b,m,N,w,h,v=c.length,g=0;for(w=0;w<v;w++)m=c.charCodeAt(w),(m&64512)===55296&&w+1<v&&(N=c.charCodeAt(w+1),(N&64512)===56320&&(m=65536+(m-55296<<10)+(N-56320),w++)),g+=m<128?1:m<2048?2:m<65536?3:4;for(b=new s.Buf8(g),h=0,w=0;h<g;w++)m=c.charCodeAt(w),(m&64512)===55296&&w+1<v&&(N=c.charCodeAt(w+1),(N&64512)===56320&&(m=65536+(m-55296<<10)+(N-56320),w++)),m<128?b[h++]=m:m<2048?(b[h++]=192|m>>>6,b[h++]=128|m&63):m<65536?(b[h++]=224|m>>>12,b[h++]=128|m>>>6&63,b[h++]=128|m&63):(b[h++]=240|m>>>18,b[h++]=128|m>>>12&63,b[h++]=128|m>>>6&63,b[h++]=128|m&63);return b};function d(c,b){if(b<65537&&(c.subarray&&a||!c.subarray&&n))return String.fromCharCode.apply(null,s.shrinkBuf(c,b));for(var m="",N=0;N<b;N++)m+=String.fromCharCode(c[N]);return m}i.buf2binstring=function(c){return d(c,c.length)},i.binstring2buf=function(c){for(var b=new s.Buf8(c.length),m=0,N=b.length;m<N;m++)b[m]=c.charCodeAt(m);return b},i.buf2string=function(c,b){var m,N,w,h,v=b||c.length,g=new Array(v*2);for(N=0,m=0;m<v;){if(w=c[m++],w<128){g[N++]=w;continue}if(h=l[w],h>4){g[N++]=65533,m+=h-1;continue}for(w&=h===2?31:h===3?15:7;h>1&&m<v;)w=w<<6|c[m++]&63,h--;if(h>1){g[N++]=65533;continue}w<65536?g[N++]=w:(w-=65536,g[N++]=55296|w>>10&1023,g[N++]=56320|w&1023)}return d(g,N)},i.utf8border=function(c,b){var m;for(b=b||c.length,b>c.length&&(b=c.length),m=b-1;m>=0&&(c[m]&192)===128;)m--;return m<0||m===0?b:m+l[c[m]]>b?m:b}},{"./common":41}],43:[function(t,r,i){function s(n,a,l,f){for(var d=n&65535|0,c=n>>>16&65535|0,b=0;l!==0;){b=l>2e3?2e3:l,l-=b;do d=d+a[f++]|0,c=c+d|0;while(--b);d%=65521,c%=65521}return d|c<<16|0}r.exports=s},{}],44:[function(t,r,i){r.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(t,r,i){function s(){for(var l,f=[],d=0;d<256;d++){l=d;for(var c=0;c<8;c++)l=l&1?3988292384^l>>>1:l>>>1;f[d]=l}return f}var n=s();function a(l,f,d,c){var b=n,m=c+d;l^=-1;for(var N=c;N<m;N++)l=l>>>8^b[(l^f[N])&255];return l^-1}r.exports=a},{}],46:[function(t,r,i){var s=t("../utils/common"),n=t("./trees"),a=t("./adler32"),l=t("./crc32"),f=t("./messages"),d=0,c=1,b=3,m=4,N=5,w=0,h=1,v=-2,g=-3,E=-5,L=-1,y=1,S=2,R=3,I=4,k=0,O=2,H=8,j=9,Z=15,K=8,J=29,he=256,Q=he+1+J,Y=30,ae=19,ye=2*Q+1,re=15,ce=3,Te=258,xe=Te+ce+1,Ne=32,je=42,ze=69,we=73,Me=91,oe=103,ue=113,me=666,_e=1,Ee=2,Re=3,Ie=4,Oe=3;function Ve(u,M){return u.msg=f[M],M}function et(u){return(u<<1)-(u>4?9:0)}function Ke(u){for(var M=u.length;--M>=0;)u[M]=0}function Ae(u){var M=u.state,V=M.pending;V>u.avail_out&&(V=u.avail_out),V!==0&&(s.arraySet(u.output,M.pending_buf,M.pending_out,V,u.next_out),u.next_out+=V,M.pending_out+=V,u.total_out+=V,u.avail_out-=V,M.pending-=V,M.pending===0&&(M.pending_out=0))}function Se(u,M){n._tr_flush_block(u,u.block_start>=0?u.block_start:-1,u.strstart-u.block_start,M),u.block_start=u.strstart,Ae(u.strm)}function De(u,M){u.pending_buf[u.pending++]=M}function nt(u,M){u.pending_buf[u.pending++]=M>>>8&255,u.pending_buf[u.pending++]=M&255}function pt(u,M,V,_){var B=u.avail_in;return B>_&&(B=_),B===0?0:(u.avail_in-=B,s.arraySet(M,u.input,u.next_in,B,V),u.state.wrap===1?u.adler=a(u.adler,M,B,V):u.state.wrap===2&&(u.adler=l(u.adler,M,B,V)),u.next_in+=B,u.total_in+=B,B)}function lt(u,M){var V=u.max_chain_length,_=u.strstart,B,G,ge=u.prev_length,fe=u.nice_match,de=u.strstart>u.w_size-xe?u.strstart-(u.w_size-xe):0,Ce=u.window,Xe=u.w_mask,Ue=u.prev,ke=u.strstart+Te,Le=Ce[_+ge-1],Je=Ce[_+ge];u.prev_length>=u.good_match&&(V>>=2),fe>u.lookahead&&(fe=u.lookahead);do if(B=M,!(Ce[B+ge]!==Je||Ce[B+ge-1]!==Le||Ce[B]!==Ce[_]||Ce[++B]!==Ce[_+1])){_+=2,B++;do;while(Ce[++_]===Ce[++B]&&Ce[++_]===Ce[++B]&&Ce[++_]===Ce[++B]&&Ce[++_]===Ce[++B]&&Ce[++_]===Ce[++B]&&Ce[++_]===Ce[++B]&&Ce[++_]===Ce[++B]&&Ce[++_]===Ce[++B]&&_<ke);if(G=Te-(ke-_),_=ke-Te,G>ge){if(u.match_start=M,ge=G,G>=fe)break;Le=Ce[_+ge-1],Je=Ce[_+ge]}}while((M=Ue[M&Xe])>de&&--V!==0);return ge<=u.lookahead?ge:u.lookahead}function tt(u){var M=u.w_size,V,_,B,G,ge;do{if(G=u.window_size-u.lookahead-u.strstart,u.strstart>=M+(M-xe)){s.arraySet(u.window,u.window,M,M,0),u.match_start-=M,u.strstart-=M,u.block_start-=M,_=u.hash_size,V=_;do B=u.head[--V],u.head[V]=B>=M?B-M:0;while(--_);_=M,V=_;do B=u.prev[--V],u.prev[V]=B>=M?B-M:0;while(--_);G+=M}if(u.strm.avail_in===0)break;if(_=pt(u.strm,u.window,u.strstart+u.lookahead,G),u.lookahead+=_,u.lookahead+u.insert>=ce)for(ge=u.strstart-u.insert,u.ins_h=u.window[ge],u.ins_h=(u.ins_h<<u.hash_shift^u.window[ge+1])&u.hash_mask;u.insert&&(u.ins_h=(u.ins_h<<u.hash_shift^u.window[ge+ce-1])&u.hash_mask,u.prev[ge&u.w_mask]=u.head[u.ins_h],u.head[u.ins_h]=ge,ge++,u.insert--,!(u.lookahead+u.insert<ce)););}while(u.lookahead<xe&&u.strm.avail_in!==0)}function vt(u,M){var V=65535;for(V>u.pending_buf_size-5&&(V=u.pending_buf_size-5);;){if(u.lookahead<=1){if(tt(u),u.lookahead===0&&M===d)return _e;if(u.lookahead===0)break}u.strstart+=u.lookahead,u.lookahead=0;var _=u.block_start+V;if((u.strstart===0||u.strstart>=_)&&(u.lookahead=u.strstart-_,u.strstart=_,Se(u,!1),u.strm.avail_out===0)||u.strstart-u.block_start>=u.w_size-xe&&(Se(u,!1),u.strm.avail_out===0))return _e}return u.insert=0,M===m?(Se(u,!0),u.strm.avail_out===0?Re:Ie):(u.strstart>u.block_start&&(Se(u,!1),u.strm.avail_out===0),_e)}function ft(u,M){for(var V,_;;){if(u.lookahead<xe){if(tt(u),u.lookahead<xe&&M===d)return _e;if(u.lookahead===0)break}if(V=0,u.lookahead>=ce&&(u.ins_h=(u.ins_h<<u.hash_shift^u.window[u.strstart+ce-1])&u.hash_mask,V=u.prev[u.strstart&u.w_mask]=u.head[u.ins_h],u.head[u.ins_h]=u.strstart),V!==0&&u.strstart-V<=u.w_size-xe&&(u.match_length=lt(u,V)),u.match_length>=ce)if(_=n._tr_tally(u,u.strstart-u.match_start,u.match_length-ce),u.lookahead-=u.match_length,u.match_length<=u.max_lazy_match&&u.lookahead>=ce){u.match_length--;do u.strstart++,u.ins_h=(u.ins_h<<u.hash_shift^u.window[u.strstart+ce-1])&u.hash_mask,V=u.prev[u.strstart&u.w_mask]=u.head[u.ins_h],u.head[u.ins_h]=u.strstart;while(--u.match_length!==0);u.strstart++}else u.strstart+=u.match_length,u.match_length=0,u.ins_h=u.window[u.strstart],u.ins_h=(u.ins_h<<u.hash_shift^u.window[u.strstart+1])&u.hash_mask;else _=n._tr_tally(u,0,u.window[u.strstart]),u.lookahead--,u.strstart++;if(_&&(Se(u,!1),u.strm.avail_out===0))return _e}return u.insert=u.strstart<ce-1?u.strstart:ce-1,M===m?(Se(u,!0),u.strm.avail_out===0?Re:Ie):u.last_lit&&(Se(u,!1),u.strm.avail_out===0)?_e:Ee}function at(u,M){for(var V,_,B;;){if(u.lookahead<xe){if(tt(u),u.lookahead<xe&&M===d)return _e;if(u.lookahead===0)break}if(V=0,u.lookahead>=ce&&(u.ins_h=(u.ins_h<<u.hash_shift^u.window[u.strstart+ce-1])&u.hash_mask,V=u.prev[u.strstart&u.w_mask]=u.head[u.ins_h],u.head[u.ins_h]=u.strstart),u.prev_length=u.match_length,u.prev_match=u.match_start,u.match_length=ce-1,V!==0&&u.prev_length<u.max_lazy_match&&u.strstart-V<=u.w_size-xe&&(u.match_length=lt(u,V),u.match_length<=5&&(u.strategy===y||u.match_length===ce&&u.strstart-u.match_start>4096)&&(u.match_length=ce-1)),u.prev_length>=ce&&u.match_length<=u.prev_length){B=u.strstart+u.lookahead-ce,_=n._tr_tally(u,u.strstart-1-u.prev_match,u.prev_length-ce),u.lookahead-=u.prev_length-1,u.prev_length-=2;do++u.strstart<=B&&(u.ins_h=(u.ins_h<<u.hash_shift^u.window[u.strstart+ce-1])&u.hash_mask,V=u.prev[u.strstart&u.w_mask]=u.head[u.ins_h],u.head[u.ins_h]=u.strstart);while(--u.prev_length!==0);if(u.match_available=0,u.match_length=ce-1,u.strstart++,_&&(Se(u,!1),u.strm.avail_out===0))return _e}else if(u.match_available){if(_=n._tr_tally(u,0,u.window[u.strstart-1]),_&&Se(u,!1),u.strstart++,u.lookahead--,u.strm.avail_out===0)return _e}else u.match_available=1,u.strstart++,u.lookahead--}return u.match_available&&(_=n._tr_tally(u,0,u.window[u.strstart-1]),u.match_available=0),u.insert=u.strstart<ce-1?u.strstart:ce-1,M===m?(Se(u,!0),u.strm.avail_out===0?Re:Ie):u.last_lit&&(Se(u,!1),u.strm.avail_out===0)?_e:Ee}function ct(u,M){for(var V,_,B,G,ge=u.window;;){if(u.lookahead<=Te){if(tt(u),u.lookahead<=Te&&M===d)return _e;if(u.lookahead===0)break}if(u.match_length=0,u.lookahead>=ce&&u.strstart>0&&(B=u.strstart-1,_=ge[B],_===ge[++B]&&_===ge[++B]&&_===ge[++B])){G=u.strstart+Te;do;while(_===ge[++B]&&_===ge[++B]&&_===ge[++B]&&_===ge[++B]&&_===ge[++B]&&_===ge[++B]&&_===ge[++B]&&_===ge[++B]&&B<G);u.match_length=Te-(G-B),u.match_length>u.lookahead&&(u.match_length=u.lookahead)}if(u.match_length>=ce?(V=n._tr_tally(u,1,u.match_length-ce),u.lookahead-=u.match_length,u.strstart+=u.match_length,u.match_length=0):(V=n._tr_tally(u,0,u.window[u.strstart]),u.lookahead--,u.strstart++),V&&(Se(u,!1),u.strm.avail_out===0))return _e}return u.insert=0,M===m?(Se(u,!0),u.strm.avail_out===0?Re:Ie):u.last_lit&&(Se(u,!1),u.strm.avail_out===0)?_e:Ee}function ht(u,M){for(var V;;){if(u.lookahead===0&&(tt(u),u.lookahead===0)){if(M===d)return _e;break}if(u.match_length=0,V=n._tr_tally(u,0,u.window[u.strstart]),u.lookahead--,u.strstart++,V&&(Se(u,!1),u.strm.avail_out===0))return _e}return u.insert=0,M===m?(Se(u,!0),u.strm.avail_out===0?Re:Ie):u.last_lit&&(Se(u,!1),u.strm.avail_out===0)?_e:Ee}function Ze(u,M,V,_,B){this.good_length=u,this.max_lazy=M,this.nice_length=V,this.max_chain=_,this.func=B}var ot;ot=[new Ze(0,0,0,0,vt),new Ze(4,4,8,4,ft),new Ze(4,5,16,8,ft),new Ze(4,6,32,32,ft),new Ze(4,4,16,16,at),new Ze(8,16,32,32,at),new Ze(8,16,128,128,at),new Ze(8,32,128,256,at),new Ze(32,128,258,1024,at),new Ze(32,258,258,4096,at)];function wt(u){u.window_size=2*u.w_size,Ke(u.head),u.max_lazy_match=ot[u.level].max_lazy,u.good_match=ot[u.level].good_length,u.nice_match=ot[u.level].nice_length,u.max_chain_length=ot[u.level].max_chain,u.strstart=0,u.block_start=0,u.lookahead=0,u.insert=0,u.match_length=u.prev_length=ce-1,u.match_available=0,u.ins_h=0}function C(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=H,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new s.Buf16(ye*2),this.dyn_dtree=new s.Buf16((2*Y+1)*2),this.bl_tree=new s.Buf16((2*ae+1)*2),Ke(this.dyn_ltree),Ke(this.dyn_dtree),Ke(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new s.Buf16(re+1),this.heap=new s.Buf16(2*Q+1),Ke(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new s.Buf16(2*Q+1),Ke(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function $(u){var M;return!u||!u.state?Ve(u,v):(u.total_in=u.total_out=0,u.data_type=O,M=u.state,M.pending=0,M.pending_out=0,M.wrap<0&&(M.wrap=-M.wrap),M.status=M.wrap?je:ue,u.adler=M.wrap===2?0:1,M.last_flush=d,n._tr_init(M),w)}function te(u){var M=$(u);return M===w&&wt(u.state),M}function ve(u,M){return!u||!u.state||u.state.wrap!==2?v:(u.state.gzhead=M,w)}function P(u,M,V,_,B,G){if(!u)return v;var ge=1;if(M===L&&(M=6),_<0?(ge=0,_=-_):_>15&&(ge=2,_-=16),B<1||B>j||V!==H||_<8||_>15||M<0||M>9||G<0||G>I)return Ve(u,v);_===8&&(_=9);var fe=new C;return u.state=fe,fe.strm=u,fe.wrap=ge,fe.gzhead=null,fe.w_bits=_,fe.w_size=1<<fe.w_bits,fe.w_mask=fe.w_size-1,fe.hash_bits=B+7,fe.hash_size=1<<fe.hash_bits,fe.hash_mask=fe.hash_size-1,fe.hash_shift=~~((fe.hash_bits+ce-1)/ce),fe.window=new s.Buf8(fe.w_size*2),fe.head=new s.Buf16(fe.hash_size),fe.prev=new s.Buf16(fe.w_size),fe.lit_bufsize=1<<B+6,fe.pending_buf_size=fe.lit_bufsize*4,fe.pending_buf=new s.Buf8(fe.pending_buf_size),fe.d_buf=1*fe.lit_bufsize,fe.l_buf=3*fe.lit_bufsize,fe.level=M,fe.strategy=G,fe.method=V,te(u)}function p(u,M){return P(u,M,H,Z,K,k)}function o(u,M){var V,_,B,G;if(!u||!u.state||M>N||M<0)return u?Ve(u,v):v;if(_=u.state,!u.output||!u.input&&u.avail_in!==0||_.status===me&&M!==m)return Ve(u,u.avail_out===0?E:v);if(_.strm=u,V=_.last_flush,_.last_flush=M,_.status===je)if(_.wrap===2)u.adler=0,De(_,31),De(_,139),De(_,8),_.gzhead?(De(_,(_.gzhead.text?1:0)+(_.gzhead.hcrc?2:0)+(_.gzhead.extra?4:0)+(_.gzhead.name?8:0)+(_.gzhead.comment?16:0)),De(_,_.gzhead.time&255),De(_,_.gzhead.time>>8&255),De(_,_.gzhead.time>>16&255),De(_,_.gzhead.time>>24&255),De(_,_.level===9?2:_.strategy>=S||_.level<2?4:0),De(_,_.gzhead.os&255),_.gzhead.extra&&_.gzhead.extra.length&&(De(_,_.gzhead.extra.length&255),De(_,_.gzhead.extra.length>>8&255)),_.gzhead.hcrc&&(u.adler=l(u.adler,_.pending_buf,_.pending,0)),_.gzindex=0,_.status=ze):(De(_,0),De(_,0),De(_,0),De(_,0),De(_,0),De(_,_.level===9?2:_.strategy>=S||_.level<2?4:0),De(_,Oe),_.status=ue);else{var ge=H+(_.w_bits-8<<4)<<8,fe=-1;_.strategy>=S||_.level<2?fe=0:_.level<6?fe=1:_.level===6?fe=2:fe=3,ge|=fe<<6,_.strstart!==0&&(ge|=Ne),ge+=31-ge%31,_.status=ue,nt(_,ge),_.strstart!==0&&(nt(_,u.adler>>>16),nt(_,u.adler&65535)),u.adler=1}if(_.status===ze)if(_.gzhead.extra){for(B=_.pending;_.gzindex<(_.gzhead.extra.length&65535)&&!(_.pending===_.pending_buf_size&&(_.gzhead.hcrc&&_.pending>B&&(u.adler=l(u.adler,_.pending_buf,_.pending-B,B)),Ae(u),B=_.pending,_.pending===_.pending_buf_size));)De(_,_.gzhead.extra[_.gzindex]&255),_.gzindex++;_.gzhead.hcrc&&_.pending>B&&(u.adler=l(u.adler,_.pending_buf,_.pending-B,B)),_.gzindex===_.gzhead.extra.length&&(_.gzindex=0,_.status=we)}else _.status=we;if(_.status===we)if(_.gzhead.name){B=_.pending;do{if(_.pending===_.pending_buf_size&&(_.gzhead.hcrc&&_.pending>B&&(u.adler=l(u.adler,_.pending_buf,_.pending-B,B)),Ae(u),B=_.pending,_.pending===_.pending_buf_size)){G=1;break}_.gzindex<_.gzhead.name.length?G=_.gzhead.name.charCodeAt(_.gzindex++)&255:G=0,De(_,G)}while(G!==0);_.gzhead.hcrc&&_.pending>B&&(u.adler=l(u.adler,_.pending_buf,_.pending-B,B)),G===0&&(_.gzindex=0,_.status=Me)}else _.status=Me;if(_.status===Me)if(_.gzhead.comment){B=_.pending;do{if(_.pending===_.pending_buf_size&&(_.gzhead.hcrc&&_.pending>B&&(u.adler=l(u.adler,_.pending_buf,_.pending-B,B)),Ae(u),B=_.pending,_.pending===_.pending_buf_size)){G=1;break}_.gzindex<_.gzhead.comment.length?G=_.gzhead.comment.charCodeAt(_.gzindex++)&255:G=0,De(_,G)}while(G!==0);_.gzhead.hcrc&&_.pending>B&&(u.adler=l(u.adler,_.pending_buf,_.pending-B,B)),G===0&&(_.status=oe)}else _.status=oe;if(_.status===oe&&(_.gzhead.hcrc?(_.pending+2>_.pending_buf_size&&Ae(u),_.pending+2<=_.pending_buf_size&&(De(_,u.adler&255),De(_,u.adler>>8&255),u.adler=0,_.status=ue)):_.status=ue),_.pending!==0){if(Ae(u),u.avail_out===0)return _.last_flush=-1,w}else if(u.avail_in===0&&et(M)<=et(V)&&M!==m)return Ve(u,E);if(_.status===me&&u.avail_in!==0)return Ve(u,E);if(u.avail_in!==0||_.lookahead!==0||M!==d&&_.status!==me){var de=_.strategy===S?ht(_,M):_.strategy===R?ct(_,M):ot[_.level].func(_,M);if((de===Re||de===Ie)&&(_.status=me),de===_e||de===Re)return u.avail_out===0&&(_.last_flush=-1),w;if(de===Ee&&(M===c?n._tr_align(_):M!==N&&(n._tr_stored_block(_,0,0,!1),M===b&&(Ke(_.head),_.lookahead===0&&(_.strstart=0,_.block_start=0,_.insert=0))),Ae(u),u.avail_out===0))return _.last_flush=-1,w}return M!==m?w:_.wrap<=0?h:(_.wrap===2?(De(_,u.adler&255),De(_,u.adler>>8&255),De(_,u.adler>>16&255),De(_,u.adler>>24&255),De(_,u.total_in&255),De(_,u.total_in>>8&255),De(_,u.total_in>>16&255),De(_,u.total_in>>24&255)):(nt(_,u.adler>>>16),nt(_,u.adler&65535)),Ae(u),_.wrap>0&&(_.wrap=-_.wrap),_.pending!==0?w:h)}function D(u){var M;return!u||!u.state?v:(M=u.state.status,M!==je&&M!==ze&&M!==we&&M!==Me&&M!==oe&&M!==ue&&M!==me?Ve(u,v):(u.state=null,M===ue?Ve(u,g):w))}function z(u,M){var V=M.length,_,B,G,ge,fe,de,Ce,Xe;if(!u||!u.state||(_=u.state,ge=_.wrap,ge===2||ge===1&&_.status!==je||_.lookahead))return v;for(ge===1&&(u.adler=a(u.adler,M,V,0)),_.wrap=0,V>=_.w_size&&(ge===0&&(Ke(_.head),_.strstart=0,_.block_start=0,_.insert=0),Xe=new s.Buf8(_.w_size),s.arraySet(Xe,M,V-_.w_size,_.w_size,0),M=Xe,V=_.w_size),fe=u.avail_in,de=u.next_in,Ce=u.input,u.avail_in=V,u.next_in=0,u.input=M,tt(_);_.lookahead>=ce;){B=_.strstart,G=_.lookahead-(ce-1);do _.ins_h=(_.ins_h<<_.hash_shift^_.window[B+ce-1])&_.hash_mask,_.prev[B&_.w_mask]=_.head[_.ins_h],_.head[_.ins_h]=B,B++;while(--G);_.strstart=B,_.lookahead=ce-1,tt(_)}return _.strstart+=_.lookahead,_.block_start=_.strstart,_.insert=_.lookahead,_.lookahead=0,_.match_length=_.prev_length=ce-1,_.match_available=0,u.next_in=de,u.input=Ce,u.avail_in=fe,_.wrap=ge,w}i.deflateInit=p,i.deflateInit2=P,i.deflateReset=te,i.deflateResetKeep=$,i.deflateSetHeader=ve,i.deflate=o,i.deflateEnd=D,i.deflateSetDictionary=z,i.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(t,r,i){function s(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}r.exports=s},{}],48:[function(t,r,i){var s=30,n=12;r.exports=function(l,f){var d,c,b,m,N,w,h,v,g,E,L,y,S,R,I,k,O,H,j,Z,K,J,he,Q,Y;d=l.state,c=l.next_in,Q=l.input,b=c+(l.avail_in-5),m=l.next_out,Y=l.output,N=m-(f-l.avail_out),w=m+(l.avail_out-257),h=d.dmax,v=d.wsize,g=d.whave,E=d.wnext,L=d.window,y=d.hold,S=d.bits,R=d.lencode,I=d.distcode,k=(1<<d.lenbits)-1,O=(1<<d.distbits)-1;e:do{S<15&&(y+=Q[c++]<<S,S+=8,y+=Q[c++]<<S,S+=8),H=R[y&k];t:for(;;){if(j=H>>>24,y>>>=j,S-=j,j=H>>>16&255,j===0)Y[m++]=H&65535;else if(j&16){Z=H&65535,j&=15,j&&(S<j&&(y+=Q[c++]<<S,S+=8),Z+=y&(1<<j)-1,y>>>=j,S-=j),S<15&&(y+=Q[c++]<<S,S+=8,y+=Q[c++]<<S,S+=8),H=I[y&O];r:for(;;){if(j=H>>>24,y>>>=j,S-=j,j=H>>>16&255,j&16){if(K=H&65535,j&=15,S<j&&(y+=Q[c++]<<S,S+=8,S<j&&(y+=Q[c++]<<S,S+=8)),K+=y&(1<<j)-1,K>h){l.msg="invalid distance too far back",d.mode=s;break e}if(y>>>=j,S-=j,j=m-N,K>j){if(j=K-j,j>g&&d.sane){l.msg="invalid distance too far back",d.mode=s;break e}if(J=0,he=L,E===0){if(J+=v-j,j<Z){Z-=j;do Y[m++]=L[J++];while(--j);J=m-K,he=Y}}else if(E<j){if(J+=v+E-j,j-=E,j<Z){Z-=j;do Y[m++]=L[J++];while(--j);if(J=0,E<Z){j=E,Z-=j;do Y[m++]=L[J++];while(--j);J=m-K,he=Y}}}else if(J+=E-j,j<Z){Z-=j;do Y[m++]=L[J++];while(--j);J=m-K,he=Y}for(;Z>2;)Y[m++]=he[J++],Y[m++]=he[J++],Y[m++]=he[J++],Z-=3;Z&&(Y[m++]=he[J++],Z>1&&(Y[m++]=he[J++]))}else{J=m-K;do Y[m++]=Y[J++],Y[m++]=Y[J++],Y[m++]=Y[J++],Z-=3;while(Z>2);Z&&(Y[m++]=Y[J++],Z>1&&(Y[m++]=Y[J++]))}}else if((j&64)===0){H=I[(H&65535)+(y&(1<<j)-1)];continue r}else{l.msg="invalid distance code",d.mode=s;break e}break}}else if((j&64)===0){H=R[(H&65535)+(y&(1<<j)-1)];continue t}else if(j&32){d.mode=n;break e}else{l.msg="invalid literal/length code",d.mode=s;break e}break}}while(c<b&&m<w);Z=S>>3,c-=Z,S-=Z<<3,y&=(1<<S)-1,l.next_in=c,l.next_out=m,l.avail_in=c<b?5+(b-c):5-(c-b),l.avail_out=m<w?257+(w-m):257-(m-w),d.hold=y,d.bits=S}},{}],49:[function(t,r,i){var s=t("../utils/common"),n=t("./adler32"),a=t("./crc32"),l=t("./inffast"),f=t("./inftrees"),d=0,c=1,b=2,m=4,N=5,w=6,h=0,v=1,g=2,E=-2,L=-3,y=-4,S=-5,R=8,I=1,k=2,O=3,H=4,j=5,Z=6,K=7,J=8,he=9,Q=10,Y=11,ae=12,ye=13,re=14,ce=15,Te=16,xe=17,Ne=18,je=19,ze=20,we=21,Me=22,oe=23,ue=24,me=25,_e=26,Ee=27,Re=28,Ie=29,Oe=30,Ve=31,et=32,Ke=852,Ae=592,Se=15,De=Se;function nt(P){return(P>>>24&255)+(P>>>8&65280)+((P&65280)<<8)+((P&255)<<24)}function pt(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new s.Buf16(320),this.work=new s.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function lt(P){var p;return!P||!P.state?E:(p=P.state,P.total_in=P.total_out=p.total=0,P.msg="",p.wrap&&(P.adler=p.wrap&1),p.mode=I,p.last=0,p.havedict=0,p.dmax=32768,p.head=null,p.hold=0,p.bits=0,p.lencode=p.lendyn=new s.Buf32(Ke),p.distcode=p.distdyn=new s.Buf32(Ae),p.sane=1,p.back=-1,h)}function tt(P){var p;return!P||!P.state?E:(p=P.state,p.wsize=0,p.whave=0,p.wnext=0,lt(P))}function vt(P,p){var o,D;return!P||!P.state||(D=P.state,p<0?(o=0,p=-p):(o=(p>>4)+1,p<48&&(p&=15)),p&&(p<8||p>15))?E:(D.window!==null&&D.wbits!==p&&(D.window=null),D.wrap=o,D.wbits=p,tt(P))}function ft(P,p){var o,D;return P?(D=new pt,P.state=D,D.window=null,o=vt(P,p),o!==h&&(P.state=null),o):E}function at(P){return ft(P,De)}var ct=!0,ht,Ze;function ot(P){if(ct){var p;for(ht=new s.Buf32(512),Ze=new s.Buf32(32),p=0;p<144;)P.lens[p++]=8;for(;p<256;)P.lens[p++]=9;for(;p<280;)P.lens[p++]=7;for(;p<288;)P.lens[p++]=8;for(f(c,P.lens,0,288,ht,0,P.work,{bits:9}),p=0;p<32;)P.lens[p++]=5;f(b,P.lens,0,32,Ze,0,P.work,{bits:5}),ct=!1}P.lencode=ht,P.lenbits=9,P.distcode=Ze,P.distbits=5}function wt(P,p,o,D){var z,u=P.state;return u.window===null&&(u.wsize=1<<u.wbits,u.wnext=0,u.whave=0,u.window=new s.Buf8(u.wsize)),D>=u.wsize?(s.arraySet(u.window,p,o-u.wsize,u.wsize,0),u.wnext=0,u.whave=u.wsize):(z=u.wsize-u.wnext,z>D&&(z=D),s.arraySet(u.window,p,o-D,z,u.wnext),D-=z,D?(s.arraySet(u.window,p,o-D,D,0),u.wnext=D,u.whave=u.wsize):(u.wnext+=z,u.wnext===u.wsize&&(u.wnext=0),u.whave<u.wsize&&(u.whave+=z))),0}function C(P,p){var o,D,z,u,M,V,_,B,G,ge,fe,de,Ce,Xe,Ue=0,ke,Le,Je,Ge,Tt,Ft,Ye,dt,st=new s.Buf8(4),_t,gt,ir=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!P||!P.state||!P.output||!P.input&&P.avail_in!==0)return E;o=P.state,o.mode===ae&&(o.mode=ye),M=P.next_out,z=P.output,_=P.avail_out,u=P.next_in,D=P.input,V=P.avail_in,B=o.hold,G=o.bits,ge=V,fe=_,dt=h;e:for(;;)switch(o.mode){case I:if(o.wrap===0){o.mode=ye;break}for(;G<16;){if(V===0)break e;V--,B+=D[u++]<<G,G+=8}if(o.wrap&2&&B===35615){o.check=0,st[0]=B&255,st[1]=B>>>8&255,o.check=a(o.check,st,2,0),B=0,G=0,o.mode=k;break}if(o.flags=0,o.head&&(o.head.done=!1),!(o.wrap&1)||(((B&255)<<8)+(B>>8))%31){P.msg="incorrect header check",o.mode=Oe;break}if((B&15)!==R){P.msg="unknown compression method",o.mode=Oe;break}if(B>>>=4,G-=4,Ye=(B&15)+8,o.wbits===0)o.wbits=Ye;else if(Ye>o.wbits){P.msg="invalid window size",o.mode=Oe;break}o.dmax=1<<Ye,P.adler=o.check=1,o.mode=B&512?Q:ae,B=0,G=0;break;case k:for(;G<16;){if(V===0)break e;V--,B+=D[u++]<<G,G+=8}if(o.flags=B,(o.flags&255)!==R){P.msg="unknown compression method",o.mode=Oe;break}if(o.flags&57344){P.msg="unknown header flags set",o.mode=Oe;break}o.head&&(o.head.text=B>>8&1),o.flags&512&&(st[0]=B&255,st[1]=B>>>8&255,o.check=a(o.check,st,2,0)),B=0,G=0,o.mode=O;case O:for(;G<32;){if(V===0)break e;V--,B+=D[u++]<<G,G+=8}o.head&&(o.head.time=B),o.flags&512&&(st[0]=B&255,st[1]=B>>>8&255,st[2]=B>>>16&255,st[3]=B>>>24&255,o.check=a(o.check,st,4,0)),B=0,G=0,o.mode=H;case H:for(;G<16;){if(V===0)break e;V--,B+=D[u++]<<G,G+=8}o.head&&(o.head.xflags=B&255,o.head.os=B>>8),o.flags&512&&(st[0]=B&255,st[1]=B>>>8&255,o.check=a(o.check,st,2,0)),B=0,G=0,o.mode=j;case j:if(o.flags&1024){for(;G<16;){if(V===0)break e;V--,B+=D[u++]<<G,G+=8}o.length=B,o.head&&(o.head.extra_len=B),o.flags&512&&(st[0]=B&255,st[1]=B>>>8&255,o.check=a(o.check,st,2,0)),B=0,G=0}else o.head&&(o.head.extra=null);o.mode=Z;case Z:if(o.flags&1024&&(de=o.length,de>V&&(de=V),de&&(o.head&&(Ye=o.head.extra_len-o.length,o.head.extra||(o.head.extra=new Array(o.head.extra_len)),s.arraySet(o.head.extra,D,u,de,Ye)),o.flags&512&&(o.check=a(o.check,D,de,u)),V-=de,u+=de,o.length-=de),o.length))break e;o.length=0,o.mode=K;case K:if(o.flags&2048){if(V===0)break e;de=0;do Ye=D[u+de++],o.head&&Ye&&o.length<65536&&(o.head.name+=String.fromCharCode(Ye));while(Ye&&de<V);if(o.flags&512&&(o.check=a(o.check,D,de,u)),V-=de,u+=de,Ye)break e}else o.head&&(o.head.name=null);o.length=0,o.mode=J;case J:if(o.flags&4096){if(V===0)break e;de=0;do Ye=D[u+de++],o.head&&Ye&&o.length<65536&&(o.head.comment+=String.fromCharCode(Ye));while(Ye&&de<V);if(o.flags&512&&(o.check=a(o.check,D,de,u)),V-=de,u+=de,Ye)break e}else o.head&&(o.head.comment=null);o.mode=he;case he:if(o.flags&512){for(;G<16;){if(V===0)break e;V--,B+=D[u++]<<G,G+=8}if(B!==(o.check&65535)){P.msg="header crc mismatch",o.mode=Oe;break}B=0,G=0}o.head&&(o.head.hcrc=o.flags>>9&1,o.head.done=!0),P.adler=o.check=0,o.mode=ae;break;case Q:for(;G<32;){if(V===0)break e;V--,B+=D[u++]<<G,G+=8}P.adler=o.check=nt(B),B=0,G=0,o.mode=Y;case Y:if(o.havedict===0)return P.next_out=M,P.avail_out=_,P.next_in=u,P.avail_in=V,o.hold=B,o.bits=G,g;P.adler=o.check=1,o.mode=ae;case ae:if(p===N||p===w)break e;case ye:if(o.last){B>>>=G&7,G-=G&7,o.mode=Ee;break}for(;G<3;){if(V===0)break e;V--,B+=D[u++]<<G,G+=8}switch(o.last=B&1,B>>>=1,G-=1,B&3){case 0:o.mode=re;break;case 1:if(ot(o),o.mode=ze,p===w){B>>>=2,G-=2;break e}break;case 2:o.mode=xe;break;case 3:P.msg="invalid block type",o.mode=Oe}B>>>=2,G-=2;break;case re:for(B>>>=G&7,G-=G&7;G<32;){if(V===0)break e;V--,B+=D[u++]<<G,G+=8}if((B&65535)!==(B>>>16^65535)){P.msg="invalid stored block lengths",o.mode=Oe;break}if(o.length=B&65535,B=0,G=0,o.mode=ce,p===w)break e;case ce:o.mode=Te;case Te:if(de=o.length,de){if(de>V&&(de=V),de>_&&(de=_),de===0)break e;s.arraySet(z,D,u,de,M),V-=de,u+=de,_-=de,M+=de,o.length-=de;break}o.mode=ae;break;case xe:for(;G<14;){if(V===0)break e;V--,B+=D[u++]<<G,G+=8}if(o.nlen=(B&31)+257,B>>>=5,G-=5,o.ndist=(B&31)+1,B>>>=5,G-=5,o.ncode=(B&15)+4,B>>>=4,G-=4,o.nlen>286||o.ndist>30){P.msg="too many length or distance symbols",o.mode=Oe;break}o.have=0,o.mode=Ne;case Ne:for(;o.have<o.ncode;){for(;G<3;){if(V===0)break e;V--,B+=D[u++]<<G,G+=8}o.lens[ir[o.have++]]=B&7,B>>>=3,G-=3}for(;o.have<19;)o.lens[ir[o.have++]]=0;if(o.lencode=o.lendyn,o.lenbits=7,_t={bits:o.lenbits},dt=f(d,o.lens,0,19,o.lencode,0,o.work,_t),o.lenbits=_t.bits,dt){P.msg="invalid code lengths set",o.mode=Oe;break}o.have=0,o.mode=je;case je:for(;o.have<o.nlen+o.ndist;){for(;Ue=o.lencode[B&(1<<o.lenbits)-1],ke=Ue>>>24,Le=Ue>>>16&255,Je=Ue&65535,!(ke<=G);){if(V===0)break e;V--,B+=D[u++]<<G,G+=8}if(Je<16)B>>>=ke,G-=ke,o.lens[o.have++]=Je;else{if(Je===16){for(gt=ke+2;G<gt;){if(V===0)break e;V--,B+=D[u++]<<G,G+=8}if(B>>>=ke,G-=ke,o.have===0){P.msg="invalid bit length repeat",o.mode=Oe;break}Ye=o.lens[o.have-1],de=3+(B&3),B>>>=2,G-=2}else if(Je===17){for(gt=ke+3;G<gt;){if(V===0)break e;V--,B+=D[u++]<<G,G+=8}B>>>=ke,G-=ke,Ye=0,de=3+(B&7),B>>>=3,G-=3}else{for(gt=ke+7;G<gt;){if(V===0)break e;V--,B+=D[u++]<<G,G+=8}B>>>=ke,G-=ke,Ye=0,de=11+(B&127),B>>>=7,G-=7}if(o.have+de>o.nlen+o.ndist){P.msg="invalid bit length repeat",o.mode=Oe;break}for(;de--;)o.lens[o.have++]=Ye}}if(o.mode===Oe)break;if(o.lens[256]===0){P.msg="invalid code -- missing end-of-block",o.mode=Oe;break}if(o.lenbits=9,_t={bits:o.lenbits},dt=f(c,o.lens,0,o.nlen,o.lencode,0,o.work,_t),o.lenbits=_t.bits,dt){P.msg="invalid literal/lengths set",o.mode=Oe;break}if(o.distbits=6,o.distcode=o.distdyn,_t={bits:o.distbits},dt=f(b,o.lens,o.nlen,o.ndist,o.distcode,0,o.work,_t),o.distbits=_t.bits,dt){P.msg="invalid distances set",o.mode=Oe;break}if(o.mode=ze,p===w)break e;case ze:o.mode=we;case we:if(V>=6&&_>=258){P.next_out=M,P.avail_out=_,P.next_in=u,P.avail_in=V,o.hold=B,o.bits=G,l(P,fe),M=P.next_out,z=P.output,_=P.avail_out,u=P.next_in,D=P.input,V=P.avail_in,B=o.hold,G=o.bits,o.mode===ae&&(o.back=-1);break}for(o.back=0;Ue=o.lencode[B&(1<<o.lenbits)-1],ke=Ue>>>24,Le=Ue>>>16&255,Je=Ue&65535,!(ke<=G);){if(V===0)break e;V--,B+=D[u++]<<G,G+=8}if(Le&&(Le&240)===0){for(Ge=ke,Tt=Le,Ft=Je;Ue=o.lencode[Ft+((B&(1<<Ge+Tt)-1)>>Ge)],ke=Ue>>>24,Le=Ue>>>16&255,Je=Ue&65535,!(Ge+ke<=G);){if(V===0)break e;V--,B+=D[u++]<<G,G+=8}B>>>=Ge,G-=Ge,o.back+=Ge}if(B>>>=ke,G-=ke,o.back+=ke,o.length=Je,Le===0){o.mode=_e;break}if(Le&32){o.back=-1,o.mode=ae;break}if(Le&64){P.msg="invalid literal/length code",o.mode=Oe;break}o.extra=Le&15,o.mode=Me;case Me:if(o.extra){for(gt=o.extra;G<gt;){if(V===0)break e;V--,B+=D[u++]<<G,G+=8}o.length+=B&(1<<o.extra)-1,B>>>=o.extra,G-=o.extra,o.back+=o.extra}o.was=o.length,o.mode=oe;case oe:for(;Ue=o.distcode[B&(1<<o.distbits)-1],ke=Ue>>>24,Le=Ue>>>16&255,Je=Ue&65535,!(ke<=G);){if(V===0)break e;V--,B+=D[u++]<<G,G+=8}if((Le&240)===0){for(Ge=ke,Tt=Le,Ft=Je;Ue=o.distcode[Ft+((B&(1<<Ge+Tt)-1)>>Ge)],ke=Ue>>>24,Le=Ue>>>16&255,Je=Ue&65535,!(Ge+ke<=G);){if(V===0)break e;V--,B+=D[u++]<<G,G+=8}B>>>=Ge,G-=Ge,o.back+=Ge}if(B>>>=ke,G-=ke,o.back+=ke,Le&64){P.msg="invalid distance code",o.mode=Oe;break}o.offset=Je,o.extra=Le&15,o.mode=ue;case ue:if(o.extra){for(gt=o.extra;G<gt;){if(V===0)break e;V--,B+=D[u++]<<G,G+=8}o.offset+=B&(1<<o.extra)-1,B>>>=o.extra,G-=o.extra,o.back+=o.extra}if(o.offset>o.dmax){P.msg="invalid distance too far back",o.mode=Oe;break}o.mode=me;case me:if(_===0)break e;if(de=fe-_,o.offset>de){if(de=o.offset-de,de>o.whave&&o.sane){P.msg="invalid distance too far back",o.mode=Oe;break}de>o.wnext?(de-=o.wnext,Ce=o.wsize-de):Ce=o.wnext-de,de>o.length&&(de=o.length),Xe=o.window}else Xe=z,Ce=M-o.offset,de=o.length;de>_&&(de=_),_-=de,o.length-=de;do z[M++]=Xe[Ce++];while(--de);o.length===0&&(o.mode=we);break;case _e:if(_===0)break e;z[M++]=o.length,_--,o.mode=we;break;case Ee:if(o.wrap){for(;G<32;){if(V===0)break e;V--,B|=D[u++]<<G,G+=8}if(fe-=_,P.total_out+=fe,o.total+=fe,fe&&(P.adler=o.check=o.flags?a(o.check,z,fe,M-fe):n(o.check,z,fe,M-fe)),fe=_,(o.flags?B:nt(B))!==o.check){P.msg="incorrect data check",o.mode=Oe;break}B=0,G=0}o.mode=Re;case Re:if(o.wrap&&o.flags){for(;G<32;){if(V===0)break e;V--,B+=D[u++]<<G,G+=8}if(B!==(o.total&4294967295)){P.msg="incorrect length check",o.mode=Oe;break}B=0,G=0}o.mode=Ie;case Ie:dt=v;break e;case Oe:dt=L;break e;case Ve:return y;case et:default:return E}return P.next_out=M,P.avail_out=_,P.next_in=u,P.avail_in=V,o.hold=B,o.bits=G,(o.wsize||fe!==P.avail_out&&o.mode<Oe&&(o.mode<Ee||p!==m))&&wt(P,P.output,P.next_out,fe-P.avail_out),ge-=P.avail_in,fe-=P.avail_out,P.total_in+=ge,P.total_out+=fe,o.total+=fe,o.wrap&&fe&&(P.adler=o.check=o.flags?a(o.check,z,fe,P.next_out-fe):n(o.check,z,fe,P.next_out-fe)),P.data_type=o.bits+(o.last?64:0)+(o.mode===ae?128:0)+(o.mode===ze||o.mode===ce?256:0),(ge===0&&fe===0||p===m)&&dt===h&&(dt=S),dt}function $(P){if(!P||!P.state)return E;var p=P.state;return p.window&&(p.window=null),P.state=null,h}function te(P,p){var o;return!P||!P.state||(o=P.state,(o.wrap&2)===0)?E:(o.head=p,p.done=!1,h)}function ve(P,p){var o=p.length,D,z,u;return!P||!P.state||(D=P.state,D.wrap!==0&&D.mode!==Y)?E:D.mode===Y&&(z=1,z=n(z,p,o,0),z!==D.check)?L:(u=wt(P,p,o,o),u?(D.mode=Ve,y):(D.havedict=1,h))}i.inflateReset=tt,i.inflateReset2=vt,i.inflateResetKeep=lt,i.inflateInit=at,i.inflateInit2=ft,i.inflate=C,i.inflateEnd=$,i.inflateGetHeader=te,i.inflateSetDictionary=ve,i.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(t,r,i){var s=t("../utils/common"),n=15,a=852,l=592,f=0,d=1,c=2,b=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],m=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],N=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],w=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];r.exports=function(v,g,E,L,y,S,R,I){var k=I.bits,O=0,H=0,j=0,Z=0,K=0,J=0,he=0,Q=0,Y=0,ae=0,ye,re,ce,Te,xe,Ne=null,je=0,ze,we=new s.Buf16(n+1),Me=new s.Buf16(n+1),oe=null,ue=0,me,_e,Ee;for(O=0;O<=n;O++)we[O]=0;for(H=0;H<L;H++)we[g[E+H]]++;for(K=k,Z=n;Z>=1&&we[Z]===0;Z--);if(K>Z&&(K=Z),Z===0)return y[S++]=1<<24|64<<16|0,y[S++]=1<<24|64<<16|0,I.bits=1,0;for(j=1;j<Z&&we[j]===0;j++);for(K<j&&(K=j),Q=1,O=1;O<=n;O++)if(Q<<=1,Q-=we[O],Q<0)return-1;if(Q>0&&(v===f||Z!==1))return-1;for(Me[1]=0,O=1;O<n;O++)Me[O+1]=Me[O]+we[O];for(H=0;H<L;H++)g[E+H]!==0&&(R[Me[g[E+H]]++]=H);if(v===f?(Ne=oe=R,ze=19):v===d?(Ne=b,je-=257,oe=m,ue-=257,ze=256):(Ne=N,oe=w,ze=-1),ae=0,H=0,O=j,xe=S,J=K,he=0,ce=-1,Y=1<<K,Te=Y-1,v===d&&Y>a||v===c&&Y>l)return 1;for(;;){me=O-he,R[H]<ze?(_e=0,Ee=R[H]):R[H]>ze?(_e=oe[ue+R[H]],Ee=Ne[je+R[H]]):(_e=96,Ee=0),ye=1<<O-he,re=1<<J,j=re;do re-=ye,y[xe+(ae>>he)+re]=me<<24|_e<<16|Ee|0;while(re!==0);for(ye=1<<O-1;ae&ye;)ye>>=1;if(ye!==0?(ae&=ye-1,ae+=ye):ae=0,H++,--we[O]===0){if(O===Z)break;O=g[E+R[H]]}if(O>K&&(ae&Te)!==ce){for(he===0&&(he=K),xe+=j,J=O-he,Q=1<<J;J+he<Z&&(Q-=we[J+he],!(Q<=0));)J++,Q<<=1;if(Y+=1<<J,v===d&&Y>a||v===c&&Y>l)return 1;ce=ae&Te,y[ce]=K<<24|J<<16|xe-S|0}}return ae!==0&&(y[xe+ae]=O-he<<24|64<<16|0),I.bits=K,0}},{"../utils/common":41}],51:[function(t,r,i){r.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(t,r,i){var s=t("../utils/common"),n=4,a=0,l=1,f=2;function d(C){for(var $=C.length;--$>=0;)C[$]=0}var c=0,b=1,m=2,N=3,w=258,h=29,v=256,g=v+1+h,E=30,L=19,y=2*g+1,S=15,R=16,I=7,k=256,O=16,H=17,j=18,Z=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],K=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],J=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],he=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Q=512,Y=new Array((g+2)*2);d(Y);var ae=new Array(E*2);d(ae);var ye=new Array(Q);d(ye);var re=new Array(w-N+1);d(re);var ce=new Array(h);d(ce);var Te=new Array(E);d(Te);function xe(C,$,te,ve,P){this.static_tree=C,this.extra_bits=$,this.extra_base=te,this.elems=ve,this.max_length=P,this.has_stree=C&&C.length}var Ne,je,ze;function we(C,$){this.dyn_tree=C,this.max_code=0,this.stat_desc=$}function Me(C){return C<256?ye[C]:ye[256+(C>>>7)]}function oe(C,$){C.pending_buf[C.pending++]=$&255,C.pending_buf[C.pending++]=$>>>8&255}function ue(C,$,te){C.bi_valid>R-te?(C.bi_buf|=$<<C.bi_valid&65535,oe(C,C.bi_buf),C.bi_buf=$>>R-C.bi_valid,C.bi_valid+=te-R):(C.bi_buf|=$<<C.bi_valid&65535,C.bi_valid+=te)}function me(C,$,te){ue(C,te[$*2],te[$*2+1])}function _e(C,$){var te=0;do te|=C&1,C>>>=1,te<<=1;while(--$>0);return te>>>1}function Ee(C){C.bi_valid===16?(oe(C,C.bi_buf),C.bi_buf=0,C.bi_valid=0):C.bi_valid>=8&&(C.pending_buf[C.pending++]=C.bi_buf&255,C.bi_buf>>=8,C.bi_valid-=8)}function Re(C,$){var te=$.dyn_tree,ve=$.max_code,P=$.stat_desc.static_tree,p=$.stat_desc.has_stree,o=$.stat_desc.extra_bits,D=$.stat_desc.extra_base,z=$.stat_desc.max_length,u,M,V,_,B,G,ge=0;for(_=0;_<=S;_++)C.bl_count[_]=0;for(te[C.heap[C.heap_max]*2+1]=0,u=C.heap_max+1;u<y;u++)M=C.heap[u],_=te[te[M*2+1]*2+1]+1,_>z&&(_=z,ge++),te[M*2+1]=_,!(M>ve)&&(C.bl_count[_]++,B=0,M>=D&&(B=o[M-D]),G=te[M*2],C.opt_len+=G*(_+B),p&&(C.static_len+=G*(P[M*2+1]+B)));if(ge!==0){do{for(_=z-1;C.bl_count[_]===0;)_--;C.bl_count[_]--,C.bl_count[_+1]+=2,C.bl_count[z]--,ge-=2}while(ge>0);for(_=z;_!==0;_--)for(M=C.bl_count[_];M!==0;)V=C.heap[--u],!(V>ve)&&(te[V*2+1]!==_&&(C.opt_len+=(_-te[V*2+1])*te[V*2],te[V*2+1]=_),M--)}}function Ie(C,$,te){var ve=new Array(S+1),P=0,p,o;for(p=1;p<=S;p++)ve[p]=P=P+te[p-1]<<1;for(o=0;o<=$;o++){var D=C[o*2+1];D!==0&&(C[o*2]=_e(ve[D]++,D))}}function Oe(){var C,$,te,ve,P,p=new Array(S+1);for(te=0,ve=0;ve<h-1;ve++)for(ce[ve]=te,C=0;C<1<<Z[ve];C++)re[te++]=ve;for(re[te-1]=ve,P=0,ve=0;ve<16;ve++)for(Te[ve]=P,C=0;C<1<<K[ve];C++)ye[P++]=ve;for(P>>=7;ve<E;ve++)for(Te[ve]=P<<7,C=0;C<1<<K[ve]-7;C++)ye[256+P++]=ve;for($=0;$<=S;$++)p[$]=0;for(C=0;C<=143;)Y[C*2+1]=8,C++,p[8]++;for(;C<=255;)Y[C*2+1]=9,C++,p[9]++;for(;C<=279;)Y[C*2+1]=7,C++,p[7]++;for(;C<=287;)Y[C*2+1]=8,C++,p[8]++;for(Ie(Y,g+1,p),C=0;C<E;C++)ae[C*2+1]=5,ae[C*2]=_e(C,5);Ne=new xe(Y,Z,v+1,g,S),je=new xe(ae,K,0,E,S),ze=new xe(new Array(0),J,0,L,I)}function Ve(C){var $;for($=0;$<g;$++)C.dyn_ltree[$*2]=0;for($=0;$<E;$++)C.dyn_dtree[$*2]=0;for($=0;$<L;$++)C.bl_tree[$*2]=0;C.dyn_ltree[k*2]=1,C.opt_len=C.static_len=0,C.last_lit=C.matches=0}function et(C){C.bi_valid>8?oe(C,C.bi_buf):C.bi_valid>0&&(C.pending_buf[C.pending++]=C.bi_buf),C.bi_buf=0,C.bi_valid=0}function Ke(C,$,te,ve){et(C),oe(C,te),oe(C,~te),s.arraySet(C.pending_buf,C.window,$,te,C.pending),C.pending+=te}function Ae(C,$,te,ve){var P=$*2,p=te*2;return C[P]<C[p]||C[P]===C[p]&&ve[$]<=ve[te]}function Se(C,$,te){for(var ve=C.heap[te],P=te<<1;P<=C.heap_len&&(P<C.heap_len&&Ae($,C.heap[P+1],C.heap[P],C.depth)&&P++,!Ae($,ve,C.heap[P],C.depth));)C.heap[te]=C.heap[P],te=P,P<<=1;C.heap[te]=ve}function De(C,$,te){var ve,P,p=0,o,D;if(C.last_lit!==0)do ve=C.pending_buf[C.d_buf+p*2]<<8|C.pending_buf[C.d_buf+p*2+1],P=C.pending_buf[C.l_buf+p],p++,ve===0?me(C,P,$):(o=re[P],me(C,o+v+1,$),D=Z[o],D!==0&&(P-=ce[o],ue(C,P,D)),ve--,o=Me(ve),me(C,o,te),D=K[o],D!==0&&(ve-=Te[o],ue(C,ve,D)));while(p<C.last_lit);me(C,k,$)}function nt(C,$){var te=$.dyn_tree,ve=$.stat_desc.static_tree,P=$.stat_desc.has_stree,p=$.stat_desc.elems,o,D,z=-1,u;for(C.heap_len=0,C.heap_max=y,o=0;o<p;o++)te[o*2]!==0?(C.heap[++C.heap_len]=z=o,C.depth[o]=0):te[o*2+1]=0;for(;C.heap_len<2;)u=C.heap[++C.heap_len]=z<2?++z:0,te[u*2]=1,C.depth[u]=0,C.opt_len--,P&&(C.static_len-=ve[u*2+1]);for($.max_code=z,o=C.heap_len>>1;o>=1;o--)Se(C,te,o);u=p;do o=C.heap[1],C.heap[1]=C.heap[C.heap_len--],Se(C,te,1),D=C.heap[1],C.heap[--C.heap_max]=o,C.heap[--C.heap_max]=D,te[u*2]=te[o*2]+te[D*2],C.depth[u]=(C.depth[o]>=C.depth[D]?C.depth[o]:C.depth[D])+1,te[o*2+1]=te[D*2+1]=u,C.heap[1]=u++,Se(C,te,1);while(C.heap_len>=2);C.heap[--C.heap_max]=C.heap[1],Re(C,$),Ie(te,z,C.bl_count)}function pt(C,$,te){var ve,P=-1,p,o=$[1],D=0,z=7,u=4;for(o===0&&(z=138,u=3),$[(te+1)*2+1]=65535,ve=0;ve<=te;ve++)p=o,o=$[(ve+1)*2+1],!(++D<z&&p===o)&&(D<u?C.bl_tree[p*2]+=D:p!==0?(p!==P&&C.bl_tree[p*2]++,C.bl_tree[O*2]++):D<=10?C.bl_tree[H*2]++:C.bl_tree[j*2]++,D=0,P=p,o===0?(z=138,u=3):p===o?(z=6,u=3):(z=7,u=4))}function lt(C,$,te){var ve,P=-1,p,o=$[1],D=0,z=7,u=4;for(o===0&&(z=138,u=3),ve=0;ve<=te;ve++)if(p=o,o=$[(ve+1)*2+1],!(++D<z&&p===o)){if(D<u)do me(C,p,C.bl_tree);while(--D!==0);else p!==0?(p!==P&&(me(C,p,C.bl_tree),D--),me(C,O,C.bl_tree),ue(C,D-3,2)):D<=10?(me(C,H,C.bl_tree),ue(C,D-3,3)):(me(C,j,C.bl_tree),ue(C,D-11,7));D=0,P=p,o===0?(z=138,u=3):p===o?(z=6,u=3):(z=7,u=4)}}function tt(C){var $;for(pt(C,C.dyn_ltree,C.l_desc.max_code),pt(C,C.dyn_dtree,C.d_desc.max_code),nt(C,C.bl_desc),$=L-1;$>=3&&C.bl_tree[he[$]*2+1]===0;$--);return C.opt_len+=3*($+1)+5+5+4,$}function vt(C,$,te,ve){var P;for(ue(C,$-257,5),ue(C,te-1,5),ue(C,ve-4,4),P=0;P<ve;P++)ue(C,C.bl_tree[he[P]*2+1],3);lt(C,C.dyn_ltree,$-1),lt(C,C.dyn_dtree,te-1)}function ft(C){var $=4093624447,te;for(te=0;te<=31;te++,$>>>=1)if($&1&&C.dyn_ltree[te*2]!==0)return a;if(C.dyn_ltree[18]!==0||C.dyn_ltree[20]!==0||C.dyn_ltree[26]!==0)return l;for(te=32;te<v;te++)if(C.dyn_ltree[te*2]!==0)return l;return a}var at=!1;function ct(C){at||(Oe(),at=!0),C.l_desc=new we(C.dyn_ltree,Ne),C.d_desc=new we(C.dyn_dtree,je),C.bl_desc=new we(C.bl_tree,ze),C.bi_buf=0,C.bi_valid=0,Ve(C)}function ht(C,$,te,ve){ue(C,(c<<1)+(ve?1:0),3),Ke(C,$,te)}function Ze(C){ue(C,b<<1,3),me(C,k,Y),Ee(C)}function ot(C,$,te,ve){var P,p,o=0;C.level>0?(C.strm.data_type===f&&(C.strm.data_type=ft(C)),nt(C,C.l_desc),nt(C,C.d_desc),o=tt(C),P=C.opt_len+3+7>>>3,p=C.static_len+3+7>>>3,p<=P&&(P=p)):P=p=te+5,te+4<=P&&$!==-1?ht(C,$,te,ve):C.strategy===n||p===P?(ue(C,(b<<1)+(ve?1:0),3),De(C,Y,ae)):(ue(C,(m<<1)+(ve?1:0),3),vt(C,C.l_desc.max_code+1,C.d_desc.max_code+1,o+1),De(C,C.dyn_ltree,C.dyn_dtree)),Ve(C),ve&&et(C)}function wt(C,$,te){return C.pending_buf[C.d_buf+C.last_lit*2]=$>>>8&255,C.pending_buf[C.d_buf+C.last_lit*2+1]=$&255,C.pending_buf[C.l_buf+C.last_lit]=te&255,C.last_lit++,$===0?C.dyn_ltree[te*2]++:(C.matches++,$--,C.dyn_ltree[(re[te]+v+1)*2]++,C.dyn_dtree[Me($)*2]++),C.last_lit===C.lit_bufsize-1}i._tr_init=ct,i._tr_stored_block=ht,i._tr_flush_block=ot,i._tr_tally=wt,i._tr_align=Ze},{"../utils/common":41}],53:[function(t,r,i){function s(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}r.exports=s},{}],54:[function(t,r,i){(function(s){(function(n,a){if(n.setImmediate)return;var l=1,f={},d=!1,c=n.document,b;function m(I){typeof I!="function"&&(I=new Function(""+I));for(var k=new Array(arguments.length-1),O=0;O<k.length;O++)k[O]=arguments[O+1];var H={callback:I,args:k};return f[l]=H,b(l),l++}function N(I){delete f[I]}function w(I){var k=I.callback,O=I.args;switch(O.length){case 0:k();break;case 1:k(O[0]);break;case 2:k(O[0],O[1]);break;case 3:k(O[0],O[1],O[2]);break;default:k.apply(a,O);break}}function h(I){if(d)setTimeout(h,0,I);else{var k=f[I];if(k){d=!0;try{w(k)}finally{N(I),d=!1}}}}function v(){b=function(I){process.nextTick(function(){h(I)})}}function g(){if(n.postMessage&&!n.importScripts){var I=!0,k=n.onmessage;return n.onmessage=function(){I=!1},n.postMessage("","*"),n.onmessage=k,I}}function E(){var I="setImmediate$"+Math.random()+"$",k=function(O){O.source===n&&typeof O.data=="string"&&O.data.indexOf(I)===0&&h(+O.data.slice(I.length))};n.addEventListener?n.addEventListener("message",k,!1):n.attachEvent("onmessage",k),b=function(O){n.postMessage(I+O,"*")}}function L(){var I=new MessageChannel;I.port1.onmessage=function(k){var O=k.data;h(O)},b=function(k){I.port2.postMessage(k)}}function y(){var I=c.documentElement;b=function(k){var O=c.createElement("script");O.onreadystatechange=function(){h(k),O.onreadystatechange=null,I.removeChild(O),O=null},I.appendChild(O)}}function S(){b=function(I){setTimeout(h,0,I)}}var R=Object.getPrototypeOf&&Object.getPrototypeOf(n);R=R&&R.setTimeout?R:n,{}.toString.call(n.process)==="[object process]"?v():g()?E():n.MessageChannel?L():c&&"onreadystatechange"in c.createElement("script")?y():S(),R.setImmediate=m,R.clearImmediate=N})(typeof self>"u"?typeof s>"u"?this:s:self)}).call(this,typeof yt<"u"?yt:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(fi)),fi.exports}var Ba=La();const Fa=Zt(Ba);class Pa{constructor(){this.zip=void 0,this.urlCache={},this.checkRequirements()}checkRequirements(){try{this.zip=new Fa}catch{throw new Error("JSZip lib not loaded")}}open(e,t){return this.zip.loadAsync(e,{base64:t})}openUrl(e,t){return er(e,"binary").then((function(r){return this.zip.loadAsync(r,{base64:t})}).bind(this))}request(e,t){var r=new Fe,i,s=new Rt(e);return t||(t=s.extension),t=="blob"?i=this.getBlob(e):i=this.getText(e),i?i.then((function(n){let a=this.handleResponse(n,t);r.resolve(a)}).bind(this)):r.reject({message:"File not found in the epub: "+e,stack:new Error().stack}),r.promise}handleResponse(e,t){var r;return t=="json"?r=JSON.parse(e):Qt(t)?r=Ct(e,"text/xml"):t=="xhtml"?r=Ct(e,"application/xhtml+xml"):t=="html"||t=="htm"?r=Ct(e,"text/html"):r=e,r}getBlob(e,t){var r=window.decodeURIComponent(e.substr(1)),i=this.zip.file(r);if(i)return t=t||Vt.lookup(i.name),i.async("uint8array").then(function(s){return new Blob([s],{type:t})})}getText(e,t){var r=window.decodeURIComponent(e.substr(1)),i=this.zip.file(r);if(i)return i.async("string").then(function(s){return s})}getBase64(e,t){var r=window.decodeURIComponent(e.substr(1)),i=this.zip.file(r);if(i)return t=t||Vt.lookup(i.name),i.async("base64").then(function(s){return"data:"+t+";base64,"+s})}createUrl(e,t){var r=new Fe,i=window.URL||window.webkitURL||window.mozURL,s,n,a=t&&t.base64;return e in this.urlCache?(r.resolve(this.urlCache[e]),r.promise):(a?(n=this.getBase64(e),n&&n.then((function(l){this.urlCache[e]=l,r.resolve(l)}).bind(this))):(n=this.getBlob(e),n&&n.then((function(l){s=i.createObjectURL(l),this.urlCache[e]=s,r.resolve(s)}).bind(this))),n||r.reject({message:"File not found in the epub: "+e,stack:new Error().stack}),r.promise)}revokeUrl(e){var t=window.URL||window.webkitURL||window.mozURL,r=this.urlCache[e];r&&t.revokeObjectURL(r)}destroy(){var e=window.URL||window.webkitURL||window.mozURL;for(let t in this.urlCache)e.revokeObjectURL(t);this.zip=void 0,this.urlCache={}}}var ci={exports:{}};var kn;function za(){return kn||(kn=1,(function(x,e){(function(t){x.exports=t()})(function(){return(function t(r,i,s){function n(f,d){if(!i[f]){if(!r[f]){var c=typeof Ot=="function"&&Ot;if(!d&&c)return c(f,!0);if(a)return a(f,!0);var b=new Error("Cannot find module '"+f+"'");throw b.code="MODULE_NOT_FOUND",b}var m=i[f]={exports:{}};r[f][0].call(m.exports,function(N){var w=r[f][1][N];return n(w||N)},m,m.exports,t,r,i,s)}return i[f].exports}for(var a=typeof Ot=="function"&&Ot,l=0;l<s.length;l++)n(s[l]);return n})({1:[function(t,r,i){(function(s){var n=s.MutationObserver||s.WebKitMutationObserver,a;if(n){var l=0,f=new n(N),d=s.document.createTextNode("");f.observe(d,{characterData:!0}),a=function(){d.data=l=++l%2}}else if(!s.setImmediate&&typeof s.MessageChannel<"u"){var c=new s.MessageChannel;c.port1.onmessage=N,a=function(){c.port2.postMessage(0)}}else"document"in s&&"onreadystatechange"in s.document.createElement("script")?a=function(){var h=s.document.createElement("script");h.onreadystatechange=function(){N(),h.onreadystatechange=null,h.parentNode.removeChild(h),h=null},s.document.documentElement.appendChild(h)}:a=function(){setTimeout(N,0)};var b,m=[];function N(){b=!0;for(var h,v,g=m.length;g;){for(v=m,m=[],h=-1;++h<g;)v[h]();g=m.length}b=!1}r.exports=w;function w(h){m.push(h)===1&&!b&&a()}}).call(this,typeof yt<"u"?yt:typeof self<"u"?self:typeof window<"u"?window:{})},{}],2:[function(t,r,i){var s=t(1);function n(){}var a={},l=["REJECTED"],f=["FULFILLED"],d=["PENDING"];r.exports=c;function c(y){if(typeof y!="function")throw new TypeError("resolver must be a function");this.state=d,this.queue=[],this.outcome=void 0,y!==n&&w(this,y)}c.prototype.catch=function(y){return this.then(null,y)},c.prototype.then=function(y,S){if(typeof y!="function"&&this.state===f||typeof S!="function"&&this.state===l)return this;var R=new this.constructor(n);if(this.state!==d){var I=this.state===f?y:S;m(R,I,this.outcome)}else this.queue.push(new b(R,y,S));return R};function b(y,S,R){this.promise=y,typeof S=="function"&&(this.onFulfilled=S,this.callFulfilled=this.otherCallFulfilled),typeof R=="function"&&(this.onRejected=R,this.callRejected=this.otherCallRejected)}b.prototype.callFulfilled=function(y){a.resolve(this.promise,y)},b.prototype.otherCallFulfilled=function(y){m(this.promise,this.onFulfilled,y)},b.prototype.callRejected=function(y){a.reject(this.promise,y)},b.prototype.otherCallRejected=function(y){m(this.promise,this.onRejected,y)};function m(y,S,R){s(function(){var I;try{I=S(R)}catch(k){return a.reject(y,k)}I===y?a.reject(y,new TypeError("Cannot resolve promise with itself")):a.resolve(y,I)})}a.resolve=function(y,S){var R=h(N,S);if(R.status==="error")return a.reject(y,R.value);var I=R.value;if(I)w(y,I);else{y.state=f,y.outcome=S;for(var k=-1,O=y.queue.length;++k<O;)y.queue[k].callFulfilled(S)}return y},a.reject=function(y,S){y.state=l,y.outcome=S;for(var R=-1,I=y.queue.length;++R<I;)y.queue[R].callRejected(S);return y};function N(y){var S=y&&y.then;if(y&&(typeof y=="object"||typeof y=="function")&&typeof S=="function")return function(){S.apply(y,arguments)}}function w(y,S){var R=!1;function I(j){R||(R=!0,a.reject(y,j))}function k(j){R||(R=!0,a.resolve(y,j))}function O(){S(k,I)}var H=h(O);H.status==="error"&&I(H.value)}function h(y,S){var R={};try{R.value=y(S),R.status="success"}catch(I){R.status="error",R.value=I}return R}c.resolve=v;function v(y){return y instanceof this?y:a.resolve(new this(n),y)}c.reject=g;function g(y){var S=new this(n);return a.reject(S,y)}c.all=E;function E(y){var S=this;if(Object.prototype.toString.call(y)!=="[object Array]")return this.reject(new TypeError("must be an array"));var R=y.length,I=!1;if(!R)return this.resolve([]);for(var k=new Array(R),O=0,H=-1,j=new this(n);++H<R;)Z(y[H],H);return j;function Z(K,J){S.resolve(K).then(he,function(Q){I||(I=!0,a.reject(j,Q))});function he(Q){k[J]=Q,++O===R&&!I&&(I=!0,a.resolve(j,k))}}}c.race=L;function L(y){var S=this;if(Object.prototype.toString.call(y)!=="[object Array]")return this.reject(new TypeError("must be an array"));var R=y.length,I=!1;if(!R)return this.resolve([]);for(var k=-1,O=new this(n);++k<R;)H(y[k]);return O;function H(j){S.resolve(j).then(function(Z){I||(I=!0,a.resolve(O,Z))},function(Z){I||(I=!0,a.reject(O,Z))})}}},{1:1}],3:[function(t,r,i){(function(s){typeof s.Promise!="function"&&(s.Promise=t(2))}).call(this,typeof yt<"u"?yt:typeof self<"u"?self:typeof window<"u"?window:{})},{2:2}],4:[function(t,r,i){var s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(A){return typeof A}:function(A){return A&&typeof Symbol=="function"&&A.constructor===Symbol&&A!==Symbol.prototype?"symbol":typeof A};function n(A,F){if(!(A instanceof F))throw new TypeError("Cannot call a class as a function")}function a(){try{if(typeof indexedDB<"u")return indexedDB;if(typeof webkitIndexedDB<"u")return webkitIndexedDB;if(typeof mozIndexedDB<"u")return mozIndexedDB;if(typeof OIndexedDB<"u")return OIndexedDB;if(typeof msIndexedDB<"u")return msIndexedDB}catch{return}}var l=a();function f(){try{if(!l||!l.open)return!1;var A=typeof openDatabase<"u"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),F=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!A||F)&&typeof indexedDB<"u"&&typeof IDBKeyRange<"u"}catch{return!1}}function d(A,F){A=A||[],F=F||{};try{return new Blob(A,F)}catch(U){if(U.name!=="TypeError")throw U;for(var T=typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder,q=new T,W=0;W<A.length;W+=1)q.append(A[W]);return q.getBlob(F.type)}}typeof Promise>"u"&&t(3);var c=Promise;function b(A,F){F&&A.then(function(T){F(null,T)},function(T){F(T)})}function m(A,F,T){typeof F=="function"&&A.then(F),typeof T=="function"&&A.catch(T)}function N(A){return typeof A!="string"&&(console.warn(A+" used as a key, but it is not a string."),A=String(A)),A}function w(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var h="local-forage-detect-blob-support",v=void 0,g={},E=Object.prototype.toString,L="readonly",y="readwrite";function S(A){for(var F=A.length,T=new ArrayBuffer(F),q=new Uint8Array(T),W=0;W<F;W++)q[W]=A.charCodeAt(W);return T}function R(A){return new c(function(F){var T=A.transaction(h,y),q=d([""]);T.objectStore(h).put(q,"key"),T.onabort=function(W){W.preventDefault(),W.stopPropagation(),F(!1)},T.oncomplete=function(){var W=navigator.userAgent.match(/Chrome\/(\d+)/),U=navigator.userAgent.match(/Edge\//);F(U||!W||parseInt(W[1],10)>=43)}}).catch(function(){return!1})}function I(A){return typeof v=="boolean"?c.resolve(v):R(A).then(function(F){return v=F,v})}function k(A){var F=g[A.name],T={};T.promise=new c(function(q,W){T.resolve=q,T.reject=W}),F.deferredOperations.push(T),F.dbReady?F.dbReady=F.dbReady.then(function(){return T.promise}):F.dbReady=T.promise}function O(A){var F=g[A.name],T=F.deferredOperations.pop();if(T)return T.resolve(),T.promise}function H(A,F){var T=g[A.name],q=T.deferredOperations.pop();if(q)return q.reject(F),q.promise}function j(A,F){return new c(function(T,q){if(g[A.name]=g[A.name]||ce(),A.db)if(F)k(A),A.db.close();else return T(A.db);var W=[A.name];F&&W.push(A.version);var U=l.open.apply(l,W);F&&(U.onupgradeneeded=function(X){var ee=U.result;try{ee.createObjectStore(A.storeName),X.oldVersion<=1&&ee.createObjectStore(h)}catch(ie){if(ie.name==="ConstraintError")console.warn('The database "'+A.name+'" has been upgraded from version '+X.oldVersion+" to version "+X.newVersion+', but the storage "'+A.storeName+'" already exists.');else throw ie}}),U.onerror=function(X){X.preventDefault(),q(U.error)},U.onsuccess=function(){var X=U.result;X.onversionchange=function(ee){ee.target.close()},T(X),O(A)}})}function Z(A){return j(A,!1)}function K(A){return j(A,!0)}function J(A,F){if(!A.db)return!0;var T=!A.db.objectStoreNames.contains(A.storeName),q=A.version<A.db.version,W=A.version>A.db.version;if(q&&(A.version!==F&&console.warn('The database "'+A.name+`" can't be downgraded from version `+A.db.version+" to version "+A.version+"."),A.version=A.db.version),W||T){if(T){var U=A.db.version+1;U>A.version&&(A.version=U)}return!0}return!1}function he(A){return new c(function(F,T){var q=new FileReader;q.onerror=T,q.onloadend=function(W){var U=btoa(W.target.result||"");F({__local_forage_encoded_blob:!0,data:U,type:A.type})},q.readAsBinaryString(A)})}function Q(A){var F=S(atob(A.data));return d([F],{type:A.type})}function Y(A){return A&&A.__local_forage_encoded_blob}function ae(A){var F=this,T=F._initReady().then(function(){var q=g[F._dbInfo.name];if(q&&q.dbReady)return q.dbReady});return m(T,A,A),T}function ye(A){k(A);for(var F=g[A.name],T=F.forages,q=0;q<T.length;q++){var W=T[q];W._dbInfo.db&&(W._dbInfo.db.close(),W._dbInfo.db=null)}return A.db=null,Z(A).then(function(U){return A.db=U,J(A)?K(A):U}).then(function(U){A.db=F.db=U;for(var X=0;X<T.length;X++)T[X]._dbInfo.db=U}).catch(function(U){throw H(A,U),U})}function re(A,F,T,q){q===void 0&&(q=1);try{var W=A.db.transaction(A.storeName,F);T(null,W)}catch(U){if(q>0&&(!A.db||U.name==="InvalidStateError"||U.name==="NotFoundError"))return c.resolve().then(function(){if(!A.db||U.name==="NotFoundError"&&!A.db.objectStoreNames.contains(A.storeName)&&A.version<=A.db.version)return A.db&&(A.version=A.db.version+1),K(A)}).then(function(){return ye(A).then(function(){re(A,F,T,q-1)})}).catch(T);T(U)}}function ce(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function Te(A){var F=this,T={db:null};if(A)for(var q in A)T[q]=A[q];var W=g[T.name];W||(W=ce(),g[T.name]=W),W.forages.push(F),F._initReady||(F._initReady=F.ready,F.ready=ae);var U=[];function X(){return c.resolve()}for(var ee=0;ee<W.forages.length;ee++){var ie=W.forages[ee];ie!==F&&U.push(ie._initReady().catch(X))}var ne=W.forages.slice(0);return c.all(U).then(function(){return T.db=W.db,Z(T)}).then(function(le){return T.db=le,J(T,F._defaultConfig.version)?K(T):le}).then(function(le){T.db=W.db=le,F._dbInfo=T;for(var be=0;be<ne.length;be++){var Be=ne[be];Be!==F&&(Be._dbInfo.db=T.db,Be._dbInfo.version=T.version)}})}function xe(A,F){var T=this;A=N(A);var q=new c(function(W,U){T.ready().then(function(){re(T._dbInfo,L,function(X,ee){if(X)return U(X);try{var ie=ee.objectStore(T._dbInfo.storeName),ne=ie.get(A);ne.onsuccess=function(){var le=ne.result;le===void 0&&(le=null),Y(le)&&(le=Q(le)),W(le)},ne.onerror=function(){U(ne.error)}}catch(le){U(le)}})}).catch(U)});return b(q,F),q}function Ne(A,F){var T=this,q=new c(function(W,U){T.ready().then(function(){re(T._dbInfo,L,function(X,ee){if(X)return U(X);try{var ie=ee.objectStore(T._dbInfo.storeName),ne=ie.openCursor(),le=1;ne.onsuccess=function(){var be=ne.result;if(be){var Be=be.value;Y(Be)&&(Be=Q(Be));var qe=A(Be,be.key,le++);qe!==void 0?W(qe):be.continue()}else W()},ne.onerror=function(){U(ne.error)}}catch(be){U(be)}})}).catch(U)});return b(q,F),q}function je(A,F,T){var q=this;A=N(A);var W=new c(function(U,X){var ee;q.ready().then(function(){return ee=q._dbInfo,E.call(F)==="[object Blob]"?I(ee.db).then(function(ie){return ie?F:he(F)}):F}).then(function(ie){re(q._dbInfo,y,function(ne,le){if(ne)return X(ne);try{var be=le.objectStore(q._dbInfo.storeName);ie===null&&(ie=void 0);var Be=be.put(ie,A);le.oncomplete=function(){ie===void 0&&(ie=null),U(ie)},le.onabort=le.onerror=function(){var qe=Be.error?Be.error:Be.transaction.error;X(qe)}}catch(qe){X(qe)}})}).catch(X)});return b(W,T),W}function ze(A,F){var T=this;A=N(A);var q=new c(function(W,U){T.ready().then(function(){re(T._dbInfo,y,function(X,ee){if(X)return U(X);try{var ie=ee.objectStore(T._dbInfo.storeName),ne=ie.delete(A);ee.oncomplete=function(){W()},ee.onerror=function(){U(ne.error)},ee.onabort=function(){var le=ne.error?ne.error:ne.transaction.error;U(le)}}catch(le){U(le)}})}).catch(U)});return b(q,F),q}function we(A){var F=this,T=new c(function(q,W){F.ready().then(function(){re(F._dbInfo,y,function(U,X){if(U)return W(U);try{var ee=X.objectStore(F._dbInfo.storeName),ie=ee.clear();X.oncomplete=function(){q()},X.onabort=X.onerror=function(){var ne=ie.error?ie.error:ie.transaction.error;W(ne)}}catch(ne){W(ne)}})}).catch(W)});return b(T,A),T}function Me(A){var F=this,T=new c(function(q,W){F.ready().then(function(){re(F._dbInfo,L,function(U,X){if(U)return W(U);try{var ee=X.objectStore(F._dbInfo.storeName),ie=ee.count();ie.onsuccess=function(){q(ie.result)},ie.onerror=function(){W(ie.error)}}catch(ne){W(ne)}})}).catch(W)});return b(T,A),T}function oe(A,F){var T=this,q=new c(function(W,U){if(A<0){W(null);return}T.ready().then(function(){re(T._dbInfo,L,function(X,ee){if(X)return U(X);try{var ie=ee.objectStore(T._dbInfo.storeName),ne=!1,le=ie.openKeyCursor();le.onsuccess=function(){var be=le.result;if(!be){W(null);return}A===0||ne?W(be.key):(ne=!0,be.advance(A))},le.onerror=function(){U(le.error)}}catch(be){U(be)}})}).catch(U)});return b(q,F),q}function ue(A){var F=this,T=new c(function(q,W){F.ready().then(function(){re(F._dbInfo,L,function(U,X){if(U)return W(U);try{var ee=X.objectStore(F._dbInfo.storeName),ie=ee.openKeyCursor(),ne=[];ie.onsuccess=function(){var le=ie.result;if(!le){q(ne);return}ne.push(le.key),le.continue()},ie.onerror=function(){W(ie.error)}}catch(le){W(le)}})}).catch(W)});return b(T,A),T}function me(A,F){F=w.apply(this,arguments);var T=this.config();A=typeof A!="function"&&A||{},A.name||(A.name=A.name||T.name,A.storeName=A.storeName||T.storeName);var q=this,W;if(!A.name)W=c.reject("Invalid arguments");else{var U=A.name===T.name&&q._dbInfo.db,X=U?c.resolve(q._dbInfo.db):Z(A).then(function(ee){var ie=g[A.name],ne=ie.forages;ie.db=ee;for(var le=0;le<ne.length;le++)ne[le]._dbInfo.db=ee;return ee});A.storeName?W=X.then(function(ee){if(ee.objectStoreNames.contains(A.storeName)){var ie=ee.version+1;k(A);var ne=g[A.name],le=ne.forages;ee.close();for(var be=0;be<le.length;be++){var Be=le[be];Be._dbInfo.db=null,Be._dbInfo.version=ie}var qe=new c(function(We,rt){var Qe=l.open(A.name,ie);Qe.onerror=function(mt){var Yt=Qe.result;Yt.close(),rt(mt)},Qe.onupgradeneeded=function(){var mt=Qe.result;mt.deleteObjectStore(A.storeName)},Qe.onsuccess=function(){var mt=Qe.result;mt.close(),We(mt)}});return qe.then(function(We){ne.db=We;for(var rt=0;rt<le.length;rt++){var Qe=le[rt];Qe._dbInfo.db=We,O(Qe._dbInfo)}}).catch(function(We){throw(H(A,We)||c.resolve()).catch(function(){}),We})}}):W=X.then(function(ee){k(A);var ie=g[A.name],ne=ie.forages;ee.close();for(var le=0;le<ne.length;le++){var be=ne[le];be._dbInfo.db=null}var Be=new c(function(qe,We){var rt=l.deleteDatabase(A.name);rt.onerror=function(){var Qe=rt.result;Qe&&Qe.close(),We(rt.error)},rt.onblocked=function(){console.warn('dropInstance blocked for database "'+A.name+'" until all open connections are closed')},rt.onsuccess=function(){var Qe=rt.result;Qe&&Qe.close(),qe(Qe)}});return Be.then(function(qe){ie.db=qe;for(var We=0;We<ne.length;We++){var rt=ne[We];O(rt._dbInfo)}}).catch(function(qe){throw(H(A,qe)||c.resolve()).catch(function(){}),qe})})}return b(W,F),W}var _e={_driver:"asyncStorage",_initStorage:Te,_support:f(),iterate:Ne,getItem:xe,setItem:je,removeItem:ze,clear:we,length:Me,key:oe,keys:ue,dropInstance:me};function Ee(){return typeof openDatabase=="function"}var Re="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Ie="~~local_forage_type~",Oe=/^~~local_forage_type~([^~]+)~/,Ve="__lfsc__:",et=Ve.length,Ke="arbf",Ae="blob",Se="si08",De="ui08",nt="uic8",pt="si16",lt="si32",tt="ur16",vt="ui32",ft="fl32",at="fl64",ct=et+Ke.length,ht=Object.prototype.toString;function Ze(A){var F=A.length*.75,T=A.length,q,W=0,U,X,ee,ie;A[A.length-1]==="="&&(F--,A[A.length-2]==="="&&F--);var ne=new ArrayBuffer(F),le=new Uint8Array(ne);for(q=0;q<T;q+=4)U=Re.indexOf(A[q]),X=Re.indexOf(A[q+1]),ee=Re.indexOf(A[q+2]),ie=Re.indexOf(A[q+3]),le[W++]=U<<2|X>>4,le[W++]=(X&15)<<4|ee>>2,le[W++]=(ee&3)<<6|ie&63;return ne}function ot(A){var F=new Uint8Array(A),T="",q;for(q=0;q<F.length;q+=3)T+=Re[F[q]>>2],T+=Re[(F[q]&3)<<4|F[q+1]>>4],T+=Re[(F[q+1]&15)<<2|F[q+2]>>6],T+=Re[F[q+2]&63];return F.length%3===2?T=T.substring(0,T.length-1)+"=":F.length%3===1&&(T=T.substring(0,T.length-2)+"=="),T}function wt(A,F){var T="";if(A&&(T=ht.call(A)),A&&(T==="[object ArrayBuffer]"||A.buffer&&ht.call(A.buffer)==="[object ArrayBuffer]")){var q,W=Ve;A instanceof ArrayBuffer?(q=A,W+=Ke):(q=A.buffer,T==="[object Int8Array]"?W+=Se:T==="[object Uint8Array]"?W+=De:T==="[object Uint8ClampedArray]"?W+=nt:T==="[object Int16Array]"?W+=pt:T==="[object Uint16Array]"?W+=tt:T==="[object Int32Array]"?W+=lt:T==="[object Uint32Array]"?W+=vt:T==="[object Float32Array]"?W+=ft:T==="[object Float64Array]"?W+=at:F(new Error("Failed to get type for BinaryArray"))),F(W+ot(q))}else if(T==="[object Blob]"){var U=new FileReader;U.onload=function(){var X=Ie+A.type+"~"+ot(this.result);F(Ve+Ae+X)},U.readAsArrayBuffer(A)}else try{F(JSON.stringify(A))}catch(X){console.error("Couldn't convert value into a JSON string: ",A),F(null,X)}}function C(A){if(A.substring(0,et)!==Ve)return JSON.parse(A);var F=A.substring(ct),T=A.substring(et,ct),q;if(T===Ae&&Oe.test(F)){var W=F.match(Oe);q=W[1],F=F.substring(W[0].length)}var U=Ze(F);switch(T){case Ke:return U;case Ae:return d([U],{type:q});case Se:return new Int8Array(U);case De:return new Uint8Array(U);case nt:return new Uint8ClampedArray(U);case pt:return new Int16Array(U);case tt:return new Uint16Array(U);case lt:return new Int32Array(U);case vt:return new Uint32Array(U);case ft:return new Float32Array(U);case at:return new Float64Array(U);default:throw new Error("Unkown type: "+T)}}var $={serialize:wt,deserialize:C,stringToBuffer:Ze,bufferToString:ot};function te(A,F,T,q){A.executeSql("CREATE TABLE IF NOT EXISTS "+F.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],T,q)}function ve(A){var F=this,T={db:null};if(A)for(var q in A)T[q]=typeof A[q]!="string"?A[q].toString():A[q];var W=new c(function(U,X){try{T.db=openDatabase(T.name,String(T.version),T.description,T.size)}catch(ee){return X(ee)}T.db.transaction(function(ee){te(ee,T,function(){F._dbInfo=T,U()},function(ie,ne){X(ne)})},X)});return T.serializer=$,W}function P(A,F,T,q,W,U){A.executeSql(T,q,W,function(X,ee){ee.code===ee.SYNTAX_ERR?X.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[F.storeName],function(ie,ne){ne.rows.length?U(ie,ee):te(ie,F,function(){ie.executeSql(T,q,W,U)},U)},U):U(X,ee)},U)}function p(A,F){var T=this;A=N(A);var q=new c(function(W,U){T.ready().then(function(){var X=T._dbInfo;X.db.transaction(function(ee){P(ee,X,"SELECT * FROM "+X.storeName+" WHERE key = ? LIMIT 1",[A],function(ie,ne){var le=ne.rows.length?ne.rows.item(0).value:null;le&&(le=X.serializer.deserialize(le)),W(le)},function(ie,ne){U(ne)})})}).catch(U)});return b(q,F),q}function o(A,F){var T=this,q=new c(function(W,U){T.ready().then(function(){var X=T._dbInfo;X.db.transaction(function(ee){P(ee,X,"SELECT * FROM "+X.storeName,[],function(ie,ne){for(var le=ne.rows,be=le.length,Be=0;Be<be;Be++){var qe=le.item(Be),We=qe.value;if(We&&(We=X.serializer.deserialize(We)),We=A(We,qe.key,Be+1),We!==void 0){W(We);return}}W()},function(ie,ne){U(ne)})})}).catch(U)});return b(q,F),q}function D(A,F,T,q){var W=this;A=N(A);var U=new c(function(X,ee){W.ready().then(function(){F===void 0&&(F=null);var ie=F,ne=W._dbInfo;ne.serializer.serialize(F,function(le,be){be?ee(be):ne.db.transaction(function(Be){P(Be,ne,"INSERT OR REPLACE INTO "+ne.storeName+" (key, value) VALUES (?, ?)",[A,le],function(){X(ie)},function(qe,We){ee(We)})},function(Be){if(Be.code===Be.QUOTA_ERR){if(q>0){X(D.apply(W,[A,ie,T,q-1]));return}ee(Be)}})})}).catch(ee)});return b(U,T),U}function z(A,F,T){return D.apply(this,[A,F,T,1])}function u(A,F){var T=this;A=N(A);var q=new c(function(W,U){T.ready().then(function(){var X=T._dbInfo;X.db.transaction(function(ee){P(ee,X,"DELETE FROM "+X.storeName+" WHERE key = ?",[A],function(){W()},function(ie,ne){U(ne)})})}).catch(U)});return b(q,F),q}function M(A){var F=this,T=new c(function(q,W){F.ready().then(function(){var U=F._dbInfo;U.db.transaction(function(X){P(X,U,"DELETE FROM "+U.storeName,[],function(){q()},function(ee,ie){W(ie)})})}).catch(W)});return b(T,A),T}function V(A){var F=this,T=new c(function(q,W){F.ready().then(function(){var U=F._dbInfo;U.db.transaction(function(X){P(X,U,"SELECT COUNT(key) as c FROM "+U.storeName,[],function(ee,ie){var ne=ie.rows.item(0).c;q(ne)},function(ee,ie){W(ie)})})}).catch(W)});return b(T,A),T}function _(A,F){var T=this,q=new c(function(W,U){T.ready().then(function(){var X=T._dbInfo;X.db.transaction(function(ee){P(ee,X,"SELECT key FROM "+X.storeName+" WHERE id = ? LIMIT 1",[A+1],function(ie,ne){var le=ne.rows.length?ne.rows.item(0).key:null;W(le)},function(ie,ne){U(ne)})})}).catch(U)});return b(q,F),q}function B(A){var F=this,T=new c(function(q,W){F.ready().then(function(){var U=F._dbInfo;U.db.transaction(function(X){P(X,U,"SELECT key FROM "+U.storeName,[],function(ee,ie){for(var ne=[],le=0;le<ie.rows.length;le++)ne.push(ie.rows.item(le).key);q(ne)},function(ee,ie){W(ie)})})}).catch(W)});return b(T,A),T}function G(A){return new c(function(F,T){A.transaction(function(q){q.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(W,U){for(var X=[],ee=0;ee<U.rows.length;ee++)X.push(U.rows.item(ee).name);F({db:A,storeNames:X})},function(W,U){T(U)})},function(q){T(q)})})}function ge(A,F){F=w.apply(this,arguments);var T=this.config();A=typeof A!="function"&&A||{},A.name||(A.name=A.name||T.name,A.storeName=A.storeName||T.storeName);var q=this,W;return A.name?W=new c(function(U){var X;A.name===T.name?X=q._dbInfo.db:X=openDatabase(A.name,"","",0),A.storeName?U({db:X,storeNames:[A.storeName]}):U(G(X))}).then(function(U){return new c(function(X,ee){U.db.transaction(function(ie){function ne(qe){return new c(function(We,rt){ie.executeSql("DROP TABLE IF EXISTS "+qe,[],function(){We()},function(Qe,mt){rt(mt)})})}for(var le=[],be=0,Be=U.storeNames.length;be<Be;be++)le.push(ne(U.storeNames[be]));c.all(le).then(function(){X()}).catch(function(qe){ee(qe)})},function(ie){ee(ie)})})}):W=c.reject("Invalid arguments"),b(W,F),W}var fe={_driver:"webSQLStorage",_initStorage:ve,_support:Ee(),iterate:o,getItem:p,setItem:z,removeItem:u,clear:M,length:V,key:_,keys:B,dropInstance:ge};function de(){try{return typeof localStorage<"u"&&"setItem"in localStorage&&!!localStorage.setItem}catch{return!1}}function Ce(A,F){var T=A.name+"/";return A.storeName!==F.storeName&&(T+=A.storeName+"/"),T}function Xe(){var A="_localforage_support_test";try{return localStorage.setItem(A,!0),localStorage.removeItem(A),!1}catch{return!0}}function Ue(){return!Xe()||localStorage.length>0}function ke(A){var F=this,T={};if(A)for(var q in A)T[q]=A[q];return T.keyPrefix=Ce(A,F._defaultConfig),Ue()?(F._dbInfo=T,T.serializer=$,c.resolve()):c.reject()}function Le(A){var F=this,T=F.ready().then(function(){for(var q=F._dbInfo.keyPrefix,W=localStorage.length-1;W>=0;W--){var U=localStorage.key(W);U.indexOf(q)===0&&localStorage.removeItem(U)}});return b(T,A),T}function Je(A,F){var T=this;A=N(A);var q=T.ready().then(function(){var W=T._dbInfo,U=localStorage.getItem(W.keyPrefix+A);return U&&(U=W.serializer.deserialize(U)),U});return b(q,F),q}function Ge(A,F){var T=this,q=T.ready().then(function(){for(var W=T._dbInfo,U=W.keyPrefix,X=U.length,ee=localStorage.length,ie=1,ne=0;ne<ee;ne++){var le=localStorage.key(ne);if(le.indexOf(U)===0){var be=localStorage.getItem(le);if(be&&(be=W.serializer.deserialize(be)),be=A(be,le.substring(X),ie++),be!==void 0)return be}}});return b(q,F),q}function Tt(A,F){var T=this,q=T.ready().then(function(){var W=T._dbInfo,U;try{U=localStorage.key(A)}catch{U=null}return U&&(U=U.substring(W.keyPrefix.length)),U});return b(q,F),q}function Ft(A){var F=this,T=F.ready().then(function(){for(var q=F._dbInfo,W=localStorage.length,U=[],X=0;X<W;X++){var ee=localStorage.key(X);ee.indexOf(q.keyPrefix)===0&&U.push(ee.substring(q.keyPrefix.length))}return U});return b(T,A),T}function Ye(A){var F=this,T=F.keys().then(function(q){return q.length});return b(T,A),T}function dt(A,F){var T=this;A=N(A);var q=T.ready().then(function(){var W=T._dbInfo;localStorage.removeItem(W.keyPrefix+A)});return b(q,F),q}function st(A,F,T){var q=this;A=N(A);var W=q.ready().then(function(){F===void 0&&(F=null);var U=F;return new c(function(X,ee){var ie=q._dbInfo;ie.serializer.serialize(F,function(ne,le){if(le)ee(le);else try{localStorage.setItem(ie.keyPrefix+A,ne),X(U)}catch(be){(be.name==="QuotaExceededError"||be.name==="NS_ERROR_DOM_QUOTA_REACHED")&&ee(be),ee(be)}})})});return b(W,T),W}function _t(A,F){if(F=w.apply(this,arguments),A=typeof A!="function"&&A||{},!A.name){var T=this.config();A.name=A.name||T.name,A.storeName=A.storeName||T.storeName}var q=this,W;return A.name?W=new c(function(U){A.storeName?U(Ce(A,q._defaultConfig)):U(A.name+"/")}).then(function(U){for(var X=localStorage.length-1;X>=0;X--){var ee=localStorage.key(X);ee.indexOf(U)===0&&localStorage.removeItem(ee)}}):W=c.reject("Invalid arguments"),b(W,F),W}var gt={_driver:"localStorageWrapper",_initStorage:ke,_support:de(),iterate:Ge,getItem:Je,setItem:st,removeItem:dt,clear:Le,length:Ye,key:Tt,keys:Ft,dropInstance:_t},ir=function(F,T){return F===T||typeof F=="number"&&typeof T=="number"&&isNaN(F)&&isNaN(T)},rs=function(F,T){for(var q=F.length,W=0;W<q;){if(ir(F[W],T))return!0;W++}return!1},Ti=Array.isArray||function(A){return Object.prototype.toString.call(A)==="[object Array]"},Xt={},ki={},Pt={INDEXEDDB:_e,WEBSQL:fe,LOCALSTORAGE:gt},is=[Pt.INDEXEDDB._driver,Pt.WEBSQL._driver,Pt.LOCALSTORAGE._driver],nr=["dropInstance"],xr=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(nr),ns={description:"",driver:is.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function ss(A,F){A[F]=function(){var T=arguments;return A.ready().then(function(){return A[F].apply(A,T)})}}function Er(){for(var A=1;A<arguments.length;A++){var F=arguments[A];if(F)for(var T in F)F.hasOwnProperty(T)&&(Ti(F[T])?arguments[0][T]=F[T].slice():arguments[0][T]=F[T])}return arguments[0]}var as=(function(){function A(F){n(this,A);for(var T in Pt)if(Pt.hasOwnProperty(T)){var q=Pt[T],W=q._driver;this[T]=W,Xt[W]||this.defineDriver(q)}this._defaultConfig=Er({},ns),this._config=Er({},this._defaultConfig,F),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return A.prototype.config=function(T){if((typeof T>"u"?"undefined":s(T))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var q in T){if(q==="storeName"&&(T[q]=T[q].replace(/\W/g,"_")),q==="version"&&typeof T[q]!="number")return new Error("Database version must be a number.");this._config[q]=T[q]}return"driver"in T&&T.driver?this.setDriver(this._config.driver):!0}else return typeof T=="string"?this._config[T]:this._config},A.prototype.defineDriver=function(T,q,W){var U=new c(function(X,ee){try{var ie=T._driver,ne=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!T._driver){ee(ne);return}for(var le=xr.concat("_initStorage"),be=0,Be=le.length;be<Be;be++){var qe=le[be],We=!rs(nr,qe);if((We||T[qe])&&typeof T[qe]!="function"){ee(ne);return}}var rt=function(){for(var Yt=function(ls){return function(){var hs=new Error("Method "+ls+" is not implemented by the current driver"),Ni=c.reject(hs);return b(Ni,arguments[arguments.length-1]),Ni}},Dr=0,us=nr.length;Dr<us;Dr++){var Ar=nr[Dr];T[Ar]||(T[Ar]=Yt(Ar))}};rt();var Qe=function(Yt){Xt[ie]&&console.info("Redefining LocalForage driver: "+ie),Xt[ie]=T,ki[ie]=Yt,X()};"_support"in T?T._support&&typeof T._support=="function"?T._support().then(Qe,ee):Qe(!!T._support):Qe(!0)}catch(mt){ee(mt)}});return m(U,q,W),U},A.prototype.driver=function(){return this._driver||null},A.prototype.getDriver=function(T,q,W){var U=Xt[T]?c.resolve(Xt[T]):c.reject(new Error("Driver not found."));return m(U,q,W),U},A.prototype.getSerializer=function(T){var q=c.resolve($);return m(q,T),q},A.prototype.ready=function(T){var q=this,W=q._driverSet.then(function(){return q._ready===null&&(q._ready=q._initDriver()),q._ready});return m(W,T,T),W},A.prototype.setDriver=function(T,q,W){var U=this;Ti(T)||(T=[T]);var X=this._getSupportedDrivers(T);function ee(){U._config.driver=U.driver()}function ie(be){return U._extend(be),ee(),U._ready=U._initStorage(U._config),U._ready}function ne(be){return function(){var Be=0;function qe(){for(;Be<be.length;){var We=be[Be];return Be++,U._dbInfo=null,U._ready=null,U.getDriver(We).then(ie).catch(qe)}ee();var rt=new Error("No available storage method found.");return U._driverSet=c.reject(rt),U._driverSet}return qe()}}var le=this._driverSet!==null?this._driverSet.catch(function(){return c.resolve()}):c.resolve();return this._driverSet=le.then(function(){var be=X[0];return U._dbInfo=null,U._ready=null,U.getDriver(be).then(function(Be){U._driver=Be._driver,ee(),U._wrapLibraryMethodsWithReady(),U._initDriver=ne(X)})}).catch(function(){ee();var be=new Error("No available storage method found.");return U._driverSet=c.reject(be),U._driverSet}),m(this._driverSet,q,W),this._driverSet},A.prototype.supports=function(T){return!!ki[T]},A.prototype._extend=function(T){Er(this,T)},A.prototype._getSupportedDrivers=function(T){for(var q=[],W=0,U=T.length;W<U;W++){var X=T[W];this.supports(X)&&q.push(X)}return q},A.prototype._wrapLibraryMethodsWithReady=function(){for(var T=0,q=xr.length;T<q;T++)ss(this,xr[T])},A.prototype.createInstance=function(T){return new A(T)},A})(),os=new as;r.exports=os},{3:3}]},{},[4])(4)})})(ci)),ci.exports}var Ma=za();const Nn=Zt(Ma);class ts{constructor(e,t,r){this.urlCache={},this.storage=void 0,this.name=e,this.requester=t||er,this.resolver=r,this.online=!0,this.checkRequirements(),this.addListeners()}checkRequirements(){try{let e;typeof Nn>"u"&&(e=Nn),this.storage=e.createInstance({name:this.name})}catch{throw new Error("localForage lib not loaded")}}addListeners(){this._status=this.status.bind(this),window.addEventListener("online",this._status),window.addEventListener("offline",this._status)}removeListeners(){window.removeEventListener("online",this._status),window.removeEventListener("offline",this._status),this._status=void 0}status(e){let t=navigator.onLine;this.online=t,t?this.emit("online",this):this.emit("offline",this)}add(e,t){let r=e.resources.map(i=>{let{href:s}=i,n=this.resolver(s),a=window.encodeURIComponent(n);return this.storage.getItem(a).then(l=>!l||t?this.requester(n,"binary").then(f=>this.storage.setItem(a,f)):l)});return Promise.all(r)}put(e,t,r){let i=window.encodeURIComponent(e);return this.storage.getItem(i).then(s=>s||this.requester(e,"binary",t,r).then(n=>this.storage.setItem(i,n)))}request(e,t,r,i){return this.online?this.requester(e,t,r,i).then(s=>(this.put(e),s)):this.retrieve(e,t)}retrieve(e,t){new Fe;var r,i=new Rt(e);return t||(t=i.extension),t=="blob"?r=this.getBlob(e):r=this.getText(e),r.then(s=>{var n=new Fe,a;return s?(a=this.handleResponse(s,t),n.resolve(a)):n.reject({message:"File not found in storage: "+e,stack:new Error().stack}),n.promise})}handleResponse(e,t){var r;return t=="json"?r=JSON.parse(e):Qt(t)?r=Ct(e,"text/xml"):t=="xhtml"?r=Ct(e,"application/xhtml+xml"):t=="html"||t=="htm"?r=Ct(e,"text/html"):r=e,r}getBlob(e,t){let r=window.encodeURIComponent(e);return this.storage.getItem(r).then(function(i){if(i)return t=t||Vt.lookup(e),new Blob([i],{type:t})})}getText(e,t){let r=window.encodeURIComponent(e);return t=t||Vt.lookup(e),this.storage.getItem(r).then(function(i){var s=new Fe,n=new FileReader,a;if(i)return a=new Blob([i],{type:t}),n.addEventListener("loadend",()=>{s.resolve(n.result)}),n.readAsText(a,t),s.promise})}getBase64(e,t){let r=window.encodeURIComponent(e);return t=t||Vt.lookup(e),this.storage.getItem(r).then(i=>{var s=new Fe,n=new FileReader,a;if(i)return a=new Blob([i],{type:t}),n.addEventListener("loadend",()=>{s.resolve(n.result)}),n.readAsDataURL(a,t),s.promise})}createUrl(e,t){var r=new Fe,i=window.URL||window.webkitURL||window.mozURL,s,n,a=t&&t.base64;return e in this.urlCache?(r.resolve(this.urlCache[e]),r.promise):(a?(n=this.getBase64(e),n&&n.then((function(l){this.urlCache[e]=l,r.resolve(l)}).bind(this))):(n=this.getBlob(e),n&&n.then((function(l){s=i.createObjectURL(l),this.urlCache[e]=s,r.resolve(s)}).bind(this))),n||r.reject({message:"File not found in storage: "+e,stack:new Error().stack}),r.promise)}revokeUrl(e){var t=window.URL||window.webkitURL||window.mozURL,r=this.urlCache[e];r&&t.revokeObjectURL(r)}destroy(){var e=window.URL||window.webkitURL||window.mozURL;for(let t in this.urlCache)e.revokeObjectURL(t);this.urlCache={},this.removeListeners()}}St(ts.prototype);class di{constructor(e){this.interactive="",this.fixedLayout="",this.openToSpread="",this.orientationLock="",e&&this.parse(e)}parse(e){if(!e)return this;const t=He(e,"display_options");return t?(Nt(t,"option").forEach(i=>{let s="";switch(i.childNodes.length&&(s=i.childNodes[0].nodeValue),i.attributes.name.value){case"interactive":this.interactive=s;break;case"fixed-layout":this.fixedLayout=s;break;case"open-to-spread":this.openToSpread=s;break;case"orientation-lock":this.orientationLock=s;break}}),this):this}destroy(){this.interactive=void 0,this.fixedLayout=void 0,this.openToSpread=void 0,this.orientationLock=void 0}}const Rn="META-INF/container.xml",Ua="META-INF/com.apple.ibooks.display-options.xml",Et={BINARY:"binary",BASE64:"base64",EPUB:"epub",OPF:"opf",MANIFEST:"json",DIRECTORY:"directory"};class Si{constructor(e,t){typeof t>"u"&&typeof e!="string"&&!(e instanceof Blob)&&!(e instanceof ArrayBuffer)&&(t=e,e=void 0),this.settings=ut(this.settings||{},{requestMethod:void 0,requestCredentials:void 0,requestHeaders:void 0,encoding:void 0,replacements:void 0,canonical:void 0,openAs:void 0,store:void 0}),ut(this.settings,t),this.opening=new Fe,this.opened=this.opening.promise,this.isOpen=!1,this.loading={manifest:new Fe,spine:new Fe,metadata:new Fe,cover:new Fe,navigation:new Fe,pageList:new Fe,resources:new Fe,displayOptions:new Fe},this.loaded={manifest:this.loading.manifest.promise,spine:this.loading.spine.promise,metadata:this.loading.metadata.promise,cover:this.loading.cover.promise,navigation:this.loading.navigation.promise,pageList:this.loading.pageList.promise,resources:this.loading.resources.promise,displayOptions:this.loading.displayOptions.promise},this.ready=Promise.all([this.loaded.manifest,this.loaded.spine,this.loaded.metadata,this.loaded.cover,this.loaded.navigation,this.loaded.resources,this.loaded.displayOptions]),this.isRendered=!1,this.request=this.settings.requestMethod||er,this.spine=new ea,this.locations=new Zn(this.spine,this.load.bind(this)),this.navigation=void 0,this.pageList=void 0,this.url=void 0,this.path=void 0,this.archived=!1,this.archive=void 0,this.storage=void 0,this.resources=void 0,this.rendition=void 0,this.container=void 0,this.packaging=void 0,this.displayOptions=void 0,this.settings.store&&this.store(this.settings.store),e&&this.open(e,this.settings.openAs).catch(r=>{var i=new Error("Cannot load book at "+e);this.emit(pe.BOOK.OPEN_FAILED,i)})}open(e,t){var r,i=t||this.determineType(e);return i===Et.BINARY?(this.archived=!0,this.url=new Dt("/",""),r=this.openEpub(e)):i===Et.BASE64?(this.archived=!0,this.url=new Dt("/",""),r=this.openEpub(e,i)):i===Et.EPUB?(this.archived=!0,this.url=new Dt("/",""),r=this.request(e,"binary",this.settings.requestCredentials,this.settings.requestHeaders).then(this.openEpub.bind(this))):i==Et.OPF?(this.url=new Dt(e),r=this.openPackaging(this.url.Path.toString())):i==Et.MANIFEST?(this.url=new Dt(e),r=this.openManifest(this.url.Path.toString())):(this.url=new Dt(e),r=this.openContainer(Rn).then(this.openPackaging.bind(this))),r}openEpub(e,t){return this.unarchive(e,t||this.settings.encoding).then(()=>this.openContainer(Rn)).then(r=>this.openPackaging(r))}openContainer(e){return this.load(e).then(t=>(this.container=new ta(t),this.resolve(this.container.packagePath)))}openPackaging(e){return this.path=new Rt(e),this.load(e).then(t=>(this.packaging=new un(t),this.unpack(this.packaging)))}openManifest(e){return this.path=new Rt(e),this.load(e).then(t=>(this.packaging=new un,this.packaging.load(t),this.unpack(this.packaging)))}load(e){var t=this.resolve(e);return this.archived?this.archive.request(t):this.request(t,null,this.settings.requestCredentials,this.settings.requestHeaders)}resolve(e,t){if(e){var r=e,i=e.indexOf("://")>-1;return i?e:(this.path&&(r=this.path.resolve(e)),t!=!1&&this.url&&(r=this.url.resolve(r)),r)}}canonical(e){var t=e;return e?(this.settings.canonical?t=this.settings.canonical(e):t=this.resolve(e,!0),t):""}determineType(e){var t,r,i;if(this.settings.encoding==="base64")return Et.BASE64;if(typeof e!="string")return Et.BINARY;if(t=new Dt(e),r=t.path(),i=r.extension,i&&(i=i.replace(/\?.*$/,"")),!i)return Et.DIRECTORY;if(i==="epub")return Et.EPUB;if(i==="opf")return Et.OPF;if(i==="json")return Et.MANIFEST}unpack(e){this.package=e,this.packaging.metadata.layout===""?this.load(this.url.resolve(Ua)).then(t=>{this.displayOptions=new di(t),this.loading.displayOptions.resolve(this.displayOptions)}).catch(t=>{this.displayOptions=new di,this.loading.displayOptions.resolve(this.displayOptions)}):(this.displayOptions=new di,this.loading.displayOptions.resolve(this.displayOptions)),this.spine.unpack(this.packaging,this.resolve.bind(this),this.canonical.bind(this)),this.resources=new sa(this.packaging.manifest,{archive:this.archive,resolver:this.resolve.bind(this),request:this.request.bind(this),replacements:this.settings.replacements||(this.archived?"blobUrl":"base64")}),this.loadNavigation(this.packaging).then(()=>{this.loading.navigation.resolve(this.navigation)}),this.packaging.coverPath&&(this.cover=this.resolve(this.packaging.coverPath)),this.loading.manifest.resolve(this.packaging.manifest),this.loading.metadata.resolve(this.packaging.metadata),this.loading.spine.resolve(this.spine),this.loading.cover.resolve(this.cover),this.loading.resources.resolve(this.resources),this.loading.pageList.resolve(this.pageList),this.isOpen=!0,this.archived||this.settings.replacements&&this.settings.replacements!="none"?this.replacements().then(()=>{this.loaded.displayOptions.then(()=>{this.opening.resolve(this)})}).catch(t=>{console.error(t)}):this.loaded.displayOptions.then(()=>{this.opening.resolve(this)})}loadNavigation(e){let t=e.navPath||e.ncxPath,r=e.toc;return r?new Promise((i,s)=>{this.navigation=new Xr(r),e.pageList&&(this.pageList=new Yr(e.pageList)),i(this.navigation)}):t?this.load(t,"xml").then(i=>(this.navigation=new Xr(i),this.pageList=new Yr(i),this.navigation)):new Promise((i,s)=>{this.navigation=new Xr,this.pageList=new Yr,i(this.navigation)})}section(e){return this.spine.get(e)}renderTo(e,t){return this.rendition=new Ci(this,t),this.rendition.attachTo(e),this.rendition}setRequestCredentials(e){this.settings.requestCredentials=e}setRequestHeaders(e){this.settings.requestHeaders=e}unarchive(e,t){return this.archive=new Pa,this.archive.open(e,t)}store(e){let t=this.settings.replacements&&this.settings.replacements!=="none",r=this.url,i=this.settings.requestMethod||er.bind(this);return this.storage=new ts(e,i,this.resolve.bind(this)),this.request=this.storage.request.bind(this.storage),this.opened.then(()=>{this.archived&&(this.storage.requester=this.archive.request.bind(this.archive));let s=(n,a)=>{a.output=this.resources.substitute(n,a.url)};this.resources.settings.replacements=t||"blobUrl",this.resources.replacements().then(()=>this.resources.replaceCss()),this.storage.on("offline",()=>{this.url=new Dt("/",""),this.spine.hooks.serialize.register(s)}),this.storage.on("online",()=>{this.url=r,this.spine.hooks.serialize.deregister(s)})}),this.storage}coverUrl(){return this.loaded.cover.then(()=>this.cover?this.archived?this.archive.createUrl(this.cover):this.cover:null)}replacements(){return this.spine.hooks.serialize.register((e,t)=>{t.output=this.resources.substitute(e,t.url)}),this.resources.replacements().then(()=>this.resources.replaceCss())}getRange(e){var t=new Pe(e),r=this.spine.get(t.spinePos),i=this.load.bind(this);return r?r.load(i).then(function(s){var n=t.toRange(r.document);return n}):new Promise((s,n)=>{n("CFI could not be found")})}key(e){var t=e||this.packaging.metadata.identifier||this.url.filename;return`epubjs:${_r}:${t}`}destroy(){this.opened=void 0,this.loading=void 0,this.loaded=void 0,this.ready=void 0,this.isOpen=!1,this.isRendered=!1,this.spine&&this.spine.destroy(),this.locations&&this.locations.destroy(),this.pageList&&this.pageList.destroy(),this.archive&&this.archive.destroy(),this.resources&&this.resources.destroy(),this.container&&this.container.destroy(),this.packaging&&this.packaging.destroy(),this.rendition&&this.rendition.destroy(),this.displayOptions&&this.displayOptions.destroy(),this.spine=void 0,this.locations=void 0,this.pageList=void 0,this.archive=void 0,this.resources=void 0,this.container=void 0,this.packaging=void 0,this.rendition=void 0,this.navigation=void 0,this.url=void 0,this.path=void 0,this.archived=!1}}St(Si.prototype);function Bt(x,e){return new Si(x,e)}Bt.VERSION=_r;typeof global<"u"&&(global.EPUBJS_VERSION=_r);Bt.Book=Si;Bt.Rendition=Ci;Bt.Contents=Di;Bt.CFI=Pe;Bt.utils=Gs;function ja(x){return typeof document>"u"?null:document.cookie.split("; ").find(e=>e.startsWith(x+"="))?.split("=")[1]}function Xa({book:x,fileUrl:e}){const t=it.useRef(null),r=it.useRef(null),i=it.useRef(null),s=it.useRef(null),[n,a]=it.useState([]),[l,f]=it.useState(!1),[d,c]=it.useState(!1),[b,m]=it.useState([]),[N,w]=it.useState([]),[h,v]=it.useState(!1),[g,E]=it.useState([]),[L,y]=it.useState(!1),[S,R]=it.useState(null),[I,k]=it.useState(""),[O,H]=it.useState(!1),[j,Z]=it.useState(0),K=it.useRef(0),J=it.useRef(null),he=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||"";it.useEffect(()=>{const oe=Bt(encodeURI(e));if(i.current=oe,oe.loaded.navigation.then(ue=>a(ue.toc||[])),t.current){const ue=oe.renderTo(t.current,{manager:"default",flow:"paginated",width:"100%",height:"100%",allowScriptedContent:!0});r.current=ue,ue.display(),oe.ready.then(()=>oe.locations.generate(1e3)).then(()=>{console.log("Locations generated"),Q()}),Y(),ae(ue)}return Ne(),document.addEventListener("visibilitychange",ze),()=>{je(),document.removeEventListener("visibilitychange",ze),i.current&&i.current.destroy(),r.current=null}},[e,x.id]),it.useEffect(()=>{r.current&&g.length>0&&ce()},[g]);const Q=()=>{const oe=r.current,ue=i.current;if(!oe||!ue)return;const me=oe.currentLocation?oe.currentLocation():oe.location;if(me&&me.start&&ue.locations.length()>0){const _e=ue.locations.percentageFromCfi(me.start.cfi);Z(Math.round(_e*100))}},Y=()=>{fetch(Lt.bookmark.index.get({book:x.id}).url,{credentials:"include"}).then(oe=>oe.json()).then(w).catch(console.error),fetch(Lt.highlight.index.get({book:x.id}).url,{credentials:"include"}).then(oe=>oe.json()).then(E).catch(console.error)},ae=oe=>{oe.on("relocated",()=>{g.length>0&&ce(),K.current+=1,Q()}),oe.on("selected",(ue,me)=>{const _e=me.window.getSelection().toString().trim();if(!_e){oe.clearSelection&&oe.clearSelection();return}R(ue),k(_e),y(!0),oe.clearSelection&&oe.clearSelection()}),oe.hooks.content.register(ue=>{const me=ue.document.defaultView?.frameElement;me&&(me.removeAttribute("sandbox"),me.setAttribute("sandbox","allow-same-origin allow-scripts allow-forms allow-popups allow-pointer-lock")),oe.themes.default({".hl-yellow":{background:"yellow",opacity:.45,"mix-blend-mode":"multiply"},".hl-blue":{background:"#4fa3ff",opacity:.45,"mix-blend-mode":"multiply"},".hl-green":{background:"#7cf77c",opacity:.45,"mix-blend-mode":"multiply"},".hl-pink":{background:"#ff7cc8",opacity:.45,"mix-blend-mode":"multiply"},".hl-search":{background:"orange",opacity:.4,"mix-blend-mode":"multiply"}})})},ye=async()=>{const oe=r.current;if(!oe)return;const ue=oe.currentLocation?oe.currentLocation():oe.location,me=ue?.start?.cfi;if(!me)return;const _e=decodeURIComponent(ja("XSRF-TOKEN")||"");try{const Ee=await fetch(Lt.bookmark.store.post({book:x.id}).url,{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/json",Accept:"application/json","X-XSRF-TOKEN":_e,"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({cfi:me,label:`Page ${ue.start.displayed.page}`})});if(!Ee.ok)throw new Error;const Re=await Ee.json();w(Ie=>[Re,...Ie])}catch(Ee){console.error(Ee)}},re=async oe=>{await fetch(Lt.bookmark.destroy.delete({book:x.id,bookmark:oe}).url,{method:"DELETE",headers:{"X-CSRF-TOKEN":he},credentials:"include"}),w(ue=>ue.filter(me=>me.id!==oe))},ce=()=>{const oe=r.current;if(oe){try{Object.values(oe.annotations._annotations?.highlight||{}).forEach(ue=>oe.annotations.remove(ue.cfiRange,"highlight"))}catch{}g.forEach(ue=>{try{oe.annotations.add("highlight",ue.cfi_range,{},null,`hl-${ue.color||"yellow"}`)}catch{}})}},Te=({note:oe,color:ue})=>{!S||!I||Ri.post(Lt.highlight.store.post({book:x.id}).url,{cfi_range:S,text:I,note:oe,color:ue},{preserveScroll:!0,onSuccess:me=>{y(!1),R(null),k(""),Y()},onError:me=>{console.error("Gagal menyimpan highlight:",me),alert("Gagal menyimpan highlight. Cek console.")}})},xe=async oe=>{await fetch(Lt.highlight.destroy.delete({book:x.id,highlight:oe}).url,{method:"DELETE",headers:{"X-CSRF-TOKEN":he},credentials:"include"}),E(ue=>ue.filter(me=>me.id!==oe)),r.current&&r.current.annotations.remove(g.find(ue=>ue.id===oe)?.cfi_range,"highlight")};function Ne(){je(),J.current=setInterval(()=>{K.current+=1,K.current%10===0&&we(10)},1e3)}function je(){J.current&&clearInterval(J.current)}function ze(){document.hidden?(je(),K.current>0&&(we(K.current),K.current=0)):Ne()}async function we(oe){const ue=r.current,me=i.current;if(!ue||!me)return;const _e=ue.currentLocation?ue.currentLocation():ue.location;let Ee=null,Re=0,Ie=0;_e&&_e.start&&(Ee=_e.start.cfi,me.locations.length()>0&&(Re=me.locations.percentageFromCfi(Ee),Re=parseFloat((Re*100).toFixed(2)),Ie=me.locations.locationFromCfi(Ee)+1)),Z(Math.round(Re));const Oe=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content");try{await fetch(Lt.stats.update.post({book:x.id}).url,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-CSRF-TOKEN":Oe||""},credentials:"include",body:JSON.stringify({seconds:oe,last_cfi:Ee,progress:Re,pages_read:Ie})})}catch(Ve){console.error("Gagal update stats",Ve)}}const Me=async oe=>{if(!oe.trim()||!i.current){m([]);return}const ue=[],me=i.current;for(let _e=0;_e<me.spine.length;_e++){const Ee=me.spine.get(_e);try{await Ee.load(me.load.bind(me));const Re=await Ee.find(oe);Ee.unload(),Re.forEach(Ie=>ue.push({cfi:Ie.cfi,excerpt:Ie.excerpt,chapter:Ee.href}))}catch(Re){console.warn(`Skipping search in chapter ${_e}`,Re)}}m(ue)};return se.jsxs("div",{className:"flex h-screen flex-col bg-neutral-50 dark:bg-neutral-900",children:[se.jsxs("header",{className:"sticky top-0 z-20 flex items-center justify-between gap-2 border-b border-neutral-200 bg-white/90 px-4 py-2 backdrop-blur dark:border-neutral-700 dark:bg-neutral-900/90",children:[se.jsxs("div",{className:"flex min-w-0 items-center gap-3 md:w-1/3",children:[se.jsx("button",{onClick:()=>Ri.visit("/books"),className:"rounded-md bg-neutral-100 px-3 py-1.5 text-sm transition hover:bg-neutral-200 dark:bg-neutral-800 dark:hover:bg-neutral-700",children:"â†"}),se.jsx("span",{className:"max-w-[220px] truncate text-sm font-semibold",title:x.title,children:x.title})]}),se.jsxs("div",{className:"flex flex-1 items-center justify-center gap-2",children:[se.jsx("button",{onClick:()=>f(!0),className:"rounded-md p-2 hover:bg-neutral-100 dark:hover:bg-neutral-800",title:"TOC",children:"ğŸ“‘"}),se.jsxs("div",{className:"mx-2 hidden w-32 flex-col items-center sm:flex md:w-48",children:[se.jsx("div",{className:"mb-1 flex w-full justify-between text-[10px] font-medium text-neutral-500",children:se.jsxs("span",{children:[j,"% Read"]})}),se.jsx("div",{className:"h-1.5 w-full overflow-hidden rounded-full bg-neutral-200 dark:bg-neutral-700",children:se.jsx("div",{className:"h-full rounded-full bg-blue-600 transition-all duration-300 ease-out",style:{width:`${j}%`}})})]}),se.jsx("button",{onClick:()=>c(!0),className:"rounded-md p-2 hover:bg-neutral-100 dark:hover:bg-neutral-800",title:"Search",children:"ğŸ”"})]}),se.jsxs("div",{className:"flex justify-end gap-1 md:w-1/3",children:[se.jsx("button",{onClick:()=>r.current?.prev(),className:"rounded-md bg-neutral-100 px-3 py-1.5 hover:bg-neutral-200 dark:bg-neutral-800 dark:hover:bg-neutral-700",children:"â—€"}),se.jsx("button",{onClick:()=>r.current?.next(),className:"rounded-md bg-neutral-100 px-3 py-1.5 hover:bg-neutral-200 dark:bg-neutral-800 dark:hover:bg-neutral-700",children:"â–¶"}),se.jsx("div",{className:"mx-1 h-6 w-px self-center bg-neutral-300 dark:bg-neutral-700"}),se.jsx("button",{onClick:ye,className:"rounded-md bg-neutral-100 px-3 py-1.5 hover:bg-neutral-200 dark:bg-neutral-800 dark:hover:bg-neutral-700",children:"â­"}),se.jsxs("button",{onClick:()=>v(!0),className:"relative rounded-md bg-neutral-100 px-3 py-1.5 hover:bg-neutral-200 dark:bg-neutral-800 dark:hover:bg-neutral-700",children:["ğŸ“Œ"," ",N.length>0&&se.jsx("span",{className:"absolute -top-1 -right-1 h-2 w-2 rounded-full bg-red-500"})]}),se.jsxs("button",{onClick:()=>H(!0),className:"relative rounded-md bg-neutral-100 px-3 py-1.5 hover:bg-neutral-200 dark:bg-neutral-800 dark:hover:bg-neutral-700",children:["ğŸ’¡"," ",g.length>0&&se.jsx("span",{className:"absolute -top-1 -right-1 h-2 w-2 rounded-full bg-yellow-500"})]})]})]}),se.jsx("div",{ref:t,className:"relative flex-1 overflow-hidden bg-white shadow-inner dark:bg-neutral-900"}),se.jsx(vs,{toc:n,isOpen:l,onClose:()=>f(!1),onSelect:oe=>{r.current?.display(oe),f(!1)}}),se.jsx(ps,{isOpen:d,onClose:()=>c(!1),results:b,onSearch:Me,onSelect:oe=>{const ue=r.current;ue&&(s.current&&ue.annotations.remove(s.current,"highlight"),ue.annotations.add("highlight",oe,{},null,"hl-search"),s.current=oe,ue.display(oe)),c(!1)}}),se.jsx(cs,{open:L,onClose:()=>y(!1),onSave:Te,selectedText:I}),se.jsx(ds,{isOpen:O,onClose:()=>H(!1),highlights:g,onJump:oe=>{r.current?.display(oe),H(!1)},onDelete:xe}),se.jsx(fs,{isOpen:h,onClose:()=>v(!1),bookmarks:N,onJump:oe=>{r.current?.display(oe),v(!1)},onDelete:re})]})}export{Xa as default};
